"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["39661"],{227648:function(e,n,r){r.r(n),r.d(n,{default:()=>$});var s=r(552676),a=r(740453);let t=r.p+"static/image/74fd6fb03ba56a9301c0c42567314100.72c5390b.webp",c=r.p+"static/image/a1ff4729978d0ddff213b6bb153f6c85.e10aef12.webp",i=r.p+"static/image/181ef99453af81ebb180ce87a39f57b9.f6ec9fb3.webp",p=r.p+"static/image/65246144fdbccf0dd57757123f4ef18a.2eca7e75.webp",d=r.p+"static/image/10051d30eada52e5c028540d3a6ca747.c6e2d35a.webp",l=r.p+"static/image/0b952184416608ebd497735395ebe7d3.e2d5a8dd.webp",x=r.p+"static/image/e6e7266c0e5d3d1ebae1383e1c698f5f.0ba2cfef.webp",h=r.p+"static/image/0a55b28833870a8cd06ba59aa0fdff1f.a78b6e55.webp",j=r.p+"static/image/e7b0137a0a3549057fc9b5391b715128.15060cc8.webp",A=r.p+"static/image/cf055956153da75f8486aba6471b13e5.3bf5a641.webp",g=r.p+"static/image/48b19e94996456affbc88ed64f57f5b4.8f6862b6.webp",m=r.p+"static/image/1431deabb049c79a707feaf876f940d2.f54c7360.webp",f=r.p+"static/image/def9f8cf78074f0ba752a28b55160a73.d9b43759.webp";function b(e){let n=Object.assign({h1:"h1",a:"a",p:"p",img:"img",pre:"pre",code:"code",h2:"h2"},(0,a.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"29加餐一道字节面试真题",children:["29.加餐：一道字节面试真题",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#29加餐一道字节面试真题",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"前天，小册群友问了我一个 TS 体操问题，说是面字节时遇到的。"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:f,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"今天又催了一下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:m,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"面试题是这样的："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:g,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"让实现这个 FormatDate 的类型，用来限制字符串只能是指定的日期格式。"}),"\n",(0,s.jsx)(n.p,{children:"看起来好像没多大难度，就是提取出 YY、MM、DD 和分隔符，然后构造对应的字符串类型就好了。"}),"\n",(0,s.jsx)(n.p,{children:"但上手试了一下，还真没那么简单。"}),"\n",(0,s.jsx)(n.p,{children:"首先，我们用模式匹配的方式，也就是 extends + infer 来提取出 YY、MM、DD 这三部分："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"type Seperator = '-' | '.' | '/';\n\ntype FormatDate<Pattern extends string> = \n  Pattern extends `${infer Aaa}${Seperator}${infer Bbb}${Seperator}${infer Ccc}`\n    ? [Aaa,Bbb,Ccc]\n    : never;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:A,alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:j,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"同样，也可以提取出分隔符部分："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"type FormatDate<Pattern extends string> = \n  Pattern extends `${infer Aaa}${Seperator}${infer Bbb}${Seperator}${infer Ccc}`\n    ? Pattern extends `${Aaa}${infer Sep}${Bbb}${infer _}${Ccc}`\n      ? [Aaa, Bbb, Ccc, Sep]\n      : never\n    : never;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:h,alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:x,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"然后根据 YY、MM、DD 分别构造 4 位和 2 位的字符串，最后组合起来不就行了？"}),"\n",(0,s.jsx)(n.p,{children:"但问题就在这里。"}),"\n",(0,s.jsx)(n.p,{children:"组合字符串字面量类型是这样写："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"type Num = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n\ntype YY = `${Num}${Num}${Num}${Num}`;\n\ntype MM = `${Num}${Num}`;\n\ntype DD = `${Num}${Num}`;\n\ntype GenStr<Type extends string> = \n  Type extends 'YY'\n    ? YY\n    : Type extends 'MM'\n      ? MM\n      : DD;\n\ntype res3 = `${GenStr<'YY'>}-${GenStr<'MM'>}-${GenStr<'DD'>}`;\n"})}),"\n",(0,s.jsx)(n.p,{children:"就是根据 YY、MM 还是 DD 生成不同的字符串字面量，然后组合到一块。"}),"\n",(0,s.jsx)(n.p,{children:"这时候会提示你 union 数量太多："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:l,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"因为组合起来的情况太多了。"}),"\n",(0,s.jsx)(n.p,{children:"这时候需要减少 union 数量才行。"}),"\n",(0,s.jsx)(n.p,{children:"所以我们可以改成这样："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"type Num = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n\ntype Num2 = Num | 0\n\ntype YY = `19${Num2}${Num2}` | `20${Num2}${Num2}`;\n\ntype MM = `0${Num}` | `1${0 | 1 | 2}`;\n\ntype DD = `${0}${Num}` | `${1 | 2}${Num2}` | `3${0 | 1}`;\n\ntype GenStr<Type extends string> = \n  Type extends 'YY'\n    ? YY\n    : Type extends 'MM'\n      ? MM\n      : DD;\n\ntype res3 = `${GenStr<'YY'>}-${GenStr<'MM'>}-${GenStr<'DD'>}`;\n"})}),"\n",(0,s.jsx)(n.p,{children:"也就是年份只能是 19 和 20 开头，月份只能是 1-12 的数字，日期是 01-31 的数字。"}),"\n",(0,s.jsx)(n.p,{children:"这样，组合就少了很多。"}),"\n",(0,s.jsx)(n.p,{children:"再试下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:d,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"现在就能正常计算出类型了。"}),"\n",(0,s.jsx)(n.p,{children:"然后用之前提取出的 Aaa、Bbb、Ccc 和 Sep 来生成字符串字面量类型："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:p,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"这样，就完成了需求："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:i,alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:c,alt:""})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:t,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"回过头来看一下，这个类型难么？"}),"\n",(0,s.jsx)(n.p,{children:"思路并不难，就是通过模式匹配（extends + infer）提取出各部分，然后构造对应的字符串字面量类型，组合起来就好了。"}),"\n",(0,s.jsx)(n.p,{children:"它难在如果直接组合，union 数量会过多，从而报错。"}),"\n",(0,s.jsx)(n.p,{children:"所以需要根据年月日的特点，对生成的字符串字面量类型做更精准的控制。"}),"\n",(0,s.jsx)(n.p,{children:"这样，就能生成满足需求的日期字符串类型。"}),"\n",(0,s.jsx)(n.p,{children:"全部代码如下，大家可以试试："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"type Seperator = '-' | '.' | '/';\n\ntype Num = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n\ntype Num2 = Num | 0\n\ntype YY = `19${Num2}${Num2}` | `20${Num2}${Num2}`;\n\ntype MM = `0${Num}` | `1${0 | 1 | 2}`;\n\ntype DD = `${0}${Num}` | `${1 | 2}${Num2}` | `3${0 | 1}`;\n\ntype GenStr<Type extends string> = \n  Type extends 'YY'\n    ? YY\n    : Type extends 'MM'\n      ? MM\n      : DD;\n\ntype FormatDate<Pattern extends string> = \n  Pattern extends `${infer Aaa}${Seperator}${infer Bbb}${Seperator}${infer Ccc}`\n    ? Pattern extends `${Aaa}${infer Sep}${Bbb}${infer _}${Ccc}`\n      ? `${GenStr<Aaa>}${Sep}${GenStr<Bbb>}${Sep}${GenStr<Ccc>}`\n      : never\n    : never;\n\nconst a: FormatDate<'YY-MM-DD'> = '2023-01-02';\n\nconst b: FormatDate<'DD/MM/YY'> = '01/02/2024';\n\nconst c: FormatDate<'DD/MM/YY'> = '2024-01-02';\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.typescriptlang.org/play?ssl=44&ssc=1&pln=13&pc=1#code/FAegVGwARlgZGYO7dBY-4PO1ANzoADlBUcgFwJ4AOApoN4+g0eqAw-4BSugcXKBlfoPrmgnk6BR1oG+mgL6mA8FoPD6gIW6B1bUBk3oCY5aLEDR8oAVtJOKjyAYgHsATgFsAhjgAiWogB4ARNu0BaALLnTATWuGAfHPmBBRUAd0YNGAuOVkx5UAMZKAHYAzjhQACZ6AFxQyupaujgGxmaWNnb2UAC8UIYAjABMpkWmhQAMhQAshlAAPnmllWWVNQDcTlCAsHJuHiLenYGh4VHJsfGaOnpGJhZWtg45jaWlFdW1DQXF+autG43bh3v1UAB053KcvID0poCAxoBYmoCznoBgSoApaUJIhqb7hqc-IIZxCBgMB8MQoABlIjEFRaVRLADkpgRJwRpxRDQRIARHVBhCIUAAcgBXNRLfInQonADMJyqJwArCcAGwnADsJwAHCcAJy4sEEklqKm5IUncoggVQWxLAAG+R5ABIAN5CwoAXxVavVspOsoqWtJGsNwp1-PxUEscvKJp1evyKvKJwpDQ1svN4JMcsdmtVpLtDVlKpdUGNftNusD1MdzrNkotAHEiEEITgVPoACoWogAD2SQQiISgYRUAEsggBzLK5aBQLPg3P5wtQBG2BG1+QAfml1g7UFi9YJjeTzYRlnbfj83csffksRMHoJE0S0wAClpkioglBhwWiyXy1WlrX1zhN9vd82g8rywAzIgqKAAQQ0Gl9UJhcJUvrvD6gACEACNAPfaEHy-H8gnvR8AGF-H8HU+27U9zx3PMRyLa8XzfFVf0fD9fSAkDcKgv8AH1fTghDZVnKBu2vJMUzTfRsPsUCCF9RjU3TIi2JVAiVS45iqLYmjJznKAgiIAA3B8+1iKTZJUXEhjCKANHGVRJiSAxW2sOZTBMBFqxbNZqVMcp8gswocRBVTwkAzSEimZJ9AREwQEsEA2xMhFLJASoQDWKpbOAeyAic7Tpnc7RPPMbzrGMxFgosqzKlCoA",target:"_blank",rel:"noopener noreferrer",children:"playground 地址"})}),"\n",(0,s.jsxs)(n.h2,{id:"总结",children:["总结",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"今天我们做了一道字节的 ts 体操真题。"}),"\n",(0,s.jsx)(n.p,{children:"核心思路就是模式匹配（extends + infer）提取出各部分内容，然后构造日期字符串。"}),"\n",(0,s.jsx)(n.p,{children:"答出这个，应该就有大部分的分了。"}),"\n",(0,s.jsx)(n.p,{children:"但是如果直接构造，会因为 union 数量太多导致失败。"}),"\n",(0,s.jsx)(n.p,{children:"这时候要根据日期的特点想办法减少 union 的数量，直到可以顺利生成。"}),"\n",(0,s.jsx)(n.p,{children:"再答出这个，这道面试题就稳了。"}),"\n",(0,s.jsx)(n.p,{children:"这道题整体来说还是比较难的，既考察了模式匹配+ 构造的 ts 类型编程基础，又考察了对 union 太多的情况的处理，算是一道比较高阶的面试题。"})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(b,{...e})}):b(e)}let $=o;o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["TypeScript%20%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F29.%E5%8A%A0%E9%A4%90%EF%BC%9A%E4%B8%80%E9%81%93%E5%AD%97%E8%8A%82%E9%9D%A2%E8%AF%95%E7%9C%9F%E9%A2%98.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"29.加餐：一道字节面试真题",headingTitle:"29.加餐：一道字节面试真题",frontmatter:{}}}}]);