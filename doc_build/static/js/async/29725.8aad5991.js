"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["29725"],{293856:function(e,n,s){s.r(n),s.d(n,{default:()=>i});var c=s(552676),r=s(740453);let l=s.p+"static/image/e38f9ef6fb4465beb41814bb1be6f74e.768663b5.webp",o=s.p+"static/image/7345d72191a79d3802d9cc426ef23e30.b79ffa2d.webp",t=s.p+"static/image/4f11bbb89d0b52c3d6e9d7557a2c8038.e19a9119.webp";function d(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",blockquote:"blockquote",img:"img",ul:"ul",li:"li",ol:"ol",pre:"pre"},(0,r.ah)(),e.components);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.h1,{id:"10console-篇---自定义格式转换器",children:["10.console 篇 - 自定义格式转换器",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#10console-篇---自定义格式转换器",children:"#"})]}),"\n",(0,c.jsxs)(n.h2,{id:"前言",children:["前言",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#前言",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["大多数的情况下，我们习惯使用 ",(0,c.jsx)(n.code,{children:"DevTools"})," 的 ",(0,c.jsx)(n.code,{children:"console"})," 默认对 ",(0,c.jsx)(n.code,{children:"object"})," 的转换，但有时候我们想用与众不同的方式来处理。\n那我们就可以自定义输出对象的函数，它通常被称为 ",(0,c.jsx)(n.code,{children:"Custom Formatter"})," 。"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["请注意: 在我们写一个之前，需要在 ",(0,c.jsx)(n.code,{children:"DevTools"})," 进行设置 (在 ",(0,c.jsx)(n.code,{children:"DevTools"})," 的 ",(0,c.jsx)(n.code,{children:"⋮"})," 下拉框找到设置，或者按下 ",(0,c.jsx)(n.code,{children:"F1"})," ) 中把对应的设置打开:"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:t,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"formatter"})," 长什么样呢？ 它是一个对象，最多包含三个方法："]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"header"})," : 处理如何展示在 ",(0,c.jsx)(n.code,{children:"console"})," 的日志中的主要部分。"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"hasbody"})," : 如果你想显示一个用来展开对象的 ",(0,c.jsx)(n.code,{children:"▶"})," 箭头，返回 ",(0,c.jsx)(n.code,{children:"true"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"body"})," : 定义将会被显示在展开部分的内容中。"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["一个基础的自定义 ",(0,c.jsx)(n.code,{children:"formatter"})]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:o,alt:""})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"例子里移除了循环的结构的错误处理，让它看起来更加简洁"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"header"})," 方法返回了一个 ",(0,c.jsx)(n.a,{href:"http://www.jsonml.org/",target:"_blank",rel:"noopener noreferrer",children:"JsonML"})," (注： ",(0,c.jsx)(n.code,{children:"JsonML"})," : ",(0,c.jsx)(n.code,{children:"JSON Markup Language"})," - ",(0,c.jsx)(n.code,{children:"JSON"})," 标记语言) 数组，由这些组成："]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"标签名"}),"\n",(0,c.jsx)(n.li,{children:"属性对象"}),"\n",(0,c.jsx)(n.li,{children:"内容 (文本值或者其他元素)"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["(如果看起来很眼熟的话，那可能是因为你之前写过一些 ",(0,c.jsx)(n.a,{href:"https://reactjs.org/docs/react-without-jsx.html",target:"_blank",rel:"noopener noreferrer",children:"React 代码"})," :D)"]}),"\n",(0,c.jsxs)(n.p,{children:["在输出的时候，这个简单的 ",(0,c.jsx)(n.code,{children:"formatter"})," 对于每一层嵌套，直接以 ",(0,c.jsx)(n.code,{children:"7"})," 个空格的缩进打印这个对象。所以现在我们的输出看起来是这样："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:"data:image/webp;base64,UklGRpoEAABXRUJQVlA4II4EAACwgACdASp0A44CPp1Op04lpCOiIAgAsBOJaW7hd2EdzAABkBDuG/yYZtt4uTkPfbJyHvtk5D32ych77ZOQ99snHeywFOeCfS7Xi5OQ99snIe+2TkPfbJyHvtk5D4bnp7ZOQ99snIe+2TkPfbJyHvtk5D32ycnRYB77ZOQ99snIe+2TkPfbJyHvtk5D320Ilych77ZOQ99snIe+2TkPfbJyHvtk5D4YrT2ych77ZOQ99snIe+2TkPfbJyHvtk5OiwD32ych77ZOQ99snIe+2TkPfbJyHvtoRLk5D32ych77ZOQ99snIe+2TkPfbJyHwxWntk5D32ych77ZOQ99snIe+2TkPfbJydFgHvtk5D32ych77ZOQ99snIe+2TkPfbQiXJyHvtk5D32ych77ZOQ99snIe+2TkPhitPbJyHvtk5D32ych77ZOQ99snIe+2Tk6LAPfbJyHvtk5D32ych77ZOQ99snIe+2hEuTkPfbJyHvtk5D32ych77ZOQ99snIfDFae2TkPfbJyHvtk5D32ych77ZOQ99snJ0WAe+2TkPfbJyHvtk5D32ych77ZOQ99tCJcnIe+2TkPfbJyHvtk5D32ych77ZOQ+GK09snIe+2TkPfbJyHvtk5D32ych77ZOTosA99snIe+2TkPfbJyHvtk5D32ych77aES5OQ99snIe+2TkPfbJyHvtk5D32ych8MVp7ZOQ99snIe+2TkPfbJyHvtk5D32ycnRYB77ZOQ99snIe+2TkPfbJyHvtk5D320Ilych77ZOQ99snIe+2TkPfbJyHvtk5D4YrT2ych77ZOQ99snIe+2TkPfbJyHvtk5OiwD32ych77ZOQ99snIe+2TkPfbJyHvtoRLk5D32ych77ZOQ99snIe+2TkPfbJyHwxWntk5D32ych77ZOQ99snIe+2TkPfbJydFgHvtk5D32ych77ZOQ99snIe+2TkPfbQiXJyHvtk5D32ych77ZOQ99snIe+2TkPhitPbJyHvtk5D32ych77ZOQ99snIe+2Tk6LAPfbJyHvtk5D32ych77ZOQ99snIe+2hEuTkPfbJyHvtk5D32ych77ZOQ99snIfDFae2TkPfbJyHvtk5D32ych77ZOQ99snJ0WAe+2TkPfbJyHvtk5D32ych77ZOQ99tCJcnIe+2TkPfbJyHvtk5D32ych77ZOQ+GK09snIe+2TkPfbJyHvtk5D32ych77ZOTosA99snIe+2TkPfbJyHvtk5D32ych77aES5OQ99snIe+2TkPfbJyHvtk5D32ych8MVp7ZOQ99snIe+2TkPfbJyHvtk5D32ycnRYB77ZOQ99snIe+2TkPfbJyHvtk5D320Ilych77ZOQ99snIe+2TkPfbJyHvtk5D1gAA/v/Vh06+iemiSMqk17sEMj1s63APaLvMkB4PVd+sNzu6Pfn0L+i4534KtfxaN0fItMEABrIXuZwmeiW+8sYZ+XtFQvcdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",alt:""})}),"\n",(0,c.jsxs)(n.h2,{id:"1-自定义格式化转换器的应用实践",children:["1. 自定义格式化转换器的应用实践",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-自定义格式化转换器的应用实践",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["现有好几种 ",(0,c.jsx)(n.code,{children:"custom formatter"})," 可供选择，例如：你可以在这个 ",(0,c.jsx)(n.a,{href:"https://github.com/andrewdavey/immutable-devtools",target:"_blank",rel:"noopener noreferrer",children:"immutable-devtools "})," 仓库中找到对于 ",(0,c.jsx)(n.a,{href:"https://facebook.github.io/immutable-js/",target:"_blank",rel:"noopener noreferrer",children:"Immutable.js"}),"  结构的完美展示。但你同样可以自己造一个。"]}),"\n",(0,c.jsxs)(n.p,{children:["一般来说，每当你遇到结构不寻常的对象时，或大量的日志(最好避免这样的情况，但是有时候很有用)而你想从中做区分时，你可以采用 ",(0,c.jsx)(n.code,{children:"custom formatter"})," 来处理。"]}),"\n",(0,c.jsxs)(n.p,{children:["一个很实用的窍门：直接将你不关心，不需要区别对待的对象过滤出来，直接在 ",(0,c.jsx)(n.code,{children:"header"})," 方法里面 ",(0,c.jsx)(n.code,{children:"return null"}),"。让 ",(0,c.jsx)(n.code,{children:"DevTools"})," 使用默认的格式化方式来处理这些值。"]}),"\n",(0,c.jsx)(n.p,{children:"撇开实用性，我们还可以找点乐子："}),"\n",(0,c.jsxs)(n.p,{children:["这是一个关于 ",(0,c.jsx)(n.code,{children:"console"})," 的蠢萌例子：它叫做 ",(0,c.jsx)(n.code,{children:"console.clown()"})," :将打印对象进行转换，而且在对象前面加上一个 ",(0,c.jsx)(n.code,{children:"emoji"})," 表情 ..."]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"https://gist.github.com/sulco/e635a7511d5ff17d44fe9bb2ab8b3cc6",target:"_blank",rel:"noopener noreferrer",children:"源码在这里"}),"为了方便大家尝试，源码贴在下面："]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"window.devtoolsFormatters = [{\n    header: function(obj){\n      if (!obj.__clown) {\n        return null;\n      }\n      delete obj.__clown;\n      const style = `\n        color: red;\n        border: dotted 2px gray;\n        border-radius: 4px;\n        padding: 5px;\n      `\n      const content = `\uD83E\uDD21 ${JSON.stringify(obj, null, 2)}`;\n\n      try {\n        return ['div', {style}, content]\n      } catch (err) { // for circular structures\n        return null;  // use the default formatter\n      }\n    },\n    hasBody: function(){\n        return false;\n    }\n}]\n\nconsole.clown = function (obj) {\n  console.log({...obj, __clown: true});\n}\n\nconsole.log({message: 'hello!'});   // normal log\nconsole.clown({message: 'hello!'}); // a silly log\n"})}),"\n",(0,c.jsxs)(n.p,{children:["如你所见，我使用 ",(0,c.jsx)(n.code,{children:"console.clown"})," 方法打印出来的对象被添加了一个特殊的属性，便于将它区分出来，并且在 ",(0,c.jsx)(n.code,{children:"formatter"})," 中对它区别处理，但在大部分现实的案例中，这样更好：比如检查这个对象是不是某一个特殊类的实例等等。"]}),"\n",(0,c.jsxs)(n.p,{children:["对了，",(0,c.jsx)(n.code,{children:"clown"})," 打印出来了什么东西呢？ 在下面："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:l,alt:""})})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}let i=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%20Chrome%20%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7%2F10.console%20%E7%AF%87%20-%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2%E5%99%A8.md"]={toc:[{text:"前言",id:"前言",depth:2},{text:"1. 自定义格式化转换器的应用实践",id:"1-自定义格式化转换器的应用实践",depth:2}],title:"10.console 篇 - 自定义格式转换器",headingTitle:"10.console 篇 - 自定义格式转换器",frontmatter:{}}}}]);