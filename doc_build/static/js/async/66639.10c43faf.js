"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["66639"],{336152:function(e,n,d){d.r(n),d.d(n,{default:()=>w});var p=d(552676),s=d(740453);let i=d.p+"static/image/023476d101b92604aa4cb00413b050f3.b8835db4.webp",c=d.p+"static/image/e588c5f542af572a08ebd16f9978a301.0c3a53aa.webp",r=d.p+"static/image/3ef1061e4d9100ae33ba32965d901e85.9a7f05ba.webp",a=d.p+"static/image/a4af481309d29c88ad193b24cedb153c.f4ebe784.webp",o=d.p+"static/image/6b3c5385b570b276fe062ed23a69de9e.025ebf7f.webp",h=d.p+"static/image/c885178d03c21aebe7309688e9dd63db.5a66955a.webp",l=d.p+"static/image/455f1a28a7b9d2ce08666b56e7430447.6612f353.webp",T=d.p+"static/image/8a8546c283b30b51f8593dbbfb72342a.26f0afcd.webp",t=d.p+"static/image/461121b406767558ffd064e3eb2c8a05.49d76fe8.webp",O=d.p+"static/image/bfed629fa72f7a42194dfefed3c09540.7c3cb318.webp",j=d.p+"static/image/36b4de52bda8390d05b13f5eb472737b.69030f11.webp",x=d.p+"static/image/3f2d1e9a99556144b30dd25a88baa05f.6b659b52.webp",b=d.p+"static/image/99c8b084a4abe59ddc0501723e1ed705.4dd4d35c.webp",m=d.p+"static/image/2cc601836bb4c2c536710a3179dc1fb3.1ebfb3ec.webp",A=d.p+"static/image/13e6fcd8aceeca5ba8c98535063e7112.b3744777.webp",f=d.p+"static/image/fb7dabea802a54d038f37e2316cbb929.54341497.webp";function g(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",img:"img"},(0,s.ah)(),e.components);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(n.h1,{id:"38如何远程调试-android--移动端网页",children:["38.如何远程调试 android  移动端网页",(0,p.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#38如何远程调试-android--移动端网页",children:"#"})]}),"\n",(0,p.jsx)(n.p,{children:"作为前端开发，我们每天都会用 Chrome DevTools 调试 Chrome 的网页，但其实它还可以远程调试安卓手机的网页。"}),"\n",(0,p.jsx)(n.p,{children:"那 Chrome DevTools 如何远程调试安卓网页呢？它的实现原理是什么？"}),"\n",(0,p.jsx)(n.p,{children:"今天我们就来了解一下："}),"\n",(0,p.jsxs)(n.h2,{id:"远程调试安卓网页",children:["远程调试安卓网页",(0,p.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#远程调试安卓网页",children:"#"})]}),"\n",(0,p.jsx)(n.p,{children:"用数据线把安卓手机和电脑连接起来，在手机设置里打开 USB 调试："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:f,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"然后在 chrome 打开 chrome://inspect 页面，勾选 Discover USB devices（默认是勾选的）："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:A,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"这时候下面就会出现一个提示：请在设备上接受 debugging 会话"}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:m,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"在手机上点击确定，就会建立调试会话："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:b,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"下面就会列出所有可以调试的网页："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:x,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"浏览器里的网页，或者 APP 调试包的 webview 的网页都会列出来。"}),"\n",(0,p.jsx)(n.p,{children:"点击 inspect 就可以调试了："}),"\n",(0,p.jsx)(n.p,{children:"可以审查元素："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:j,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"可以打断点："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:O,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"也可以用 Performance 分析性能："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:t,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"各种调试 PC 网页的功能基本都支持。\n这样就可以愉快的调试安卓的移动端网页了。"}),"\n",(0,p.jsx)(n.p,{children:"不过这个过程你可能会遇到这样的问题，打开的窗口是空白的或者是 404:"}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:T,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"这是因为调试的目标可能是任意 chrome 版本，那么 Chrome DevTools 自然也要用相应的版本才行，所以就需要动态下载。"}),"\n",(0,p.jsx)(n.p,{children:"而动态下载的 devtools 网页是在 google 域名下的，需要科学上网才行。"}),"\n",(0,p.jsx)(n.p,{children:"科学上网之后，就可以正常的下载 Chrome DevTools 来做调试，也就不会白屏或 404 了。"}),"\n",(0,p.jsx)(n.p,{children:"但也不是每次都要科学上网，一个调试目标只需要下载一次 Chrome DevTools 的代码，之后就可以一直用了。"}),"\n",(0,p.jsx)(n.p,{children:"我们了解了 Chrome DevTools 怎么调试安卓的网页，那它的原理是什么呢？"}),"\n",(0,p.jsxs)(n.h2,{id:"chrome-devtools-的原理",children:["Chrome DevTools 的原理",(0,p.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#chrome-devtools-的原理",children:"#"})]}),"\n",(0,p.jsx)(n.p,{children:"Chrome DevTools 被设计成了和 Chrome 分离的架构，两者之间通过 WebSocket 通信，设计了专门的通信协议： Chrome DevTools Protocol。"}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:l,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"这样只要实现对接 CDP 协议的 ws 服务端，就可以用 Chrome DevTools 来调试，所以 Chrome DevTools 可以用来调试浏览器的网页、调试 Node.js，调试 Electron 等。"}),"\n",(0,p.jsx)(n.p,{children:"那自然也就可以远程调试安卓手机的网页了，只要开启了 USB 调试，那手机和电脑就可以做网络通信，从而实现基于 CDP 的调试。"}),"\n",(0,p.jsx)(n.p,{children:"这个 CDP 的调试协议是 json 格式的，如果想看它传输了什么也是可以的："}),"\n",(0,p.jsx)(n.p,{children:"在 Chrome DevTools 的设置里开启 Protocol Monitor："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:h,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"然后在 more tools 里打开 Protocol Monitor 面板："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:o,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"然后你就可以在 Protocol Monitor 面板里看到所有的 CDP 协议的数据交互了："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:a,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"这就是调试的实现原理。"}),"\n",(0,p.jsx)(n.p,{children:"那如何知道哪些界面是网页，哪些是原生绘制的呢？"}),"\n",(0,p.jsx)(n.p,{children:"Android 下可以在设置里打开显示布局边界："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:r,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"如果是原生的组件，就会显示边框："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:c,alt:""})}),"\n",(0,p.jsx)(n.p,{children:"而没有边框的，就是网页。比如钉钉的这个界面："}),"\n",(0,p.jsx)(n.p,{children:(0,p.jsx)("img",{src:i,alt:""})}),"\n",(0,p.jsxs)(n.h2,{id:"总结",children:["总结",(0,p.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,p.jsx)(n.p,{children:"Chrome DevTools 和 Chrome 是分离的架构，两者通过 WebSocket 通信，通信协议是 Chrome DevTools Protocol，可以在 Protocol Monitor 里看到 CDP 的数据交互。"}),"\n",(0,p.jsx)(n.p,{children:"因为这样的实现原理，Chrome DevTools 可以调试很多目标，其中就包括 USB 设备。"}),"\n",(0,p.jsx)(n.p,{children:"打开 USB 调试之后，在 chrome://inspect 页面就可以看到可调试的网页了，点击对应的网页就可以调试。"}),"\n",(0,p.jsx)(n.p,{children:"要注意的是调试的目标浏览器要和用的 Chrome DevTools 版本一一对应才行，所以第一次调试会先下载 Chrome DevTools，这需要访问 google 的域名，如果没有科学上网，会有白屏和 404 的问题。"}),"\n",(0,p.jsx)(n.p,{children:"理解了调试的原理，Chrome DevTools 调试安卓网页的流程，就可以愉快的远程调试安卓手机的网页了。"})]})}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,p.jsx)(n,{...e,children:(0,p.jsx)(g,{...e})}):g(e)}let w=v;v.__RSPRESS_PAGE_META={},v.__RSPRESS_PAGE_META["%E5%89%8D%E7%AB%AF%E8%B0%83%E8%AF%95%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F38.%E5%A6%82%E4%BD%95%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95%20android%20%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%BD%91%E9%A1%B5.md"]={toc:[{text:"远程调试安卓网页",id:"远程调试安卓网页",depth:2},{text:"Chrome DevTools 的原理",id:"chrome-devtools-的原理",depth:2},{text:"总结",id:"总结",depth:2}],title:"38.如何远程调试 android  移动端网页",headingTitle:"38.如何远程调试 android  移动端网页",frontmatter:{}}}}]);