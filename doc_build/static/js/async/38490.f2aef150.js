"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["38490"],{555427:function(e,c,n){n.r(c),n.d(c,{default:()=>M});var a=n(552676),s=n(740453);let i=n.p+"static/image/1b0a57b3b90a2a1c7e80171f0d3ef9d8.c75e5764.webp",r=n.p+"static/image/47c62d068fe5f872de45c9600bf55323.84055391.webp",t=n.p+"static/image/5a414f386bada9b12fb9bc1c10d2838b.f1a007de.webp",d=n.p+"static/image/fad4c5475ace034d191721785a078985.c9bae06d.webp",l=n.p+"static/image/4544327105d9d95e2164e64a75b602fe.0fa9ca7b.webp",p=n.p+"static/image/ac0eb289360278e3bb7c6028994e1794.2f7c7095.webp",j=n.p+"static/image/f29579cc8468a020d284a6b231c356c8.ed0d1f92.webp",h=n.p+"static/image/fd9cd0a08cea91a28696386df9b0f2da.2edba8a1.webp",x=n.p+"static/image/7aebb52b8e1e936711b76c68096ef6cf.d35b1c4b.webp",b=n.p+"static/image/608c862be3df910b8d01192ed63852f0.db7f2077.webp",o=n.p+"static/image/68cd49fb676947eaf9f59026d6cb11b5.b2f6bc4f.webp",m=n.p+"static/image/9b1d1bba1fe3536eac2e38e51ea1ce5b.921141d7.webp",f=n.p+"static/image/102f735e5122e2f4ed0b018f8aca5d25.7f659a3f.webp",g=n.p+"static/image/29b2339d9c554c3e35432d5528008dca.5030bc93.webp",u=n.p+"static/image/2dc6ea42ad3256cb96dd15d970d5625d.b2cb6d6d.webp",A=n.p+"static/image/c713be78ba62bfa3e910a6c8711a7cc1.59730099.webp",D=n.p+"static/image/7c374b3267468e07cfe16147aeeb3772.d76f9fc2.webp",w=n.p+"static/image/c9f0bcbe172e60c2fd750a61ebf96edb.a754c2f2.gif",B=n.p+"static/image/095a313363a522294fb3be8fa2de5ef4.5a03d58d.webp",R=n.p+"static/image/a8d58aadf780271921ec8bd4af73c12a.7c3c158b.webp",v=n.p+"static/image/0e695bdd0e76d5da6e0b36bb36c38c57.560a4c3d.webp",E=n.p+"static/image/2db8a00c8b7bd56ddd5431c67e96fbe8.ce0d6015.gif",N=n.p+"static/image/a2dc48b726451e9e8bebed946fa17e4e.528b7f2c.webp";function T(e){let c=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",img:"img",h2:"h2"},(0,s.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.h1,{id:"第05章react组件如何调试",children:["第05章—React组件如何调试",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#第05章react组件如何调试",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"\uFEFF大家都是怎么调试 React 组件的呢？"}),"\n",(0,a.jsx)(c.p,{children:"很多同学都会说，console.log 啊。"}),"\n",(0,a.jsx)(c.p,{children:"这样可以，但效率太低了，因为你只能看到你打印的一些零散值，看不到代码的具体执行路线，比如走了哪些分支、调用某个函数的时候参数是什么。"}),"\n",(0,a.jsx)(c.p,{children:"而如果你使用 debugger 断点调试的方式，就可以看到代码执行的细节，可以在关心的地方断住，单步执行来观察是否符合预期，可以帮你更好的理清代码逻辑。"}),"\n",(0,a.jsx)(c.p,{children:"所以说，学会断点调试 React 组件的代码，是提升你写代码和排查错误的水平的很重要的一步。"}),"\n",(0,a.jsx)(c.p,{children:"这节我们就来学下 React 组件的调试。"}),"\n",(0,a.jsx)(c.p,{children:"用 cra 创建个项目："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"npx create-react-app --template typescript debug-test\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:N,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"改下 index.tsx"}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{className:"language-javascript",children:"import ReactDOM from 'react-dom/client';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\nroot.render(<App />);\n"})}),"\n",(0,a.jsx)(c.p,{children:"然后在 App.tsx 写个组件："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{className:"language-javascript",children:'import { useEffect, useLayoutEffect, useState } from "react";\n\nasync function queryData() {\n  const data = await new Promise<number>((resolve) => {\n    setTimeout(() => {\n      resolve(666);\n    }, 2000);\n  })\n  return data;\n}\n\nfunction App() {\n  const [num, setNum] = useState(0);\n\n  useLayoutEffect(() => {\n    queryData().then(data => {\n      setNum(data);\n    })\n  }, []);\n\n  return (\n    <div onClick={(e) => {\n      setNum((prevNum) => prevNum + 1)\n    }}>{num}</div>\n  );\n}\n\nexport default App;\n\n'})}),"\n",(0,a.jsx)(c.p,{children:"把开发服务跑起来："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"npm run start\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:E,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"点击 debug 面板的 create a launch.json file"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:v,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"选择 chrome 类型的调试配置："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:R,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"它会创建 .vscode/launch.json 文件："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:B,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"把端口改为 3000"}),"\n",(0,a.jsx)(c.p,{children:"然后点击调试按钮，会跑一个浏览器："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:w,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"打几个断点，然后点击刷新："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:D,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"代码会在断点处断住，左边可以看到作用域、调用栈，鼠标 hover 到变量上可以看到变量值："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:A,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"这几个按钮分别是跳断点执行、单步执行、进入函数、跳出函数、刷新、停止："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:"data:image/webp;base64,UklGRtgIAABXRUJQVlA4IMwIAADwLgCdASpyAUgAPp1In0wlpCKiJJD7GLATiWVu3V7XLeRVMO8vev2kP736hObV6EPMB51P43e5/z/+o89AD9cvKZ+Gr+5ZMf4//rn2AeLv+G1Unxb9D+ZH0Vwv/6zwL4AXrv/RbxzAfjv/x/h2+YdBD/zeYz6+9gsgv+o3C6Xbl9VZ15xdLty+sTiEFNWhQKLz5vxRT9MeBabvr+qmOcJARqf13eESzLtTqLA2yu73C6fVc7BrQP1K8fPaNK4T5xH745fM0K4v0BrPd2tULJ2d6JtNARQcVH1SCy0J7BeZNxOqQL1EtahvXNRraOP+cmOA7UEqBjiSCUAHQD7bhB+XgbFMW5EECTiWmiHLeQV04Sv17P1XjOwE684vNm1qMmeoL49x762JS89gQX/w2XpZJiBfy0LiYbTIlXlMOgEKUvAcwn5wa0eoZTSK0Mn7lzuV/sTpzPc8QfxyOug5F7DoH+mRm9BwlzOChTKHjDFToXI5I6uUg0yxGmVoCN1fNgAA/sfX5ocbmHgAABzBnxxufORfMIK3PXviUgXY4UNP0zBBz2WEW6UzQAHLlHTwaUsGLRrVK4riIYO+yshtKZoADlyLEsFz0XOq3XQCkZQx4LM51WaKtJFt1+X6wXPRc6onghY/Y3pP8eL7695P78z9+Z6mulFvmWYGO9y2eTK+IGjWcJGrNnQNCztd5rYvhD5ePLLu7Ms3gFdc2cVUKfoYThxOqZVLRTfohVGCBB1cwbPxWflA2NlWKTRPCGfNO2JSMBlNbkX+Vg7o9fN52jhNajgZQT0xG5sKmrOIXpp3i5JjRvKl19Zvh1GtWp4BsJucwUe5NvXoWhnOkQWlz/lHY2+9LJd1iRWGgbzU3yDY0vpOrM0gMAlpwKRzQSv6eeqU2ac0++9X0tMLpoGvLrwZafu8sBvQY8CjTa04goIR0A7lL3aQTjspPCgSduIMOVH63i3tGPIxEsf0PM/MtLl8MMn/jLE4yiJfmTJjYa1KHvqBOSb55/y9dYfai0itVLPG7UdMEXfjUq47DR3PwFzZnpxT7CGAMjoIvR1VU+FOIlWrEblI7AXxWMuNdE88SaNlX2RlIo7GcAwQVbfmKavHXiB3F0NEkT97I/mBBJ4sMTNZ5tkv81Z0wfh11ZSKKuD0k3PpnT0Nj8Ya+aP/SOn1LFFn0JxzVfBoLUBiYHzcsmbyjJH1dlj85uFMk0ooc4xNIyTuvt9OP+FAsw0JIhMKTip2CdTxKCMRzOW1IbntsHLjQ59CC3/MAkmXHElfWCgrdBdQR8jEJpCY6t6/IP+M2vNOdKCusGJl9teYGSMk7eGzPEr+yih0KlTN8UJtPome8XRQIarJcM9+Ttr9cfimZMwiom8aKz3WLIL5lJ0r2s4a3y2DilDlNGS/CO4KseiimbM8AjM5X5/if/yklMTYSRlq5n1on8cYTY9pgou7xvqkQsyc9fyEy6CBRLNEMRkQNCHC659fgkDJAlZwQtsUJ/f4+A1ZnbDhkgqn8zk2Rv115KHnePqj//8cQONW+DAVPTXCtGsti6f6YWvMDxSbAkj6mNAzwAn1Z8FdrTYZwwU6nUJVXlN8riw1BE5i+H2dxkBEX+DEwoNQa1RXBtl6BQ1k6nLCbTxNGB1trS4NW5FQjfP8ZfEK17aZHzXkKEgx4KvLTYco0DpQKFl6tfxwSGiDjIA9iRbVzX3t1lly4ivQoNNdiKHWSir1peqLpAQBu0YxED7QrNoRgLxZFcBHO0gTY0AOkSjrW1JcuXLH0FZfJ9WvwYSrqSYPTlSxRhj4DiVDre8G01/mmygJ2zpPNYIJyjooq5Ko1nxzeg5UnKBQJARG+9RNa/IgmVwU6jASmXWE82PIhAP8Crt7IAvKaUm4sVh3OlvM9Prs9ZMJhB4vC7HV3JkDbUHqTBySljt9fj65VwZ8oi/E/LwjmvSuWmyyrnhFOBviFws+TfaeMMg2QQuixa1nZWG7ABhYHTyUuN0CGQbwMd6fIENNxpMrSF4kbvzYzxNtTOo2Br4R6o7uZeq6s/GjlU6RHjWEj1BSwzktnc/bbn5Cv8d7MGk6hDG8rKZobC2LCzpCCFKEViKqXL0MQnnngAAAAAA3rbsCbtWroaPA0hXPaHnqHzcwxLd5oSrvJLvAwSy1RuCqVDUIO16q+DA8LeE6TgbQ9Z9GzuXIo1s8aygxN95wJZQnu+FM36OiYeTx52+fY7EOiFSvODcBiMzMGbDGhJ//Y/L+B3ZoNb+jPXN3P2PtQvry3i9bRC6nNf6TLGWsrDDdCubNMH59c/EoWKXF04w1q1VyHA64caB2oJcYFqZn7T7AwNrMQhUXNyf/46JyTK0hW00I4mwb9UMt22spBmClr/RKkUgxJKYZ2IEbdTvG2G9eLzAC9hLylGfUGNcNWNSY6ky1lYqFbEarUHBbqyxHkWrTWdZCEwqyzDrJUPxev81YMG3ADa0Cm6HU4kg2fHIJDWw38PrqZcRvSHY4crFkN7Iap0i+bkPfnBYTBV0TPu5yYij+wwWDhXLAXRExDOhA4CXUycGlkGUvlyBCYVaYLKzmZVZVybmVtojQmF1TV7Fyp8y8fmRpgpPTXSFuG4fV075TLMsX+7yhs9JNCgEXG6X/s9bKMwEqZTxow/6l0VWDV4jpHYkVQML+Pw6Rszjyzcu5B7uj9rkfZbNaI/H5j18EVgGJLqv9KpmRpTCHpBCHyuLamwOJ85fnWXnOh/gKBI8gHIAB7ynQ7FpMds/fd+57PDh+Km9VFIiuqKbEVI8gmAmlxNtHhvDH7G9bJ7T7WIJYmVeBy5AuCZqBI3t/2TqNnBiARLG7LO/5/dby7IQ8bCbHK0ZBS0usoG8cljJ+i0tnfpeB0XC7FKe7Ra7VWGFDtirDsfBzNVyGNVRmTMhr0B7QFhL3fAU+mEo/Re6GPFoCG19Ejb33AR7khJiAH9jZomFhCnc7WgDQB04ywEcfWAguR3n+cJzR4DWCV5A4laDvXuc2TauOoAAAAA==",alt:""})}),"\n",(0,a.jsx)(c.p,{children:"可以点点试试看。"}),"\n",(0,a.jsx)(c.p,{children:"在页面点击 div，会触发 click 事件，在断点处断住，"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:u,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"可以在下面的 debug console 输入变量或者表达式，会输出执行结果："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:g,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"这样调试不比 console.log 方便多了？"}),"\n",(0,a.jsx)(c.p,{children:"而且还有其他几种断点类型："}),"\n",(0,a.jsx)(c.p,{children:"右键可以选择添加一个条件断点:"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:f,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"输入表达式，代码会在满足条件的时候断住："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:m,alt:""})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:o,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"也可以选择 hit count，代码会在触发对应的次数的时候断住："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:b,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"或者是 logpoint，它不会断住，但会在代码执行到这里的时候打印表达式的值："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:x,alt:""})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:h,alt:""})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:j,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"这些断点类型也都挺有用的。"}),"\n",(0,a.jsx)(c.p,{children:"这样我们就可以在 VSCode 里边写 React 组件边断点调试了。"}),"\n",(0,a.jsx)(c.p,{children:"不过，有同学可能会问，这个浏览器好像没有 React DevTools 啊。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:p,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"确实，因为这跑的是一个新的浏览器实例，没有之前的那些用户数据。"}),"\n",(0,a.jsx)(c.p,{children:"用户数据是保存在 userDataDir 里的，一个 userDataDir 对应一个浏览器实例。"}),"\n",(0,a.jsx)(c.p,{children:"不信我们试试看："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:l,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"我指定一个 userDataDir，然后点击调试启动。"}),"\n",(0,a.jsx)(c.p,{children:"在启动的浏览器里把掘金收藏为书签："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:d,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"然后进入刚才那个 userDataDir，进入 defaults 目录，看一下 Bookmarks 文件的内容："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:t,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"就有刚才保存的书签了。"}),"\n",(0,a.jsx)(c.p,{children:"同理，各种 chrome 插件、浏览记录、cookies 等等，所有用户数据都是保存在 userDataDir 里。"}),"\n",(0,a.jsx)(c.p,{children:"chrome 一个 userDataDir 只能跑一个实例。"}),"\n",(0,a.jsx)(c.p,{children:"我们调试的时候，如果没有指定 userDataDir，默认是临时创建一个新的 userDataDir。"}),"\n",(0,a.jsx)(c.p,{children:"所以这时候自然就没有 React DevTools 等你之前安装的插件了。"}),"\n",(0,a.jsx)(c.p,{children:"如果想调试的时候还用这些插件，那可以把 userDataDir 设置为 false，就是这样就是用默认的 userDatDir 来跑："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:r,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"这时候需要你把之前跑的 chrome 关掉才能跑，因为一个 userDataDir 只能跑一个实例。"}),"\n",(0,a.jsx)(c.p,{children:"之后再点击调试，这次跑的浏览器就有你之前装的 React DevTools 了："}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:i,alt:""})}),"\n",(0,a.jsx)(c.p,{children:"这样，我们就可以在 VSCode 里断点调试，并且跑的调试浏览器还有 React DevTools 可用了。"}),"\n",(0,a.jsxs)(c.h2,{id:"总结",children:["总结",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"这节我们学了如何用 VSCode 调试 React 组件。"}),"\n",(0,a.jsx)(c.p,{children:"点击创建 launch.json，输入 chrome 类型的调试配置，点击调试，这时候代码就会在打的断点处断住。"}),"\n",(0,a.jsx)(c.p,{children:"断点类型有普通断点、条件断点、hit count、logpoint 等。"}),"\n",(0,a.jsx)(c.p,{children:"用 debugger 可以在想调试的代码处断住，单步调试，看一些变量的变化，看代码执行路线，这样高效很多。"}),"\n",(0,a.jsx)(c.p,{children:"此外，chrome 的各种用户数据是保存在 userDataDir 下，一个 userDataDir 只能跑一个实例。"}),"\n",(0,a.jsx)(c.p,{children:"默认跑的浏览器是会创建新的临时 userDataDir，所以没有之前的用户数据，也就没有之前安装的 React DevTools 等插件。"}),"\n",(0,a.jsx)(c.p,{children:"可以把它设置为 false，然后关掉别的浏览器再跑，这时候就是在默认 userDataDir 跑的，各种用户的数据都有。"}),"\n",(0,a.jsx)(c.p,{children:"会断点调试 React 组件，是提高开发和排查问题效率的很重要的技能。"})]})}function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:c}=Object.assign({},(0,s.ah)(),e.components);return c?(0,a.jsx)(c,{...e,children:(0,a.jsx)(T,{...e})}):T(e)}let M=C;C.__RSPRESS_PAGE_META={},C.__RSPRESS_PAGE_META["React%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F%E7%AC%AC05%E7%AB%A0%E2%80%94React%E7%BB%84%E4%BB%B6%E5%A6%82%E4%BD%95%E8%B0%83%E8%AF%95.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"第05章—React组件如何调试",headingTitle:"第05章—React组件如何调试",frontmatter:{}}}}]);