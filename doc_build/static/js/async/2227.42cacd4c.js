"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["2227"],{208011:function(e,c,n){n.r(c),n.d(c,{default:()=>S});var a=n(552676),i=n(740453);let s=n.p+"static/image/3ff49a7c18516847e15a9a9c66279573.33fd2b90.webp",d=n.p+"static/image/4eebd9a6c23c86c11238aacb7c876571.d4cb06ba.webp",r=n.p+"static/image/7e75ca7e505404764dea80e119b6c2f3.90d11448.webp",p=n.p+"static/image/a10ed96949ea1d650b2e15f154681a11.c197e555.webp",h=n.p+"static/image/9699eb0ea0bbc1c54d6be7a892069cac.aac51154.webp",l=n.p+"static/image/2849c2c7998d4ee33bd8464b25520926.57d3a460.webp",t=n.p+"static/image/8b52f4c9c0dec4e53f40ca342b755d75.95f3bbe8.webp",x=n.p+"static/image/36bb96dacdda79baa9e4770249b78aad.958da5e2.webp",j=n.p+"static/image/cecfda5f962e4ff521b72045a3854a7b.aa644f39.webp",g=n.p+"static/image/5c5940185a02483de5e137930e035095.60c1b765.webp",m=n.p+"static/image/74abe6240c026dbb9bdfc80cd28bd58c.d7e393c5.webp",b=n.p+"static/image/7933208ed5c58c74694e41f7daea24ad.77e33d1b.webp",f=n.p+"static/image/a0c724ac8bb7f812e3b241ebb83367e5.e756ad7b.webp",o=n.p+"static/image/181e1a46107023de6aed509abc31454c.fb0eba63.webp",E=n.p+"static/image/6d81049878239f6a0a6a3ca259e92aa2.d05683a2.webp",u=n.p+"static/image/8df8faf730a22f9d0ff4b0473d27bcb2.f55ef876.webp",A=n.p+"static/image/b0663248ebbf29e7c05762071f1e5425.8ddc412d.webp",C=n.p+"static/image/75934fb6153e38bfc5264c02ac85c1f3.d0c90119.webp",w=n.p+"static/image/f337b7b8883775be724678210bf05e7f.739e7c57.webp",I=n.p+"static/image/a118c52fbbb0a111d4f0f6e38ecff596.18567136.webp",B=n.p+"static/image/3f54c91326842d3e35bfb927a24c8cf3.ac725fff.webp",_=n.p+"static/image/bca4360a671a34e495e0852ca8270be3.839d50f2.webp",N=n.p+"static/image/c767cb412fb24efc32d140d52da27962.ce24f249.webp",F=n.p+"static/image/ab8264ea4c48170b3e580953aeecb48e.da4c0c80.webp",P=n.p+"static/image/6bd7fda156642aca0f5a002e099e25c0.5c2ff932.webp",z=n.p+"static/image/7875642ea2fe886e9fbbf5b778ee0c14.467d0ac5.webp",O=n.p+"static/image/55fc4cf0a36beb819d77c64c843c5bda.c35c18a6.webp",U=n.p+"static/image/1742b7f3aacf89c3ff0477c7f987d90e.96236a7c.webp",T=n.p+"static/image/5e43876f71e190ebecea723b2ae830df.36f3edb8.webp";function D(e){let c=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",img:"img",h3:"h3"},(0,i.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.h1,{id:"30-文生图微信小程序实战--4-核心功能实现",children:["30-文生图微信小程序实战 ｜ 4. 核心功能实现",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#30-文生图微信小程序实战--4-核心功能实现",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"本章我们将使用 Cursor AI 开发一个微信小程序。这个小程序可以通过 Coze 平台的 API 生成图片。整个开发过程包括基础架构搭建、页面组件开发、云函数配置和核心功能实现。通过这个实例，你将学习如何使用 AI 工具高效开发微信小程序，并解决开发中遇到的各种问题。"}),"\n",(0,a.jsxs)(c.h2,{id:"基础结构搭建",children:["基础结构搭建",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#基础结构搭建",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"打开 Cursor Chat 窗口，创建一个新会话，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{className:"language-swift",children:"根据 @需求分析文档.md @技术方案.md 文档，进行基础架构搭建，并为小程序项目添加所需的文件\n\n注意，云函数已经配置过了，不需要在配置了\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:T,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"完成后，打开微信开发者工具，查看最新效果。"}),"\n",(0,a.jsx)(c.p,{children:"页面成功运行起来了，发现 AI 是真的不偷懒，我只是让它完成基础架构搭建，它把页面功能都给我实现了。"}),"\n",(0,a.jsx)(c.p,{children:"不过，我们还是要参照 UI 设计稿，对页面进行调整。"}),"\n",(0,a.jsxs)(c.p,{children:[(0,a.jsx)("img",{src:U,alt:"image.png"})," 微信开发者工具中，我们主要关注的是左侧的模拟器效果和右侧调试器 Console 日志输出。有一些云函数调用失败的日志，我们后面再解决。"]}),"\n",(0,a.jsx)(c.p,{children:"如果你有多个屏幕了，一个屏幕展示微信开发者工具，一个屏幕展示 Cursor 编辑器，这样最好。"}),"\n",(0,a.jsx)(c.p,{children:"如果只有一个屏幕了，可以调整两个工具的窗口大小，尽可能的在一个屏幕上展示。"}),"\n",(0,a.jsx)(c.p,{children:"这样 Cursor 编辑器一边写代码，一边在微信开发者工具看模拟器效果，非常方便。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:O,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h2,{id:"页面组件开发",children:["页面组件开发",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#页面组件开发",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"打开 Cursor Chat 窗口中，创建一个新会话，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{className:"language-swift",children:"根据 @需求分析文档.md @技术方案.md 文档和 UI 设计稿中的样式，开发页面组件\n\n注意，请严格按照 UI 图中的样式进行开发。\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:z,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"初次的效果不是很理想，只是色调和 UI 设计稿中的色调差不多一致，但是样式和布局还是有很大差别。"}),"\n",(0,a.jsx)(c.p,{children:"接下来又优化了两次"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:P,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:F,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"以下为最终的效果，相对比较接近 UI 设计稿了（100% 还原还是有点难度！）。"}),"\n",(0,a.jsx)(c.p,{children:"目前这里还只是生成图片之前的样式交互，生成图片之后的样式交互，我们先把云函数调用成功，再看看效果进行优化。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:N,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h2,{id:"云函数配置环境变量",children:["云函数配置环境变量",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#云函数配置环境变量",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"在微信开发者工具中，打开云开发控制台，点击云函数，进入云函数列表。"}),"\n",(0,a.jsx)(c.p,{children:"点击 “版本与配置” 按钮，进入云函数配置页。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:_,alt:"image.png"})}),"\n",(0,a.jsxs)(c.p,{children:["点击 “配置” 按钮，在打开的 “配置云函数” 窗口中，点开 “高级配置” 按钮，在环境变量中，添加 ",(0,a.jsx)(c.code,{children:"TOKEN"}),"、",(0,a.jsx)(c.code,{children:"WORKFLOW_ID"})," 变量，值从 “搭建 Coze 环境” 章节中获取，当时有讲解怎么获取。"]}),"\n",(0,a.jsx)(c.p,{children:"随后点击 “确认” 按钮，保存配置。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:B,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h2,{id:"核心功能和云函数开发",children:["核心功能和云函数开发",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#核心功能和云函数开发",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"打开 Cursor Chat 窗口中，创建一个新会话，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{className:"language-swift",children:"根据 @需求分析文档.md @技术方案.md 参考实现步骤的第 “4. 云函数开发”、“5. 核心功能实现” 开发\n\n我已在云函数通过环境变量配置了 Coze 的 TOKEN、WORKFLOW_ID，请你在代码实现中通过环境变量来取这两个值，参考第一张图，是关于云函数配置环境变量的。\n\n第二张图是 Coze 的 API 调用示例，请你参考这个示例完成云函数到 Coze API 的调用\n\n注意，当前的 UI 已经优化过了，不需要重新修改，现在你的责任是主要负责 UI 对应的业务逻辑开发\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:I,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"提示词中的两张图片，需要你提供"}),"\n",(0,a.jsx)(c.p,{children:"第一张图片是云函数配置环境变量的截图"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:w,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"第二张图片是 Coze 的 API 调用示例，在 Coze 平台获取，当时有讲解怎么获取，这个很重要，如果把这个提供给 Cursor，它生成的 Coze API 调用代码会很准确。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:C,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"在微信开发者工具模拟器中进行测试，页面提示生成图片失败，但控制台也没有错误日志输出。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:A,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"接下来我们让 Cursor 帮忙排查问题，必要时加一个日志输出，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"页面提示生成图片失败，但控制台也没有错误日志输出，请你检查原因，如果必要请打印关键输出日志，协助排查问题\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:u,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"注意，如果云函数有修改，需要重新部署云函数，否则不会生效。在云函数上右击，选择 “上传并部署（不上传 node_modules）” 按钮，上传云函数。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:E,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"接下来测试我们还需要打开云函数的日志输出，点击 “云函数” 按钮，点击 “日志” 按钮，记得选择你要调试的云函数，即可查看每次调用的日志输出。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:o,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"让我们再次进行测试，这一次看到错误输出了，这个错误你丢给 Cursor ，它也解决不了，云函数的默认超时时间太短了，需要在界面上修改云函数的超时时间。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:f,alt:"image.png"})}),"\n",(0,a.jsxs)(c.p,{children:["另外控制台输出日志，有句 “",(0,a.jsx)(c.code,{children:"请前往云开发AI小助手查看问题：https://tcb.cloud.tencent.com/dev#/helper/copilot?q=FUNCTIONS_TIME_LIMIT_EXCEEDED"})," ” 打开这个链接，我原因以为腾讯云的 AI 助手能准确告诉我答案，结果就一直在浪费时间，给了几个方案都解决不了。"]}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:b,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"打开云函数的配置窗口，修改超时时间，修改之前为 3 秒，修改之后为 20 秒。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:m,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"修改之后，再次测试，还有错误输出，但这次能看到云函数调用 Coze API 是成功的，并且返回的图片地址在浏览器打开是正常的。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:g,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"也要记得查看云函数的日志输出，发现云函数调用 Coze API 是成功的，但是返回数据格式云函数没有正确解析，导致页面报错。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:j,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"我们把这两个图片丢给 Cursor ，让它帮忙解决，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"现在云函数调用 Coze API 是成功的，并且返回的 URL 在浏览器也能正常打开，请仔细阅读图中的错误信息，查找问题原因并进行修复\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:x,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"再次进行测试，这一次页面提示生成图片成功了。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:t,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h2,{id:"页面样式优化",children:["页面样式优化",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#页面样式优化",children:"#"})]}),"\n",(0,a.jsxs)(c.h3,{id:"底部按钮样式优化",children:["底部按钮样式优化",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#底部按钮样式优化",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"从上图能看到保存底部 “保存到相册”、“重新生成” 按钮的样式有点不好看，我们让 Cursor 帮忙优化下，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"底部两个按钮内部文本没有垂直对齐，两个按钮之间没有间距，请适当增加一些间距\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:l,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"以下为优化后的效果"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:h,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h3,{id:"推荐提示词增加一个收起按钮",children:["推荐提示词增加一个收起按钮",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#推荐提示词增加一个收起按钮",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"如果你觉得哪里看起来不太舒服了，可以随时让 Cursor 帮忙优化，例如我觉得推荐提示词有点占用地方，让 Cursor 帮忙增加一个收起按钮，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"推荐提示词加一个折叠按钮\n"})}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:p,alt:"image.png"})}),"\n",(0,a.jsxs)(c.h2,{id:"测试下三个页面类型的生成效果",children:["测试下三个页面类型的生成效果",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#测试下三个页面类型的生成效果",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"让我们测试下三个页面类型的生成效果，看是否正常，输入提示词："}),"\n",(0,a.jsx)(c.pre,{children:(0,a.jsx)(c.code,{children:"小女孩手里抱着小猫咪\n"})}),"\n",(0,a.jsx)(c.p,{children:"“人像” 类型生成效果。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:r,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"“动漫” 类型生成效果。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:d,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"“通用” 类型生成效果。"}),"\n",(0,a.jsx)(c.p,{children:(0,a.jsx)("img",{src:s,alt:"image.png"})}),"\n",(0,a.jsx)(c.p,{children:"测试下来都没有什么问题，大家觉得哪个效果更好呢？"}),"\n",(0,a.jsxs)(c.h2,{id:"总结",children:["总结",(0,a.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,a.jsx)(c.p,{children:"通过本章的实践，我们完成了一个微信小程序的开发。这个小程序可以根据用户输入的提示词生成不同风格的图片。整个开发过程中，我们使用了 Cursor AI 辅助完成了基础结构搭建、页面组件开发、云函数配置以及核心功能实现。"}),"\n",(0,a.jsx)(c.p,{children:"在开发过程中，我们遇到了一些问题，比如云函数超时、数据格式解析错误等，通过调试和 Cursor AI 的帮助，我们一一解决了这些问题。最后，我们还对页面进行了样式优化，添加了更好的按钮样式和提示词折叠功能，使整个应用更加美观和实用。"})]})}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:c}=Object.assign({},(0,i.ah)(),e.components);return c?(0,a.jsx)(c,{...e,children:(0,a.jsx)(D,{...e})}):D(e)}let S=R;R.__RSPRESS_PAGE_META={},R.__RSPRESS_PAGE_META["Cursor%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A%EF%BC%9AAI%20%E9%A9%B1%E5%8A%A8%E7%9A%84%E6%99%BA%E8%83%BD%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E8%AF%BE%E7%A8%8B%2F30-%E6%96%87%E7%94%9F%E5%9B%BE%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98%20%EF%BD%9C%204.%20%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0.md"]={toc:[{text:"基础结构搭建",id:"基础结构搭建",depth:2},{text:"页面组件开发",id:"页面组件开发",depth:2},{text:"云函数配置环境变量",id:"云函数配置环境变量",depth:2},{text:"核心功能和云函数开发",id:"核心功能和云函数开发",depth:2},{text:"页面样式优化",id:"页面样式优化",depth:2},{text:"底部按钮样式优化",id:"底部按钮样式优化",depth:3},{text:"推荐提示词增加一个收起按钮",id:"推荐提示词增加一个收起按钮",depth:3},{text:"测试下三个页面类型的生成效果",id:"测试下三个页面类型的生成效果",depth:2},{text:"总结",id:"总结",depth:2}],title:"30-文生图微信小程序实战 ｜ 4. 核心功能实现",headingTitle:"30-文生图微信小程序实战 ｜ 4. 核心功能实现",frontmatter:{}}}}]);