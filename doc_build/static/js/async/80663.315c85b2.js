"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["80663"],{790981:function(e,s,n){n.r(s),n.d(s,{default:()=>g});var d=n(552676),r=n(740453);let i=n.p+"static/image/5a31afcf644378bd1287ae4cd614ee49.6a741e68.webp",c=n.p+"static/image/9849791a39e8551a11026e631268cefd.8be4e453.webp",t=n.p+"static/image/c103aa4fbd183ff6fbe8c7f0d325213c.35fa0207.webp",h=n.p+"static/image/93057500bb28c680f2d954c9cec79468.b97f5acc.webp",l=n.p+"static/image/c463e9638ec6b79e276169b488e482ed.b5f55419.webp",p=n.p+"static/image/6e634e1592d4d41efafe659a4cc04568.47bf5868.webp",x=n.p+"static/image/ee093b7783cc6cf01c9bd68e6762c1da.f7786581.webp",a=n.p+"static/image/d5741054e46f03608e1d1c2d13bd0421.b3ae4414.webp",j=n.p+"static/image/c6ab6012dbe22db91abd60b4dcda200d.34adf632.webp",o=n.p+"static/image/ada028c74664822b70c09c494a28a488.f7517dfd.webp",A=n.p+"static/image/852badf0c0378ccd4e9d6f7b65a3e724.7681b4c5.webp";function u(e){let s=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",img:"img",ul:"ul",li:"li",blockquote:"blockquote",h4:"h4",pre:"pre"},(0,r.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(s.h1,{id:"40pm2-实现一键部署云端服务器",children:["40.pm2 实现一键部署云端服务器",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#40pm2-实现一键部署云端服务器",children:"#"})]}),"\n",(0,d.jsxs)(s.h2,{id:"前言",children:["前言",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#前言",children:"#"})]}),"\n",(0,d.jsx)(s.p,{children:"项目到此也进入尾声阶段了，本章节将会介绍如何将这个管理后台项目部署到云服务器上。注意，这里部署的是云服务器，所以，读者首先需要购买一台云服务器，无论是阿里云还是腾讯云，其本质都是一样的，目的就是在服务器通过仓库地址，远程获取代码，并自动部署。"}),"\n",(0,d.jsxs)(s.p,{children:["笔者购买的是阿里云的服务器，并且配置的是 ",(0,d.jsx)(s.code,{children:"CentOS"})," 的系统，因为它是基于 ",(0,d.jsx)(s.code,{children:"unix"}),"，对开发比较友好。"]}),"\n",(0,d.jsx)(s.p,{children:"整个部署的大致流程如下："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:A,alt:""})}),"\n",(0,d.jsx)(s.p,{children:"如上图所示，分为三个端，分别是代码仓库、服务器、浏览器。"}),"\n",(0,d.jsxs)(s.p,{children:["服务器负责拉取仓库中的代码，拉取完后一顿操作构建，构建的过程类似开发者们在本地运行 ",(0,d.jsx)(s.code,{children:"npm run build"}),"。构建完后出来一个 ",(0,d.jsx)(s.code,{children:"dist"})," 目录，需要将 ",(0,d.jsx)(s.code,{children:"dist"})," 目录内的 ",(0,d.jsx)(s.code,{children:"index.html"})," 运行在一个 web 服务上，具体怎么运行，后面会详细描述。最后，就可以在浏览器上通过 ",(0,d.jsx)(s.code,{children:"服务器 IP + 端口"})," 的形式打开项目，如果有域名也可以配置成域名访问的形式。"]}),"\n",(0,d.jsxs)(s.p,{children:["上述整个过程，可以通过 ",(0,d.jsx)(s.code,{children:"pm2"})," 这个工具全程自动化完成。"]}),"\n",(0,d.jsx)(s.p,{children:"pm2 自动化部署，需要做好几个前置条件。"}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"服务器配置 ssh。"}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["代码仓库设置好服务器的 ssh 公钥","（目的是让服务器可以通过 ssh 的形式拉取仓库代码）","。"]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsxs)(s.p,{children:["设置好本地免密登录服务器","（目的是让 pm2 本地执行的时候，不用密码就能远程登录服务器）","。"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"注意：配置的过程可能会遇到很多问题，就跟打怪升级一样，不经历一些困难，很难形成自己的一套理解是思路。"}),"\n"]}),"\n",(0,d.jsxs)(s.h2,{id:"ssh-配置",children:["ssh 配置",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#ssh-配置",children:"#"})]}),"\n",(0,d.jsxs)(s.h4,{id:"什么是-ssh",children:["什么是 ssh",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#什么是-ssh",children:"#"})]}),"\n",(0,d.jsx)(s.p,{children:"百度百科给出的定义是："}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"SSH 为 Secure Shell 的缩写，由 IETF 的网络小组（Network Working Group）所制定；SSH 为建立在应用层基础上的安全协议。SSH 是较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用 SSH 协议可以有效防止远程管理过程中的信息泄露问题。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"一句话概括："}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"SSH是一种网络协议，用于计算机之间的加密登录。"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"服务器也是一台计算机，只不过它是远端的计算机，大家买的阿里云、腾讯云等服务器，相当于一台常年开启状态的计算机，可以通过 dos 界面进行操作，也可以通过市面上的服务器可视化工具进行管理。"}),"\n",(0,d.jsxs)(s.h4,{id:"本地安装-ssh",children:["本地安装 ssh",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#本地安装-ssh",children:"#"})]}),"\n",(0,d.jsx)(s.p,{children:"如果已经安装过，忽略这部分的内容，没有安装的请继续往下看。"}),"\n",(0,d.jsxs)(s.p,{children:["如果开发机器是 Windows 系统，可以先在本地安装好 ",(0,d.jsx)(s.a,{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",children:"git"}),"，然后通过命令行来到项目的 ",(0,d.jsx)(s.code,{children:"~"})," 路径下，运行如下指令生成 ",(0,d.jsx)(s.code,{children:"ssh key"}),"："]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:'ssh-keygen -t rsa -C "xxxxx@xxxxx.com"\n'})}),"\n",(0,d.jsxs)(s.p,{children:["上述邮箱地址写邮箱地址，这里不一定要写邮箱，只是为了方便找到生成的 ",(0,d.jsx)(s.code,{children:"ssh key"})," 是谁的。"]}),"\n",(0,d.jsxs)(s.p,{children:["执行完成后，前往 ",(0,d.jsx)(s.code,{children:"~/.ssh"})," 路径下，查看是否生成好了相应的公钥。我的如下所示："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:o,alt:""})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.code,{children:"id_rsa.pub"})," 文件里面的内容，就是需要的公钥内容。"]}),"\n",(0,d.jsxs)(s.p,{children:["拿到它之后，进入阿里云服务器，同样先看看本地是否有设置好公钥，打开 ",(0,d.jsx)(s.code,{children:"~/.ssh"})," 查看。如果是刚买的服务器，建议先全局安装好 ",(0,d.jsx)(s.code,{children:"git"}),"，然后再去查看 ",(0,d.jsx)(s.code,{children:"~/.ssh"}),"，正常情况下是如下所示："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:j,alt:""})}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"如果没有内容，建议按照本地配置 ssh key 的方法，在服务器端再做一次配置。"}),"\n"]}),"\n",(0,d.jsxs)(s.p,{children:["上图中的 ",(0,d.jsx)(s.code,{children:"authorized_keys"})," 文件，就是设置本地免密登录的文件，只要把之前本地生成的 ",(0,d.jsx)(s.code,{children:"id_rsa.pub"})," 内容放入 ",(0,d.jsx)(s.code,{children:"authorized_keys"})," 中，在本地命令行工具执行 ",(0,d.jsx)(s.code,{children:"ssh root@服务器IP"}),"，便能直接免密登录。"]}),"\n",(0,d.jsx)(s.p,{children:"顺利的话，就能够看到如下的过程："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:"data:image/webp;base64,UklGRsIFAABXRUJQVlA4ILYFAAAwWwCdASrKBBIBPp1OpU4lpCOiIDYIELATiWlu4XdhEUPAfNBtkQPUDq5SII3rvgWQOI3SjzPP+j5aPqcBEEHU6SI3JB1d4GpGD2zCsUowp7MbzcT2XuCx17aaYAZ+VsDXCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QKFoPp4gjV5wQJTgfC08AS1e3Q4ueUF3U4KCjkMqyMAu7W2dst9AQ5XF/ANhMdxvQ77cteirhBkENVSa7bRcIMghqqTXbaLhBkENVSbBHt7Huy+9BbmeSOqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttMvcUtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJrttFwgyCGqpNdtouEGQQ1VJroAAA/v/csMQcYNPU8H/69uKafyHyatgMxhJiuXih8SGpWb8fMNDfWguI4X+aJWUYJVWVOK4Rblkd6I+tmkszIfF+wLgD0Cg9VnZIMHbmWIBZY15GWJJV2gF3yTJB/cRSBlqGYqmcA75Qyh8zKK9xFpfU6eZYmDelRsbsCVzP+xmG39ugaPQ2V1nda+aTfpl7e4NNuxHk34sC/XpicJ4q3fEvZX+Se5i8LLy3ecOMQmNcseiuc3+VvD36HD/5nwqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMEqsowSqyjBKrKMD3q7h/NDoUzr9dAXQ9unDrLn+J9N7/ts++9wiNGc8twQJMx8JlDr7DJk/3VRmgw1tbqyPwdvwQud4UF9/tfM+9zHfOd042wiKWVYrqvcDBhxm1UG7R26U4ZZ7PE3Cy/xin1YmeqctvV2hAhl/jszD12bRflc+xJFM12MhPEz/y/n/wSGxZq7GMpUWYPtoaEb1sMFJtdNSi2ffQdOH0wArzDd1yWsWREQrbSX94KZezT/1rcH9/Vrsth3RXkcDKWmHNN0mFjQ3vr9xdAsZ7yhH5y06/kcVeknoMftb3iUr9lA3/XaJTxHOIw+tw5Xt18kPbqLa5Jf7F3x3wOjR+lud/VPwFMJLO7i+pz/XNrBjSZy2SXM0CNDrwgMuQFCL4XiEoFDhvKj+Bi0M9S3tbXgAP+7m8jBM7odmXHjNRGlP9LnRZhi5/VcuMK1SVD9PxJeFA2MPIygThCuTP8g6NiXU+AAABtaR/4JWv1zz2AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",alt:""})}),"\n",(0,d.jsx)(s.p,{children:"非常的丝滑，如果有遇到问题的小伙伴，可以添加小册官方 QQ 群，我会在群内免费为你解答。"}),"\n",(0,d.jsxs)(s.p,{children:["既然服务器的 ",(0,d.jsx)(s.code,{children:"id_rsa.pub"})," 也有了，就顺带将其复制出来，粘贴到仓库的权限配置里，如下所示，以 ",(0,d.jsx)(s.code,{children:"Github"})," 为例："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:a,alt:""})}),"\n",(0,d.jsxs)(s.p,{children:["点击「New SSH key」按钮，随便填写一个 ",(0,d.jsx)(s.code,{children:"Title"}),"，然后将服务器的 ",(0,d.jsx)(s.code,{children:"id_rsa.pub"})," 公钥拷贝到内容里点击确认。"]}),"\n",(0,d.jsxs)(s.p,{children:["这样服务器就可以通过 ",(0,d.jsx)(s.code,{children:"ssh"})," 的形式获取你仓库里的代码。你可以尝试在服务器拉取一下 Github 仓库的代码，记得通过 ",(0,d.jsx)(s.code,{children:"ssh"})," 的方式拉取。"]}),"\n",(0,d.jsxs)(s.h2,{id:"pm2-配置自动化部署",children:["pm2 配置自动化部署",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#pm2-配置自动化部署",children:"#"})]}),"\n",(0,d.jsxs)(s.p,{children:["此时回到项目中，先来描述一下项目从打包到部署到 ",(0,d.jsx)(s.code,{children:"web"})," 服务器上的一个过程。"]}),"\n",(0,d.jsxs)(s.p,{children:["首先，运行 ",(0,d.jsx)(s.code,{children:"npm run build:release"})," 命令之后，项目会打包出一个 ",(0,d.jsx)(s.code,{children:"dist"})," 文件，观察这个 ",(0,d.jsx)(s.code,{children:"dist"})," 文件有什么内容："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:x,alt:""})}),"\n",(0,d.jsx)(s.p,{children:"如上图所示："}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"assets：存放打包后的静态资源，如 js、css、图片等。"}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"index.html：项目入口页面，就是整个项目需要通过这个页面初始化，内部也看到了引入了 index.xxx.js，这是整个项目的 js 脚本。"}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"现在需要想方设法让 index.html 跑在服务器上的某个端口。"}),"\n",(0,d.jsx)(s.p,{children:"这里，为大家推荐一个比较好用的一个插件，通过命令行安装它："}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"npm i pushstate-server\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.code,{children:"pushstate-server"})," 为什么提供了很便捷的启动  ",(0,d.jsx)(s.code,{children:"web"})," 服务的配置，内部的原理是通过 ",(0,d.jsx)(s.code,{children:"connect"})," 服务器，开启一个端口，将 ",(0,d.jsx)(s.code,{children:"dist/index.html"})," 文件作为静态模板输出。"]}),"\n",(0,d.jsxs)(s.p,{children:["安装好之后，在管理后台项目的根目录添加 ",(0,d.jsx)(s.code,{children:"vue3-admin-server.js"})," 文件，内容如下："]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-js",children:"const server = require('pushstate-server')\n\nserver.start({\n  port: 5018,\n  directory: './dist'\n})\n"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"port：需要启动的端口号。"}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["\n",(0,d.jsx)(s.p,{children:"directory：index.html 所在的目录路径，这里直接写相对路径就好。"}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"配置好上述内容之后，就需要引入 pm2 的概念了，它是一个进程管理工具，对于前端而言最重要的功能便是进程守护，通过它启动的 node 服务，服务挂了会自动拉起项目。"}),"\n",(0,d.jsxs)(s.p,{children:["在管理后台根目录新增 ",(0,d.jsx)(s.code,{children:"ecosystem.config.js"}),"，在项目本地执行 pm2 的时候，会匹配的项目根目录下的 ",(0,d.jsx)(s.code,{children:"ecosystem.config.js"})," 文件，并且执行它的配置。配置如下："]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-js",children:"module.exports = {\n  apps: [\n    {\n      name: 'vue3-admin', // 项目名称\n      script: 'vue3-admin-server.js' // 要执行的脚本，也就是我们上文中利用 pushstate-server 工具执行 dist 目录内容的脚本。\n    },\n  ],\n  deploy: {\n    production: {\n      user: 'root', // 通过root权限进入服务器\n      host: '47.99.134.126', // 服务器ip地址\n      ref: 'origin/main', // 要拉取代码的分支\n      repo: 'git@git.zhlh6.cn:newbee-ltd/vue3-admin.git', // 代码仓库地址，我存放的是 Github\n      path: '/workspace/vue3-admin', // 拉取代码后，存放在服务器的文件地址。\n      'post-deploy': 'git reset --hard && git checkout main && git pull && npm i --production=false && npm run build:release && pm2 startOrReload ecosystem.config.js', // 顺序执行这些指令，最后 pm2 startOrReload ecosystem.config.js 会通过 pm2 启动 vue3-admin-server.js\n      env: {\n        NODE_ENV: 'production'\n      }\n    }\n  }\n}\n"})}),"\n",(0,d.jsxs)(s.p,{children:["首次执行的时候，由于服务器并没有 ",(0,d.jsx)(s.code,{children:"vue3-admin"})," 这个项目，所以我们需要初始化一下项目，如下所示："]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"pm2 deploy ecosystem.config.js production setup\n"})}),"\n",(0,d.jsxs)(s.p,{children:["执行上述指令之前，可以观察服务器内的 ",(0,d.jsx)(s.code,{children:"/workspace"})," 文件夹内并没有该文件："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:p,alt:""})}),"\n",(0,d.jsx)(s.p,{children:"在项目根目录下执行它："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:l,alt:""})}),"\n",(0,d.jsx)(s.p,{children:"如上图所示，就表示成功了，观察服务器上的文件目录："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:h,alt:""})}),"\n",(0,d.jsxs)(s.p,{children:["此时已经有了 ",(0,d.jsx)(s.code,{children:"vue3-admin"})," 项目，接下来就是自动化执行整个部署流程，执行指令："]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"pm2 deploy production\n"})}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"注意，代码一定要先提交，因为服务器需要拉取最新的代码，这里必须要保持本地 commit 是没有未提交的。"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:"部署过程如下所示："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:"data:image/webp;base64,UklGRkoFAABXRUJQVlA4ID4FAAAQOQCdASr0ATkBPp1Ook2lpCMiILlYWLATiWlu/HyZxwQFCA2y3PG+jneM95E/v2AQdov+O5WFQC7L30dqjdbMn8QHAu+CYdN/qPHR+a/6b2CP1x300FJHxMLIDGcILtWZW/MOW2NfinhziVZBFXTWYhcGaLN8Tb+UWuy8Gz86o0oNgYt3zeIrsFkaVjfkSqDgDczAYgi+OQVtqxBF8cgrbViCL45BW2rEEX2wF37ue8LDi9tCxeJmRJ4n+fn6Fw2XT9Byk37BVmuiBVi8ix46QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zFDgCrItsxgF0x0hMAVZEC/vBNYlVN7O2ABVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVkW2YwC6Y6QmAKsi2zGAXTHSEwBVjIAA/ra35iwnRMCTrkM9+uxGNklMaxm0pKgFxQxqdeoVmOSorp2bCMyGEf7vOj8HkQ8wfzfpu259QMVhpzIpZdaz4cmOAsp7TO/v/DzOf3lFg0jJSnTzG34p6PiQerv3zErl2cqR6xaQuhfYq0zE27IHletpmA4/vzxvXWEDgkyZ3RRxAw/mxOQpyLdL+CcSGxCkbAKsfVQHuvFbtJUVKbgqVv82uS27joBv70VhWZdET+kc/XeR4BbyP5hMFX6INlM4Ff4XsNIqbdpk1c256Spai4fxjbK5AZNOdXuthJ96N1trIVjq77hZbpNfd0ZDULK0rtiGQ3DP3f6Ne8+RQe3ynaj8eAWPuABrySIr6X+oSnQmiymo0u0D/xvRsND/Fi5qnFF3JpBXuk+dpLb9pbZ8IOqenDe5dC374d0HgVFewLczBb+rLheFfRQLdxyQYoV4N+HJ9jxcjZlYH6BqpkrWutIzU46aie7/A2gQY/NSEKPqWuBxx8ZFGEq3Bh519OxiPe/sIHgbe9ptBp7NdZGx0+ZD5simvdwL/o2k9A4ZNp3tsV9WCdGBU880LRnznuBKbxDxqkNdhYGlkNVqj9p5frBYnoQb+Hh/MdzBMfROtMXKa2XCaCYDiajCc/uO+Ptz7XuGW4ezJcOaUUy5gglqDeGxXOyAPiy0RdbyvPnYCuOFIqD1KsI6l+/XXpuXJftYCeGZT7PluiJyr1DNuUmtHVAqNcul/xMox53/R5jRHra18SP9NUpvcXr1b60O01mL3arIHjCzr/Q2+cW//+70vXcTRZghKw3odVFgWtuaZ2ZPWja45aSASaJEE9J/LutJsAN5NOn1sRu9wrkeT6o839pKr6SJBT+bRsAE7C2PrjVSPHTag7Muvms7mC9PaBdNf6gCGvHwbWIztv6AexP5hfzz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/PP88/zz/QBVihat8FnRIxzxGqgbeJIzfgMihacNNnupq2B5+RUXqE4CMRdeCgAAAApAIAAAAY9URroIKBwU75XfScZsakFyKWIP77myLP9cijwhmF0tPLooia6i92NrUM6jejDqGnlZvybQJ345BHnvpJBpmXLCOcLT7O0GcNu5D5WVxQmAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",alt:""})}),"\n",(0,d.jsxs)(s.p,{children:["可以看到，先是拉取最新代码，然后在通过 npm i 安装工具包，再通过 ",(0,d.jsx)(s.code,{children:"npm run build:release"})," 打包，最后通过 ",(0,d.jsx)(s.code,{children:"pm2"})," 部署项目。"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:t,alt:""})}),"\n",(0,d.jsxs)(s.p,{children:["部署成功后，通过浏览器访问 ",(0,d.jsx)(s.code,{children:"47.99.134.126:5018"})," 地址，如下所示："]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:c,alt:""})}),"\n",(0,d.jsx)(s.p,{children:"如果有域名，配置好之后，访问地址就成了下图中的形式："}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)("img",{src:i,alt:"image-20210505130558827"})}),"\n",(0,d.jsxs)(s.p,{children:["之后每一次修改代码，推送到仓库之后，便可以通过 ",(0,d.jsx)(s.code,{children:"pm2 deploy"})," 完成自动部署工作，当然它是可以区分环境的，具体配置请查看 pm2 的官方网站。"]}),"\n",(0,d.jsxs)(s.h2,{id:"总结",children:["总结",(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,d.jsx)(s.p,{children:"本章节的方法论涉及到的知识点比较偏运维方向，需要掌握一定的服务端的知识。服务器购买后，需要安装 Node 环境，全局安装一些包如 pm2、git 等，否则无法在服务器中拉取和部署项目。"}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"文档最近更新时间：2022 年 9 月 20 日。"}),"\n"]})]})}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(u,{...e})}):u(e)}let g=m;m.__RSPRESS_PAGE_META={},m.__RSPRESS_PAGE_META["Vue3%20%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98%2F40.pm2%20%E5%AE%9E%E7%8E%B0%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E4%BA%91%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8.md"]={toc:[{text:"前言",id:"前言",depth:2},{text:"ssh 配置",id:"ssh-配置",depth:2},{text:"什么是 ssh",id:"什么是-ssh",depth:4},{text:"本地安装 ssh",id:"本地安装-ssh",depth:4},{text:"pm2 配置自动化部署",id:"pm2-配置自动化部署",depth:2},{text:"总结",id:"总结",depth:2}],title:"40.pm2 实现一键部署云端服务器",headingTitle:"40.pm2 实现一键部署云端服务器",frontmatter:{}}}}]);