"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["19536"],{63938:function(e,n,s){s.r(n),s.d(n,{default:()=>M});var i=s(552676),d=s(740453);let r=s.p+"static/image/76b7dd0270a3ac371fe540d7e0108be2.c3e40ee9.webp",c=s.p+"static/image/8e830a678a7d0fb7a983a1c55afeb0f8.d41fd30b.webp",a=s.p+"static/image/52501b7f8986a0307fd369dfa5b013b0.8a74e13a.webp",l=s.p+"static/image/140fe3d881f0b2c834d26619f3a6355d.5c02b557.webp",h=s.p+"static/image/087d4af9031081c60bde58a05579c7a8.a27334ab.webp",p=s.p+"static/image/82c4f116cced93e3f5065fd15e1b5e25.ac5fb18d.webp",j=s.p+"static/image/f28c9fc198ceed668409731565ef72c3.8271d62b.webp",x=s.p+"static/image/f817f242edf5b5757f13c88b02023055.25da5622.webp",t=s.p+"static/image/81f0f4e3a592f9ad5cb4a5e34d7dda5a.8275554c.webp",g=s.p+"static/image/b87a537ed9d0d994eb84f6f8592d5ebc.76bf3bbf.webp",m=s.p+"static/image/b665b764fe6cf541ddd65a9d90f330b8.41303047.webp",o=s.p+"static/image/2e8e3c6930ab2fbb27ddddd159dba341.8d261420.webp",b=s.p+"static/image/39e94fb345b990a232803b65839f9515.81940a2c.webp",f=s.p+"static/image/5c205213dbb9eb62488c071c76c6beb8.7e7f1cf8.webp",E=s.p+"static/image/d64eaa203e9939a0280656818d05a52e.7c10dd7d.webp",u=s.p+"static/image/28e5cc93ed66d3e3e3d1c6335b497c29.6982880b.webp",A=s.p+"static/image/ac57830a1260c154ec3d5ada44042075.31a045b2.webp",w=s.p+"static/image/0587697838e8af78778fa953e518b3fe.f200acfb.webp",B=s.p+"static/image/232f3ddaa9742da4682fe7953cc89b71.f6977ec6.webp";function C(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",img:"img",code:"code",pre:"pre",ol:"ol",li:"li",strong:"strong",ul:"ul"},(0,d.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"25-chrome翻译插件实战--3-翻译核心功能实现",children:["25-Chrome翻译插件实战 ｜ 3. 翻译核心功能实现",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#25-chrome翻译插件实战--3-翻译核心功能实现",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"本章我们将实现翻译助手的核心功能，包括弹出窗口界面、内容提取、翻译处理和结果展示。这些功能构成了插件的核心价值，让用户能够便捷地获取多语言内容的翻译。通过分步骤实现，我们将逐步构建一个功能完整的翻译工具。"}),"\n",(0,i.jsxs)(n.h2,{id:"阶段三弹出窗口与基本控制",children:["阶段三：弹出窗口与基本控制",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#阶段三弹出窗口与基本控制",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"我们按照实现步骤指南，让 Cursor 根据示意图完善翻译助手的主页面。"}),"\n",(0,i.jsx)(n.p,{children:'首先选中"阶段三：弹出窗口与基本控制"内容。'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:B,alt:"image.png"})}),"\n",(0,i.jsxs)(n.p,{children:["然后用 Command + i 快捷键把选中内容添加到右侧聊天窗口。和之前一样，选择 Agent 模式，用 ",(0,i.jsx)(n.code,{children:"Claude 3.7 Sonnet"})," 或 ",(0,i.jsx)(n.code,{children:"Claude 3.5 Sonnet"})," 模型。记得要新打开一个窗口。"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:w,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"下面是实现的页面效果，它和示意图基本一致，不需要调整。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:A,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"示意图如下，可以对比看看："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"+----------------------------------+\n|       Chrome翻译插件             |\n+----------------------------------+\n|                                  |\n| 语言选择:                        |\n| +------------+  +------------+   |\n| | 源语言 ▼   |  | 目标语言 ▼ |   |\n| +------------+  +------------+   |\n|                                  |\n| +------------------------------+ |\n| |        一键翻译页面         | |\n| +------------------------------+ |\n|                                  |\n| 下载选项:                        |\n| +------------+  +------------+   |\n| |  Markdown  |  |    PDF     |   |\n| +------------+  +------------+   |\n|                                  |\n| +------------------------------+ |\n| |           设置             | |\n| +------------------------------+ |\n|                                  |\n+----------------------------------+\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"阶段四和阶段五翻译功能实现",children:["阶段四和阶段五：翻译功能实现",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#阶段四和阶段五翻译功能实现",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"阶段四是内容提取与初步显示，阶段五是翻译处理与结果展示。我们把这两个阶段一起实现，这样更容易在页面上查看效果。"}),"\n",(0,i.jsx)(n.p,{children:'选中 "阶段四：内容提取与初步显示" 和 "阶段五：翻译处理与结果展示" 的内容。'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:u,alt:"image.png"})}),"\n",(0,i.jsxs)(n.p,{children:["新开一个窗口，把选中内容添加到右侧聊天窗口。输入下面的提示词，告诉 Cursor 要实现的模块功能和对应示意图。核心翻译功能用通过 ",(0,i.jsx)(n.code,{children:"@doc"})," 命令指定 DeepSeek API 实现。"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-perl",children:"根据 @需求文档.md @技术方案.md \n\n分别实现：\n1. 阶段四：内容提取与初步显示@04-示意图-内容页面.md @06-模块-内容提取.md \n2.  阶段五：翻译处理与结果展示 @07-模块-翻译处理.md 实现翻译的 DeepSeek API 文档 @Deepseek \n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:E,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"这个阶段是整个插件的核心，也是最复杂的部分。Cursor 写页面很厉害，但多个模块交互时，很难一次完成，需要多次调整。"}),"\n",(0,i.jsx)(n.p,{children:'完成上述任务后，我们遇到第一个问题：点击"一键翻译页面"按钮后，按钮一直转圈，页面没反应。'}),"\n",(0,i.jsx)(n.p,{children:"我们可以把页面截图给 Cursor，告诉它问题。也可以提示可能的原因，让它排查。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:f,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"下面是生成的效果："}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:b,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"现在 DeepSeek 翻译面板已经显示出来，但页面内容没有正常渲染，显示的是 HTML 代码。不过翻译的中文内容已经显示出来了。这一步的目的已经达到，我们先提交一次，然后进行下一阶段。"}),"\n",(0,i.jsxs)(n.h2,{id:"阶段六翻译面板完善与渲染优化",children:["阶段六：翻译面板完善与渲染优化",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#阶段六翻译面板完善与渲染优化",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:'选中"阶段六：翻译面板完善与渲染优化"内容。'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:o,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"新开一个窗口，把选中内容添加到右侧聊天窗口，告诉 Cursor 要实现的功能和示意图。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:m,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"下面是初步实现的效果："}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:g,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"我们发现几个问题："}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"翻译内容虽然正常渲染了，但结果不完整"}),"\n",(0,i.jsx)(n.li,{children:'控制台有警告："content.js:1 文本长度(29158)超过最大限制(8000)，将被截断"，这导致翻译不完整的原因'}),"\n",(0,i.jsx)(n.li,{children:"发送给 DeepSeek API 的请求内容过长，都是 HTML 代码"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"如果只是简单说翻译内容不完整，Cursor 很难修复好。我们需要告诉它具体原因：文本内容过长超过了限制。我们可以建议用分批发送的方法，保证翻译结果完整。还要先把 HTML 内容转为 Markdown 格式再发送。"}),"\n",(0,i.jsx)(n.p,{children:"提示词如下："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:"出现报错 “content.js:1 文本长度(29158)超过最大限制(8000)，将被截断”，之后导致翻译不完整\n\n你应该在截断之后，分批次发送，如果内容过长，可以分次发送，保证最终的翻译结果是完整的\n\n请先将提取的 HTML 内容转为 Markdown 格式发送到翻译接口，翻译面板要对 Markdown 内容做转换展示\n"})}),"\n",(0,i.jsx)(n.p,{children:"优化后的效果如下："}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:t,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"现在发送给翻译接口的内容已经从 HTML 转为 Markdown 格式了。根据控制台日志，也实现了分批发送。但我们发现一个新问题：翻译结果面板的图片没有正确加载。"}),"\n",(0,i.jsx)(n.p,{children:"我们先提交当前实现，再修复图片不显示的问题。"}),"\n",(0,i.jsx)(n.p,{children:"将当前实现打一个提交记录，再进行图片不展示问题修复。"}),"\n",(0,i.jsxs)(n.h2,{id:"图片不展示问题修复",children:["图片不展示问题修复",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#图片不展示问题修复",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"修复这个 bug 时，我新开了一个聊天窗口。看似是个小问题，但花了最长的时间。Cursor 一直解决不了，让我很着急。"}),"\n",(0,i.jsx)(n.p,{children:"如果直接修改代码可能更快，但我想完全用 Cursor 实现，只能慢慢引导它。"}),"\n",(0,i.jsx)(n.p,{children:"我让 Cursor 打印关键日志信息，不断把这些信息粘贴给它，让它排查问题。最后干脆让它重写代码。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:x,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:j,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:p,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:h,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"尝试多次后仍未解决，我放弃了这次会话，点击右下角的 “Reject all” 不接受修改。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:l,alt:"image.png"})}),"\n",(0,i.jsxs)(n.h2,{id:"换个思路解决图片渲染问题",children:["换个思路解决图片渲染问题",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#换个思路解决图片渲染问题",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"前面我们在响应过程中解析结果处理图片，现在换个思路。"}),"\n",(0,i.jsx)(n.p,{children:"让 Cursor 在所有内容翻译完成后，根据图片占位符规则替换为真实图片链接并显示。同时提醒它在写入图片占位符时保存提取的图片，替换时调用这些图片。"}),"\n",(0,i.jsx)(n.p,{children:"之前 Cursor 虽然保存了图片映射关系，但替换时没有调用，而是重新提取，导致对不上。这说明即使是简单逻辑，当模块多了后，对 AI 也有挑战。"}),"\n",(0,i.jsx)(n.p,{children:"这次交互两次后终于成功了。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:a,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:c,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"最终翻译面板效果如下，左侧是原文，右侧是我们插件的翻译结果："}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:r,alt:"image.png"})}),"\n",(0,i.jsx)(n.p,{children:"翻译面板的主要功能已经完成。当然还有些细节可以优化，让界面更美观，但这需要更多时间和 Cursor 交互。下一节我们将实现导出功能。"}),"\n",(0,i.jsxs)(n.h2,{id:"总结与思考",children:["总结与思考",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结与思考",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"在本章中，我们成功实现了翻译助手的核心功能："}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"弹出窗口界面"}),"：创建了直观的用户界面，包括语言选择、翻译按钮和下载选项"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"内容提取"}),"：从网页中提取需要翻译的内容"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"翻译处理"}),"：通过 DeepSeek API 实现多语言翻译"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"结果展示"}),"：优化了翻译结果的显示，包括正确渲染 Markdown 内容和图片"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"在实现过程中，我们遇到并解决了几个关键问题："}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"文本长度超限问题：通过分批发送解决"}),"\n",(0,i.jsx)(n.li,{children:"HTML 转 Markdown：提高了翻译质量和渲染效果"}),"\n",(0,i.jsx)(n.li,{children:"图片渲染问题：通过占位符和映射关系实现"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"这个过程也展示了使用 AI 辅助编程的优势和挑战。Cursor 在页面实现方面表现出色，但在复杂逻辑和多模块交互时需要更多引导。有时简单的问题反而需要更多时间解决，这提醒我们在使用 AI 工具时要灵活调整策略，有时直接修改代码可能更高效。"}),"\n",(0,i.jsx)(n.p,{children:"下一章我们将继续完善翻译助手，实现导出功能，让用户能够以不同格式保存翻译结果。"})]})}function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,d.ah)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(C,{...e})}):C(e)}let M=k;k.__RSPRESS_PAGE_META={},k.__RSPRESS_PAGE_META["Cursor%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A%EF%BC%9AAI%20%E9%A9%B1%E5%8A%A8%E7%9A%84%E6%99%BA%E8%83%BD%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%E8%AF%BE%E7%A8%8B%2F25-Chrome%E7%BF%BB%E8%AF%91%E6%8F%92%E4%BB%B6%E5%AE%9E%E6%88%98%20%EF%BD%9C%203.%20%E7%BF%BB%E8%AF%91%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0.md"]={toc:[{text:"阶段三：弹出窗口与基本控制",id:"阶段三弹出窗口与基本控制",depth:2},{text:"阶段四和阶段五：翻译功能实现",id:"阶段四和阶段五翻译功能实现",depth:2},{text:"阶段六：翻译面板完善与渲染优化",id:"阶段六翻译面板完善与渲染优化",depth:2},{text:"图片不展示问题修复",id:"图片不展示问题修复",depth:2},{text:"换个思路解决图片渲染问题",id:"换个思路解决图片渲染问题",depth:2},{text:"总结与思考",id:"总结与思考",depth:2}],title:"25-Chrome翻译插件实战 ｜ 3. 翻译核心功能实现",headingTitle:"25-Chrome翻译插件实战 ｜ 3. 翻译核心功能实现",frontmatter:{}}}}]);