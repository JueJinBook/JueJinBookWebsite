"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["34949"],{386462:function(e,n,s){s.r(n),s.d(n,{default:()=>S});var c=s(552676),r=s(740453);let d=s.p+"static/image/9010c914bba881e7a40685b481153f95.fb36df25.webp",i=s.p+"static/image/90a2652fd88598e42696de6b5a3a8dd4.f08c13a2.webp",a=s.p+"static/image/f8e4d8e958680fff824941caae2e1fb1.c22c976c.webp",l=s.p+"static/image/9e833caf05a90e89931d049f756dbd31.549c53f0.webp",t=s.p+"static/image/cf286a2c7e21c75800ce89402818fed7.80ae9d1d.webp",h=s.p+"static/image/5767eba662a9598d40a0f3909f8c3955.fdfdb70c.webp",j=s.p+"static/image/a8cefa9f710fcc022a1897b2d83e5d2f.16260006.webp",o=s.p+"static/image/1c4af4de106572786faae3c57f68bbfb.e9e9c6eb.webp",x=s.p+"static/image/649939ec03415ad716d9292174f510de.2275fc49.webp",p=s.p+"static/image/ba292cbcc0494c370a36a5aa35c4952e.c4da6d49.webp",g=s.p+"static/image/e08ebbc91646b7f4f510976971f5aa2f.53085808.webp",m=s.p+"static/image/c38ee3d051d58ae419f9be50edb8f7d4.ac89714a.webp",u=s.p+"static/image/4a6f123c4cefb86e5b1825e8654950fc.d5e266f1.webp",f=s.p+"static/image/0370eaa03309cb431563f2271a99860d.95732ae9.webp",b=s.p+"static/image/05a7c510f288f04c6665bc4be005be43.6cd616d9.webp",E=s.p+"static/image/f5f75ffa12f8a330f0ce8d9c4c42f98a.ba4f0726.webp",w=s.p+"static/image/662fc802d837e41f4c43a23225dda136.e145aa31.webp",y=s.p+"static/image/586fa6b12f6468e7c93e4ca0f04bbbed.927315b9.webp",A=s.p+"static/image/10d9e26148c8b68cb59bff7786687529.9253d9de.webp",N=s.p+"static/image/d6bf4d32d694f1248a3ed060e4e2e308.3bae5fde.webp",v=s.p+"static/image/12ca789dd2bd75be176846b3a3974288.1be4841d.webp",B=s.p+"static/image/6f99a15275b5c087cb73454e045aed9d.7579a15b.webp",q=s.p+"static/image/2594994250c31888f5e90292696ee187.661ac902.webp";function k(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",h4:"h4",img:"img",blockquote:"blockquote",pre:"pre"},(0,r.ah)(),e.components);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.h1,{id:"4后端预备可视化数据库工具-dbeaver-的安装和使用",children:["4.后端预备：可视化数据库工具 DBeaver 的安装和使用",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4后端预备可视化数据库工具-dbeaver-的安装和使用",children:"#"})]}),"\n",(0,c.jsxs)(n.h2,{id:"前言",children:["前言",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#前言",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["说到可视化工具，大家可能会提到 ",(0,c.jsx)(n.code,{children:"Navicat"}),"，很遗憾它是付费的，作为教程不能为大家分析它的破解方法，这样会涉及到侵权。但是 ",(0,c.jsx)(n.code,{children:"DBevaer"})," 所展现出的能力，有过之而无不及，并且它还是免费开源的。"]}),"\n",(0,c.jsxs)(n.p,{children:["大家可以先去 ",(0,c.jsx)(n.code,{children:"DBevaer"})," ",(0,c.jsx)(n.a,{href:"https://dbeaver.io/download/",target:"_blank",rel:"noopener noreferrer",children:"官方网站"}),"下载相应系统环境的安装包，它提供了 ",(0,c.jsx)(n.code,{children:"Windows"}),"、",(0,c.jsx)(n.code,{children:"Mac"})," 和 ",(0,c.jsx)(n.code,{children:"Linux"})," 三个版本，大家可以自行安装。"]}),"\n",(0,c.jsxs)(n.h2,{id:"连接本地数据库",children:["连接本地数据库",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#连接本地数据库",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["我们在上一章节开启了 ",(0,c.jsx)(n.code,{children:"MySQL"})," 的本地服务，但是我们希望用肉眼可见的方式去操作数据库。当然，有的同学喜欢用命令行操作数据库，这也是可行的。只不过考虑到大多数同学还是初学阶段，故采用可视化的形式，比较容易理解。"]}),"\n",(0,c.jsxs)(n.h4,{id:"打开-dbevaer-连接本地数据库",children:["打开 DBevaer 连接本地数据库",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#打开-dbevaer-连接本地数据库",children:"#"})]}),"\n",(0,c.jsx)(n.p,{children:"我们打开软件，界面如下："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:q,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["点击左上角的小插头 \uD83D\uDD0C  新建连接，我们选择 ",(0,c.jsx)(n.code,{children:"MySQL"})," 数据库："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:B,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"点击「下一步」后，出现如下界面："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:v,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"上图中，我没有填写数据库名称，是因为初始化情况下，没有建任何数据库。所以，如果你要是想要连接具体哪一个数据库，这里就可以写上相应的名称。"}),"\n",(0,c.jsx)(n.p,{children:"数据库密码必须是你之前设置好的初始化密码，所以这个密码一定要记住，最好是记在你的记事本上。设置好之后，点击完成。"}),"\n",(0,c.jsxs)(n.p,{children:["如果是 ",(0,c.jsx)(n.code,{children:"Windows"})," 系统的同学，通过管理员打开 ",(0,c.jsx)(n.code,{children:"cmd"}),"，通过下图指令启动 ",(0,c.jsx)(n.code,{children:"MySQL"})," 之后，无需输入密码，也可以连接到本地的数据库："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:N,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:A,alt:""})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"注意，本地服务一定要开启，否则无法连接成功，在第 3 章有详细的讲解。"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"成功之后如下，我的本地已经新建了一些数据库，如下所示："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:y,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["正常情况下，你只会有一个默认的 ",(0,c.jsx)(n.code,{children:"sys"}),"。"]}),"\n",(0,c.jsxs)(n.p,{children:["此时我们已经通过 ",(0,c.jsx)(n.code,{children:"DBevaer"})," 成功连通了数据库，我们接下来新建一个测试数据库，让 ",(0,c.jsx)(n.code,{children:"Egg"})," 能成功的连接上，并且做一些简单的 ",(0,c.jsx)(n.code,{children:"CRUD"}),"。"]}),"\n",(0,c.jsxs)(n.h2,{id:"egg-连接-mysql",children:["Egg 连接 MySQL",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#egg-连接-mysql",children:"#"})]}),"\n",(0,c.jsx)(n.p,{children:"首先我们新建一个数据库，用于后续的测试操作，如下所示："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:w,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["新建一个名为 ",(0,c.jsx)(n.code,{children:"test"})," 的数据库："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:E,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["其次，在 ",(0,c.jsx)(n.code,{children:"test"})," 数据库下新建一张数据表，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:b,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:f,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["再在 ",(0,c.jsx)(n.code,{children:"list"})," 表下新建列："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:u,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["数据类型选择 ",(0,c.jsx)(n.code,{children:"INT"}),"，非空和自增都勾选上，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:m,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["每一张表都需要有一个主键，上述 ",(0,c.jsx)(n.code,{children:"list"})," 表，我们就以 ",(0,c.jsx)(n.code,{children:"id"})," 为主键，点击下图「约束」-> 「新建约束」："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:g,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["我们保存 ",(0,c.jsx)(n.code,{children:"list"})," 表，选择执行："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:p,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["完成之后，我们给 ",(0,c.jsx)(n.code,{children:"id"})," 默认一条数据，切换到「数据」。"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:x,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["同样的步骤，我们给 ",(0,c.jsx)(n.code,{children:"list"})," 表再新增 ",(0,c.jsx)(n.code,{children:"name"})," 属性，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:o,alt:""})}),"\n",(0,c.jsxs)(n.h4,{id:"查询接口",children:["查询接口",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#查询接口",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["保存数据之后，我们打开第 1 章新建好的项目 ",(0,c.jsx)(n.code,{children:"egg-example"}),"，安装插件 ",(0,c.jsx)(n.code,{children:"egg-mysql"})," 如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"npm install egg-mysql\n"})}),"\n",(0,c.jsxs)(n.p,{children:["打开 ",(0,c.jsx)(n.code,{children:"config/plugin.js"})," 添加插件配置："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"'use strict';\n\n/** @type Egg.EggPlugin */\nmodule.exports = {\n  ejs: {\n    enable: true,\n    package: 'egg-view-ejs'\n  },\n  mysql: {\n    enable: true,\n    package: 'egg-mysql'\n  }\n};\n"})}),"\n",(0,c.jsxs)(n.p,{children:["打开配置文件 ",(0,c.jsx)(n.code,{children:"config/config.default.js"}),"，添加 ",(0,c.jsx)(n.code,{children:"mysql"})," 连接配置项："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"exports.mysql = {\n  // 单数据库信息配置\n  client: {\n    // host\n    host: 'localhost',\n    // 端口号\n    port: '3306',\n    // 用户名\n    user: 'root',\n    // 密码\n    password: '数据库密码', // 初始化密码，没设置的可以不写\n    // 数据库名\n    database: 'test', // 我们新建的数据库名称\n  },\n  // 是否加载到 app 上，默认开启\n  app: true,\n  // 是否加载到 agent 上，默认关闭\n  agent: false,\n};\n"})}),"\n",(0,c.jsxs)(n.p,{children:["修改 ",(0,c.jsx)(n.code,{children:"service/home.js"})," 如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"'use strict';\n\nconst Service = require('egg').Service;\n\nclass HomeService extends Service {\n  async user() {\n    const { ctx, app } = this;\n    const QUERY_STR = 'id, name';\n    let sql = `select ${QUERY_STR} from list`; // 获取 id 的 sql 语句\n    try {\n      const result = await app.mysql.query(sql); // mysql 实例已经挂载到 app 对象下，可以通过 app.mysql 获取到。\n      return result;\n    } catch (error) {\n      console.log(error);\n      return null;\n    }\n  }\n}\nmodule.exports = HomeService;\n"})}),"\n",(0,c.jsxs)(n.p,{children:["修改 ",(0,c.jsx)(n.code,{children:"controller/home.js"})," 的 ",(0,c.jsx)(n.code,{children:"user"})," 方法如下："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"async user() {\n  const { ctx } = this;\n  const result = await ctx.service.home.user();\n  ctx.body = result\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["修改路由配置 ",(0,c.jsx)(n.code,{children:"router.js"}),"："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"router.get('/user', controller.home.user);\n"})}),"\n",(0,c.jsxs)(n.p,{children:["通过 ",(0,c.jsx)(n.code,{children:"npm run dev"})," 启动项目，我们在浏览器直接调用接口，如下所示代表成功。"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["我们通过 ",(0,c.jsx)(n.code,{children:"/user"})," 接口地址，获取到了 ",(0,c.jsx)(n.code,{children:"list"})," 表的 ",(0,c.jsx)(n.code,{children:"id"})," 和 ",(0,c.jsx)(n.code,{children:"name"})," 属性，以数组的形式返回。"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"如果通过 npm run dev 启动不成功，请前往第 3 章，Windiws 安装部分，第 5 步关键步骤，有提示如何修改 mysq 8.0 + 的加密规则。"}),"\n"]}),"\n",(0,c.jsxs)(n.h4,{id:"新增接口",children:["新增接口",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#新增接口",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["查询接口成功之后，我们来编写新增接口。在 ",(0,c.jsx)(n.code,{children:"service/home.js"})," 下新建一个函数 ",(0,c.jsx)(n.code,{children:"addUser"}),"，如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// 新增\nasync addUser(name) {\n  const { ctx, app } = this;\n  try {\n    const result = await app.mysql.insert('list', { name }); // 给 list 表，新增一条数据\n    return result;\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["再为 ",(0,c.jsx)(n.code,{children:"controller/home.js"})," 添加一个 ",(0,c.jsx)(n.code,{children:"addUser"})," 方法，如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"async addUser() {\n  const { ctx } = this;\n  const { name } = ctx.request.body;\n  try {\n    const result = await ctx.service.home.addUser(name);\n    ctx.body = {\n      code: 200,\n      msg: '添加成功',\n      data: null\n    }\n  } catch (error) {\n    ctx.body = {\n      code: 500,\n      msg: '添加失败',\n      data: null\n    }\n  }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["完成之后，添加路由，抛出供前端调用，打开 ",(0,c.jsx)(n.code,{children:"router.js"})," 添加如下代码："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"router.post('/add_user', controller.home.addUser);\n"})}),"\n",(0,c.jsxs)(n.p,{children:["打开 ",(0,c.jsx)(n.code,{children:"Postman"})," 发起一个 ",(0,c.jsx)(n.code,{children:"post"})," 请求，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:j,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["此时我们已经成功往数据库里添加了一条新的内容，我们不妨打开 ",(0,c.jsx)(n.code,{children:"DBevaer"})," 查看数据情况："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:h,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["刷新数据库后，我们可以看到 「我是新增的尼克陈」已经被添加到数据库 ",(0,c.jsx)(n.code,{children:"list"})," 表中，并且 ",(0,c.jsx)(n.code,{children:"id"})," 是自动增加的。"]}),"\n",(0,c.jsxs)(n.p,{children:["此时你再次请求 ",(0,c.jsx)(n.code,{children:"/user"})," 接口，你会拿到两条数据："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:t,alt:""})}),"\n",(0,c.jsxs)(n.h4,{id:"编辑接口",children:["编辑接口",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#编辑接口",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["编辑接口，就拿我们上述的内容来说，我们通过 ",(0,c.jsx)(n.code,{children:"/user"})," 拿到了列表数据，我们可以通过 ",(0,c.jsx)(n.code,{children:"id"})," 定位某条数据，去修改它的 ",(0,c.jsx)(n.code,{children:"name"})," 属性。"]}),"\n",(0,c.jsxs)(n.p,{children:["接下来我们来实现编辑接口，同理，我们打开 ",(0,c.jsx)(n.code,{children:"/service/home.js"}),"，添加编辑操作："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// 编辑\nasync editUser(id, name) {\n  const { ctx, app } = this;\n  try {\n    let result = await app.mysql.update('list', { name }, {\n      where: {\n        id\n      }\n    });\n    return result;\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["再前往 ",(0,c.jsx)(n.code,{children:"/controller/home.js"})," 添加如下代码："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// 编辑\nasync editUser() {\n  const { ctx } = this;\n  const { id, name } = ctx.request.body;\n  try {\n    const result = await ctx.service.home.editUser(id, name);\n    ctx.body = {\n      code: 200,\n      msg: '添加成功',\n      data: null\n    }\n  } catch (error) {\n    ctx.body = {\n      code: 500,\n      msg: '添加失败',\n      data: null\n    }\n  }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["别忘了添加路由配置，打开 ",(0,c.jsx)(n.code,{children:"router.js"})," 如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"router.post('/edit_user', controller.home.editUser);\n"})}),"\n",(0,c.jsxs)(n.p,{children:["我们打开 ",(0,c.jsx)(n.code,{children:"Postman"})," 对编辑接口进行调试，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:l,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["观察数据库 ",(0,c.jsx)(n.code,{children:"list"})," 表是否生效："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:a,alt:""})}),"\n",(0,c.jsxs)(n.h4,{id:"删除接口",children:["删除接口",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#删除接口",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["删除内容，一向都是比较容易的，我们继续在 ",(0,c.jsx)(n.code,{children:"/service/home.js"})," 添加删除接口，如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// 删除\nasync deleteUser(id) {\n  const { ctx, app } = this;\n  try {\n    let result = await app.mysql.delete('list', { id });\n    return result;\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["再次前往 ",(0,c.jsx)(n.code,{children:"/controller/home.js"})," 添加相应的控制器方法，如下所示："]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// 删除\nasync deleteUser() {\n  const { ctx } = this;\n  const { id } = ctx.request.body;\n  try {\n    const result = await ctx.service.home.deleteUser(id);\n    ctx.body = {\n      code: 200,\n      msg: '删除成功',\n      data: null\n    }\n  } catch (error) {\n    ctx.body = {\n      code: 500,\n      msg: '删除失败',\n      data: null\n    }\n  }\n}\n"})}),"\n",(0,c.jsx)(n.p,{children:"添加相应路由："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-js",children:"// router.js\nrouter.post('/delete_user', controller.home.deleteUser);\n"})}),"\n",(0,c.jsxs)(n.p,{children:["打开 ",(0,c.jsx)(n.code,{children:"Postman"})," 调试接口，如下所示："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:i,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:d,alt:""})}),"\n",(0,c.jsxs)(n.p,{children:["查看数据库，",(0,c.jsx)(n.code,{children:"id"})," 为 2 的数据已经被清楚了。"]}),"\n",(0,c.jsxs)(n.h2,{id:"总结",children:["总结",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,c.jsxs)(n.p,{children:["本章节带大家学习了可视化数据库 ",(0,c.jsx)(n.code,{children:"DBevaer"})," 的安装和使用，并且通过 ",(0,c.jsx)(n.code,{children:"Egg"})," 结合 ",(0,c.jsx)(n.code,{children:"Postman"})," 演示了一边数据库的「增删改查」操作。一个模块数据的「增删改查」，最基础的模式便是如此，而一个项目的落地，需要在此基础上增加各种复杂多变的逻辑与联系。后续我将带大家从 0 到 1，设计「记账本」项目的数据库表结构。"]}),"\n",(0,c.jsxs)(n.h4,{id:"本章节源代码",children:["本章节源代码",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#本章节源代码",children:"#"})]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://s.yezgea02.com/1620724318684/egg-example.zip",target:"_blank",rel:"noopener noreferrer",children:"点击下载"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"注意，数据库密码我已经清除，大家下载代码后，在 /config/config.default.js 配置项中填写自己的数据库密码。"}),"\n"]})]})}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(k,{...e})}):k(e)}let S=R;R.__RSPRESS_PAGE_META={},R.__RSPRESS_PAGE_META["Node%20%2B%20React%20%E5%AE%9E%E6%88%98%EF%BC%9A%E4%BB%8E%200%20%E5%88%B0%201%20%E5%AE%9E%E7%8E%B0%E8%AE%B0%E8%B4%A6%E6%9C%AC%2F4.%E5%90%8E%E7%AB%AF%E9%A2%84%E5%A4%87%EF%BC%9A%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%A5%E5%85%B7%20DBeaver%20%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.md"]={toc:[{text:"前言",id:"前言",depth:2},{text:"连接本地数据库",id:"连接本地数据库",depth:2},{text:"打开 DBevaer 连接本地数据库",id:"打开-dbevaer-连接本地数据库",depth:4},{text:"Egg 连接 MySQL",id:"egg-连接-mysql",depth:2},{text:"查询接口",id:"查询接口",depth:4},{text:"新增接口",id:"新增接口",depth:4},{text:"编辑接口",id:"编辑接口",depth:4},{text:"删除接口",id:"删除接口",depth:4},{text:"总结",id:"总结",depth:2},{text:"本章节源代码",id:"本章节源代码",depth:4}],title:"4.后端预备：可视化数据库工具 DBeaver 的安装和使用",headingTitle:"4.后端预备：可视化数据库工具 DBeaver 的安装和使用",frontmatter:{}}}}]);