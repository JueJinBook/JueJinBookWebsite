"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["13739"],{850368:function(n,e,s){s.r(e),s.d(e,{default:()=>m});var r=s(552676),t=s(740453);let d=s.p+"static/image/18001899778a0b65f583251b54d438f6.05d39ce7.webp",i=s.p+"static/image/2afba553a2378d79bc15d1a4cf776303.b43e9de4.webp",a=s.p+"static/image/2e35318d24e4585baebd875a23f7df07.df03b2bc.webp",c=s.p+"static/image/06993d3bac4fc61367e4e8f84978c193.6f51f2d2.webp",l=s.p+"static/image/9212d390d7e01d2cd14c990903c7de5b.ea299d00.webp",p=s.p+"static/image/3c8a5344f5f075d0527987e7f246ed7c.b357a049.webp",h=s.p+"static/image/f122a9fd965a0c23847439bc5ee2f47d.89a1962b.webp",A=s.p+"static/image/0b8f033735188c0c08f1af10fca6d63c.d8bc47f4.webp",o=s.p+"static/image/b497c6ebb7994f577c21ed690395739a.ff796428.webp";function x(n){let e=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",ul:"ul",li:"li",h3:"h3",img:"img",pre:"pre",code:"code",strong:"strong",ol:"ol",h4:"h4"},(0,t.ah)(),n.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.h1,{id:"8第八日玩转动画",children:["8.第八日：玩转动画",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#8第八日玩转动画",children:"#"})]}),"\n",(0,r.jsxs)(e.h2,{id:"第一个故事匀速圆周运动",children:["第一个故事：匀速圆周运动",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#第一个故事匀速圆周运动",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"动画是网页中常见的效果元素。我们在前面的故事中，也已经见过了一些动画，比如“让CSS做更多的事情”这一故事中，我们使用了CSS关键帧动画。"}),"\n",(0,r.jsx)(e.p,{children:"现代浏览器支持很多种动画方式，比如：CSS过渡动画、CSS关键帧动画、SVG动画、Web Animation API，我们还可以用JS自己实现动画。另外还有许多使用方便和功能强大的第三方动画库可以供我们使用。"}),"\n",(0,r.jsx)(e.p,{children:"今天的故事，我们将讲述两种最常用的动画模式："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"固定轨迹的动画"}),"\n",(0,r.jsx)(e.li,{children:"连续的动画"}),"\n"]}),"\n",(0,r.jsxs)(e.h3,{id:"圆周运动",children:["圆周运动",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#圆周运动",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"第一个故事，我们先来看看固定轨迹动画的实现思路。这个动画效果是模拟地球围绕太阳做圆周运动："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"实现上图的动画的方式有很多，比较直接的是采用JS来实现，我们先来看一下JS实现的方案。"}),"\n",(0,r.jsx)(e.p,{children:"首先，我们用HTML元素展示动画元素："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <meta http-equiv="X-UA-Compatible" content="ie=edge">\n  <title>Document</title>\n</head>\n<body>\n  <div class="main">\n    <div id="sun">\uD83C\uDF1E</div>\n    <div id="earth">\uD83C\uDF0F</div>\n  </div>\n</body>\n</html>\n'})}),"\n",(0,r.jsxs)(e.p,{children:["如上代码所示，我们用两个",(0,r.jsx)(e.code,{children:"div"}),"元素分别代表太阳和地球两个对象。"]}),"\n",(0,r.jsx)(e.p,{children:"这是对应的CSS，设置了太阳和地球的初始位置和状态："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:".main {\n  width: 512px;\n  height: 512px;\n  position: relative;\n}\n#sun, #earth {\n  position: absolute;\n  transform: translate(-50%, -50%);\n}\n#sun {\n  font-size: 5rem;\n  left: 50%;\n  top: 50%;\n}\n#earth {\n  font-size: 2rem;\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"在没有添加动画的时候，显示出来的界面是这样的："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:o,alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["太阳位于",(0,r.jsx)(e.code,{children:"div.main"}),"元素正中间，因为我们用了一个经典的绝对定位实现水平垂直居中的方法："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#sun, #earth {\n  position: absolute;\n  transform: translate(-50%, -50%);\n}\n#sun {\n  font-size: 5rem;\n  left: 50%;\n  top: 50%;\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["我们将",(0,r.jsx)(e.code,{children:"#sun"}),"元素的",(0,r.jsx)(e.code,{children:"position"}),"设为",(0,r.jsx)(e.code,{children:"absolute"}),"，",(0,r.jsx)(e.code,{children:"top"}),"和",(0,r.jsx)(e.code,{children:"left"}),"设为50%，此时它的左上角是位于",(0,r.jsx)(e.code,{children:"div.main"}),"元素的中心点的。然后我们再通过",(0,r.jsx)(e.code,{children:"transform: translate(-50%, -50%)"}),"将它左移、上移自身宽高的一半，这样它的中心点就位于",(0,r.jsx)(e.code,{children:"div.main"}),"元素的中心了。"]}),"\n",(0,r.jsx)(e.p,{children:"接下来，我们要实现的效果是让地球的轨迹沿着围绕着太阳的环形运动，那么这个怎么实现呢？"}),"\n",(0,r.jsx)(e.p,{children:"这里我们复习一下高中数学知识："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:A,alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["如图所示，在直角坐标系中，点p围绕半径r，圆心在原点的圆周运动，它任意时刻的坐标",(0,r.jsx)(e.code,{children:"px"}),"，",(0,r.jsx)(e.code,{children:"py"}),"满足："]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"⍺是原点到p点的线段与x轴的夹角。"}),"\n",(0,r.jsxs)(e.p,{children:["这是",(0,r.jsx)(e.strong,{children:"圆的参数方程"}),"。"]}),"\n",(0,r.jsx)(e.p,{children:"所以，我们要做的就是按照参数方程更新地球的位置就可以了。"}),"\n",(0,r.jsxs)(e.p,{children:["如果我们的动画让地球围绕太阳旋转一周的周期是T，那么，地球的角速度",(0,r.jsx)(e.code,{children:"⍵ = 2 * Math.PI / T"}),"，所以，⍺角是："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"⍺ = ⍵t = 2 * Math.PI * t / T\n"})}),"\n",(0,r.jsxs)(e.p,{children:["所以，我们就可以通过JS更新地球元素的",(0,r.jsx)(e.code,{children:"left"}),"和",(0,r.jsx)(e.code,{children:"top"}),"属性，让地球运动起来："]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index1-v1.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"const earth = document.getElementById('earth');\nconst x0 = 256;\nconst y0 = 256;\nconst radius = 128;\nconst T = 5000; // 周期\n\nfunction update(t) {\n  const alpha = 2 * Math.PI * t / T;\n  const x = x0 + radius * Math.cos(alpha);\n  const y = y0 + radius * Math.sin(alpha);\n  earth.style.left = `${x}px`;\n  earth.style.top = `${y}px`;\n  requestAnimationFrame(update);\n}\nupdate(0);\n"})}),"\n",(0,r.jsx)(e.p,{children:"上面的代码里，x0、y0是圆心，因为太阳不在坐标原点，所以最终的公式是："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"const x = x0 + radius * Math.cos(alpha);\nconst y = y0 + radius * Math.sin(alpha);\n"})}),"\n",(0,r.jsxs)(e.p,{children:["然后我们通过",(0,r.jsx)(e.code,{children:"requestAnimationFrame"}),"，计算x和y，不断更新",(0,r.jsx)(e.code,{children:"#earth"}),"元素的",(0,r.jsx)(e.code,{children:"top、left"}),"值："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"earth.style.left = `${x}px`;\nearth.style.top = `${y}px`;\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"requestAnimationFrame"}),"是浏览器的API，它的参数是一个回调函数。这个API告诉浏览器有一个动画需要执行执行，并且会在浏览器下次重绘之前调用指定的回调函数更新动画。"]}),"\n",(0,r.jsx)(e.p,{children:"现在我们来总结一下这种动画实现的思路："}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"设计轨迹方程，找出动画变量和时间的关系"}),"\n",(0,r.jsx)(e.li,{children:"确定动画周期和与动画变量对应的CSS属性"}),"\n",(0,r.jsxs)(e.li,{children:["通过",(0,r.jsx)(e.code,{children:"requestAnimationFrame"}),"API，在浏览器重绘周期中更新动画变量，以实现我们需要的动画效果"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"使用JS是实现固定轨迹动画的一种方法，我们还可以使用CSS动画来是实现这种类型的动画。这个故事的实例中，我们使用到了圆的参数方程，而CSS动画不太好实现正余弦计算。所以，为了使用CSS实现动画，我们需要调整我们的动画计算方式，那么要如何调整呢？"}),"\n",(0,r.jsxs)(e.h2,{id:"第二个故事匀速圆周运动-20",children:["第二个故事：匀速圆周运动 2.0",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#第二个故事匀速圆周运动-20",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"使用CSS动画实现圆周运动，我们不能使用圆的参数方程，而需要使用圆的极坐标方程来实现。然后再通过CSS的transform和rotate，就能比较简单的实现圆周运动了。"}),"\n",(0,r.jsxs)(e.p,{children:["首先，我们需要调整一下我们的CSS样式，设置",(0,r.jsx)(e.code,{children:"transform-origin"}),"属性改变元素旋转的参考点："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:".main {\n  width: 512px;\n  height: 512px;\n  position: relative;\n}\n#sun, #earth {\n  position: absolute;\n}\n#sun {\n  transform: translate(-50%, -50%);\n  font-size: 5rem;\n  left: 50%;\n  top: 50%;\n}\n#earth {\n  left: 50%;\n  top: calc(50% - 128px);\n  transform-origin: 50% calc(50% + 128px);\n  font-size: 2rem;\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["如上代码所示，我们调整了地球元素的初始位置和旋转参考点，使用了两个计算属性值: ",(0,r.jsx)(e.code,{children:"top: calc(50% - 128px)"})," 和 ",(0,r.jsx)(e.code,{children:"transform-origin: 50% calc(50% + 128px);"}),"。"]}),"\n",(0,r.jsxs)(e.p,{children:["\uD83D\uDC49\uD83C\uDFFB CSS中，",(0,r.jsx)(e.code,{children:"calc"}),"可以用来在CSS属性值中执行一些计算，特别有用的是，",(0,r.jsx)(e.code,{children:"calc"}),"计算可以自动转换单位，所以我们可以将百分比单位的数值和px单位的值进行加减计算。"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"top: calc(50% - 128px)"}),"表示将",(0,r.jsx)(e.code,{children:"#earth"}),"元素的",(0,r.jsx)(e.code,{children:"top"}),"值设在父容器50%高度，并向上偏移128px的位置。于是地球出现在太阳的正上方，距离太阳中心点的距离是128px。"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:h,alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["默认情况下，",(0,r.jsx)(e.code,{children:"transform"}),"属性是以元素自身盒子的左上角作为参考点的。而在我们的例子中，我们需要让地球元素以太阳的中心点作为旋转的参考点。所以我们需要使用",(0,r.jsx)(e.code,{children:"transform-origin"}),"属性改变地球元素的参点。如下图所示："]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:p,alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["从上图我们可以看出，以太阳中心作为旋转的参考点的位置位于",(0,r.jsx)(e.code,{children:"50% calc(50% + 128px)"}),"。所以，",(0,r.jsx)(e.code,{children:"transform-origin: 50% calc(50% + 128px)"}),"表示将地球的旋转参考点修改到太阳的中心点。这样执行地球的",(0,r.jsx)(e.code,{children:"transform"}),"属性就能让地球围着太阳转了。"]}),"\n",(0,r.jsxs)(e.p,{children:["然后，我们可以使用CSS关键帧动画，改变",(0,r.jsx)(e.code,{children:"tranform"}),"的值："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"@keyframes rotate {\n  to {transform: translate(-50%, -50%) rotate(1turn)}\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["然后我们给",(0,r.jsx)(e.code,{children:"#earth"}),"元素增加动画："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#earth {\n  left: 50%;\n  top: calc(50% - 128px);\n  transform-origin: 50% calc(50% + 128px);\n  font-size: 2rem;\n\n  transform: translate(-50%, -50%) rotate(.0turn);\n  animation: rotate 5s linear infinite;\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"最后，完整的CSS如下："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index1-v2.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:".main {\n  width: 512px;\n  height: 512px;\n  position: relative;\n}\n#sun, #earth {\n  position: absolute;\n}\n#sun {\n  transform: translate(-50%, -50%);\n  font-size: 5rem;\n  left: 50%;\n  top: 50%;\n}\n#earth {\n  left: 50%;\n  top: calc(50% - 128px);\n  transform-origin: 50% calc(50% + 128px);\n  font-size: 2rem;\n\n  transform: translate(-50%, -50%) rotate(.0turn);\n  animation: rotate 5s linear infinite;\n}\n\n@keyframes rotate {\n  to {transform: translate(-50%, -50%) rotate(1turn)}\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"这样我们就实现了纯CSS版本的地球环绕太阳旋转的动画。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRrIFAABXRUJQVlA4IKYFAABwRQCdASrgAakBPp1OoU2lpKMiIPGIYLATiWlu4XdhHvwqGJQ0cWFNt9fM5jzdPIGABM9bsHk/7WT73QY01dZl4vTTV1mTjOboClGNNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeHODC+fyi9NNXWZeL001dZl1TovMg1yQT+oPVsd9eHe8NaVXWZeL001dZl4vTPDB2GxT8SzRMVqausy8Xppq6zLxesrV1mXi9NNXWZeL001dZl4vTTV1mXi9NL4YKLUuj/AsNDR8d5MgxjHG6pq6zLxemmrrL2gRHwYiDxKKgXngvZPG8idCfjT00KaNaegZqbDtY8y8Xppq6zLxeml+M69RYkYBkMUqdClGIttIiYsRPYmYH1w08prqemNNXWZeL001dZmkl/RXhUAgwEYhIckEys/3Uu9klQLDBTy8Xppq6zLxemmtQNE8dXE9QZOA7Gqausy8Xppq6zLxenIKnmXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTVq9QRH6REdgzcVyDMI7Bm4rkGYR2DNxXIMwjsGbiuQZhHYM3FNkydAAA/v6pLvKqY8JExU8XfBaHg4RooAAABzaylmIgcTUbhlJekFyIuHNnMDBa2iYkhVv9E75Bv/0rMM78cBw5jY5JICe9e2m8QP01JR2tDH6YlfK5gifeaDd6M0RlvyWeeN+UL7Xa+auBiln83bqnNHHcJsrLAEvCc8iaE6MQ+MuB3+2KbccuWymo61YuYYBht5P7t2cReBurWigfjrzZSsfFSU26lkWCIlf3zy1PzlqrLy1JTazA65QwC1wlweXqSesuLKUZvnZgK5PKEMCHs5cxKPTnF/gqkO1N+iAAAklxF/ikqOUzVyMf/JuaL7+y9IjN7QNrOWWf4Ao0DjpiWZrUpX1zJ0g9SA7DF/PLWLlHMNc4gjGHCMdlyJRJLA+Li1ZV5wBnpcCbto9RHxA0Hlg9v7yb+pRjZ+pRCO3sXVYvs3TnnCx8J31HzcJkeaZTVjjtSFCWPnYqjQsacJ/AXn5TP3hJ9cygGSn+7U6al9INy/SOXJistpProMuHu2sCTfgokUteNx1lbUumUWFaHV/ypZ2WV6vEsz8f2cCfmhCXDO0WwMCaRkn2CsCqD9Gs2SIdNmccfX8ba5Jq0Pc/hpHRtYWJNv3NCvl0NpEMNxR7SkTS/94w3sBLvKdITDZhuVIT9kVdBY/6RCXk1Ao0Krlpa6YpAofs19mPoQFCWntReX4oXwExK1OQ6yQPN1+J5oGdLS//qNgy70NjFP04Ym7EJ7gybuLFif2Kkr/46YL7yONDWC0ej8Z2XmHYmAm+d6wNslcvqYk8GQwHnDa3M+mdKbIxKuHElQJIeGpT0ni8ByXqkl6sXyHhivseVTp1udYDI+bR25B2CHuyi3dQTSNyD3K6yxp6NDvn/0lEsrLvPoI+9pKggB4kJa8taO22u17TGxxhaybcEZQ25N2pTgrSYGQJ/mq0sFHmF4B6gqy8qnYnmICZ/D3ILJ1ix8Here5SxUriDTgw7Isv4f8rvUQQBf3m0WF4S4o+gpQieIXo97nN1NwzvFoiQessE8yOgXA6+DsU6xYyJ4l0Ht1170ONxBMyCw7EUX4q9z2VOea4Z1XEtAcQ+vuup7Jr1fZ+3WhC8zk5BKkNdg/j6OSIJNOMR1dn6Y3PeuDaoz1Qemzh4zwB5MLilOnTMAAAAAAAAAAAM+nVM8VL82AdnY9P2KYAAAA=",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"比较上图和第一个故事中的效果图，你可能会发现它们之间存在细微的差别。第一版是通过参数方程计算地球相对坐标位置，动态修改坐标位置来实现，所以地球本身，除了位置相对太阳旋转，其他的状态都保持不变。而这个版本是通过旋转来实现的，地球的旋转参考点始终是对着太阳的中心点的，所以看起来好像地球自身也在旋转。这就是效果上的细微差异。"}),"\n",(0,r.jsx)(e.p,{children:"当然，这一版我们同样也可以不用CSS关键帧动画，改用JS来控制，我们只要将CSS动画去掉，添加以下JS代码："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"  const earth = document.getElementById('earth');\n  const T = 5000; // 5秒\n\n  function update(t) {\n    earth.style.transform = `translate(-50%, -50%) rotate(${t / T}turn)`;\n    requestAnimationFrame(update);\n  }\n  update(0);\n"})}),"\n",(0,r.jsx)(e.p,{children:"如果你这么做，你会发现在一些浏览器（包括最新的chrome浏览器）上出现奇怪的现象："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRkYHAABXRUJQVlA4IDoHAADQWgCdASpAAv4BPp1OpE2lpKOiINrYELATiWlu4XdhH9ma1WZXig38+pjP7ffzE483vQjAOXhoYnfgFPnTp06dOnTp06dOnTp06bE9uUA95prOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTfh2OShUVjhGWMRexyZdfN7MrKAe801nTp06dOnTp0dd8p8g4Y5LfcK+ImwTtJgnfhcE9Pcae801nTp06dOnTpvx72xGph7TWdOnTp06dOnTp06ds6iq+nuNPeaazp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOjqARujrtrkSbfQud1GwPJuDtIWmcXmms6dOnTp06dOnTo4q7eDNRF06i7S5zMaMNuxFk8sszudGm/XRH8vBMqvp7jT3mms6dOnTp0cdpEoIfKwNj0c42Kvacfvlb5MrkHSTE4wFBVNQ2jt/mo+TZVfT3GnvNNZ06dOnRx4CRqQdjN42hmuPdOYogYJJUT+Pl4ZHouRIPlnkGj+9YHL4thOLzTWdOnTp06dOnTo61U5jE5VCo1OlV7d7CgYtQRTg/Q3O5oe01nTp06dOnTp06dO5h/wPT3GnvNNZ06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTpv0IBQMoe01nTp06dOnTp06dOjqAAAA/v/bVZ+RQLrBUf/v3/0HqxOj/jftvJAAAAAAAK8hpK6BYmlHL/aSrs96sCz2gOpkRMPRy9CMAIH9Kl5MwGZz7v+vHiHpOkIEeMVh9VfBaCDmecmmNZinCXOzODh48HrYH2R/8oOhFxXXxIPpjW5uCY5s+bOHHy60t4W3gcGt0pyaDn6ibFqAA4TwHX6zDK0ngc7wje9FbEdmHqpDaitohsBRvKVLz2quOl1AdOjeHgyVddQ5SaIF8E81qwUwHx/TG0/YX/BrFd/QtVZIgkBUF7uP3DcmpzL/P/mGgr+CHV8cgl7VGqQSMecNVNA2cmsxOS1Xd5d0h1nFx1nBOetiuPB/PKjLNGeJCAD6DBU94AAAAAFI/Azx7CecmehNvOQD8LI2T3zAACyYYA5Ci65LNu3od3WTkG+AP+vXLqawa5jTcmPMUjyc6X4+Q726WLF1gZc3l+MXS8c2dp244Ls569AqPpVndKn537yHiK+hxbsB+zCmDTWrlWKSWQddNAPXPwvH4UHJ1SQMWN0rrx9jSeAzFXyqO18t/Rw93SQRPAhbqNQvULgjN85pnVbsQ4B0dnXNXgDVKKvox/KJS2nSvfYtPyvEfXqaotTBl2dWkPbKgNuqvRqXmUK0WD7vKQqM+AkmzQauHBBS4ZXizMPUXsqWAJ4dKZAqT1E2tLziT1/cOPZlFT+JZYjOLyxdx0lPtqHmx8pw54+NTUORYLfNWcaAdy8ziRCrY2TaE7DIK29zFTRIoHtMvHqm6K0jbED7uic6zt1nQvRFuwsJo+fQLW1GFasJa+EZhUrNtQ4pywlMeKXa4qCjBZ6zuOiq/Olsd4xrgJAVs481EEg4eZrbkeaOY7dcoabpZATpA0JMo8/fep9sLufFPhrhDWAN7tQSpFV/jVIntq22uXazyFirwf15MsOkG7hXDwJmBzLG9g0gFo4B61lvqojr6zA9NlGadiWGvhYhD58EWiA48ascnPPd/9j3OHDTU74vgRrKsLabvBhZ/KY0O4QE4qxaGUkv8KvHY27Fs2WP8ExMvVehyVZByNsQrqqOfK2CCshTCGG6Ubc1us3u+isj8tz/2w6y+JVfw43Wij82d092AXYRP/07fbkS6ZD6UDfzegnxYFuLu5N/KQ+6BLlr7L6sqY5+nd45GZvAxVo9uHSlWVGPmRR+vAy5lxb1ZOjGKSdPP8Ip5E/c2AVhA/5Vh6tzU0+nGohWJV6OHWFAeqNiwJGXZFSMYE9zAFWMINMubCqovpAauimd7fIoovrqqONWam1Pw9wz3NfLx56hAes/U98IeuWibLrZ78h1dhcwyoMyoC74SWIWIM0Ribqb4fVv9JfHUk/5rCPEJcfAwPiver60JP1e/qfMFa7ncLi1OrG688aKimZiToYkwD3mC/eHpkO0g/viQxhAN6aP97g7QLiwKD/bqkYmwP8pTZzdljBYAAAAAAAAAAAAAAAAAABDYUU8AEDva4XpfomAAA==",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["如图所示，似乎地球在运动到某些位置的时候会突然抖动一下。不过这个不是我们代码的问题，而是chrome浏览器在处理emoji文字的",(0,r.jsx)(e.code,{children:"transform"}),"属性时产生的bug。要解决这个问题，我们可以将",(0,r.jsx)(e.code,{children:"rotate"}),"换成",(0,r.jsx)(e.code,{children:"rotate3d"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"  const earth = document.getElementById('earth');\n  const T = 5000; // 5秒\n\n  function update(t) {\n    earth.style.transform = `translate(-50%, -50%) rotate3d(0, 0, 1, ${t / T}turn)`;\n    requestAnimationFrame(update);\n  }\n  update(0);\n"})}),"\n",(0,r.jsxs)(e.p,{children:["这里我们用",(0,r.jsx)(e.code,{children:"rotate3d"}),"来代替",(0,r.jsx)(e.code,{children:"rotate"}),"。",(0,r.jsx)(e.code,{children:"rotate3d"}),"接受4个参数，前三个参数定义一个三维向量，第四个参数表示围绕该向量旋转，我们是在平面上旋转，要围绕z轴，所以前三个参数是",(0,r.jsx)(e.code,{children:"0,0,1"}),"。"]}),"\n",(0,r.jsxs)(e.p,{children:["用",(0,r.jsx)(e.code,{children:"rotate3d"}),"替代",(0,r.jsx)(e.code,{children:"rotate"}),"之后，问题就消失了，这样我们依然可以用JS来控制动画。"]}),"\n",(0,r.jsx)(e.p,{children:"第一个和第二个故事阐述了固定轨迹动画的实现思路。规定轨迹动画不仅仅是圆周运动，它还包括了渐变动画，椭圆，贝塞尔曲线等等。这些动画既可以使用JS来实现，也可以采用CSS来实现。当然，如果采用CSS动画实现，你设计的动画变量需要被CSS支持，否则是无法实现用CSS来实现的。"}),"\n",(0,r.jsx)(e.p,{children:"用JS或CSS来控制动画，各有各的好处，CSS动画更简单，能够保持WEB开发各司其职的原则，使得代码更加易于维护。而JS动画，在组合复杂的动画过程时，会更加灵活和方便。"}),"\n",(0,r.jsx)(e.p,{children:"接下来，我们就来看看更加复杂的动画应该如何实现——连续动画。"}),"\n",(0,r.jsxs)(e.h2,{id:"第三个故事自由落体和弹跳小球",children:["第三个故事：自由落体和弹跳小球",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#第三个故事自由落体和弹跳小球",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"在一般情况下，简单的动画使用CSS实现会比较方便，但是一些比较复杂的动画，还是需要使用JS来实现。"}),"\n",(0,r.jsx)(e.p,{children:"比如我们实现一个模拟小球自由落体后弹跳的动画效果："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRmAEAABXRUJQVlA4IFQEAACwRwCdASoOAsoBPp1Opk2lpKOiIHxIYLATiWlu4XdhHvL/nNM18pWNX9AFagPqSMyanaqnu6CrhQY+B7lOXLly5cuXKzHWa1VAsdyAFuuptMfFvfQkxJekYRL6EQWBHOcRMAbW/0EFu+4zsKZZ/T80shMAVY1spy5cuXCanx9RS1Z/6GPbXS+dt3uUPn1QWpCYAqxrZTly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5crBZ0kGaB6FEwOLose5Tly5cuXLly5cuXKwJe+2ZuVFlgmvSWynLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cuXLly5cKMm9mg05VheBGyrC8CNlWF4EbKsLwI2VYXgRsqwvAjZVheBGyrC8CUAht9vt9vt9vt9vt9vt9vt9vtGTrTwAKsa2U5cuXLly5cuXCMhwAA/uSw31r4BgSJ5QsvN5QBVR6a7SW01jh8x7KvFZBnlyazZwDweWaMMjwPUUA1sPoOPuUNm45o3S43K0iqs9iA9MWOAup1jGYDmgD93hO69dF7pL//7KPmZKudeTpTPRTxXOfmR62nicxjy5Oq/VYhuRFNAsu5VORMb7fCP3ie4v198QFqZ4mWO+rKplQ7dMQneh9YC2YUcGLppIq/T2BJjwmt9FRxaoDF7eRXhvTB8+tK2lnw/1SFXXtqp71rBgE/mLmRPR2EcxBOhBrSchh2w5mGKeqjAY99VGxuM7vyQKO7iYa7uM0xfe/u3e1+ye/2IRmK8HCj1gY5YOjWXBpxeTZuCcZnwUv0kDadoy+iz85KZzByWT0zPtevn60jvclkTwwAdlNL9uNPPWxzNhnpuErg7RnauL9c0phC34+62+iW/KI0VvLBpWSVhnuSqbwDo0sd0HeAIsfQ9DUwxMX+JpBCqAlmS7PD7BIcEfc4iBtSBaKgAAAAAAAAAAAAAzRXCr4ym4TJbeCFRln2wsJev6hmB/6iDmQ/+lnBGU6fN6pW3OYl3JzyVHpW2jVzQL+Gc0JmpRiQn6sLzxLLImDOlye7L3nuWDLA9eFYHk0MKfjvfctSe4/3wsrIAAAAAAAAAAEJpf70L/f8L3Rh1fNI7bG5zUJNBkMANo3YoGwWEQXW90gJ3jEnbBcGgAAA",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"这是相关的HTML与CSS："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<div id="sphere"></div>\n<div id="ground"><div>\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#sphere {\n  position: absolute;\n  left: 100px;\n  top: 100px;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background-color: #0af;\n}\n\n#ground {\n  position: absolute;\n  top: 420px;\n  width: 600px;\n  height: 10px;\n  background: black;\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"这是一个连续的动画，连续的动画实际是由几个不同的阶段的轨迹动画组合而成。比如上面的例子，就是由若干个自由落体动画和匀减速动画组合而成。像这样的动画，使用CSS动画几乎没法实现，还是应该考虑使用JS动画。"}),"\n",(0,r.jsx)(e.p,{children:"第一步，我们先实现一个自由落地动画。"}),"\n",(0,r.jsx)(e.p,{children:"我们知道自由落体运动是一个初速度为0的匀加速运动，假设小球离地面高度为S，落地的时间为T，那么根据自由落体运动的公式，我们可以计算出小球的加速度为："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRhwEAABXRUJQVlA4IBAEAAAwFgCdASpwAFAAPp1KnUqlpKKhpZVcqLATiWkAE+q/aeWaPcfy/CDtWbs/Ld4QP87xj/VLyoON98i9gD81/9L0x/83/Dflh7qvo3/v+4d+qf/EM+w04YMrn0BEqbVEP/pI1gqTwhcDjzOvTGtFPQ5b4EFC7vcT2GZ0zPIDGS4ZPamdZE1Uhiuca6N7nUZP6SY9LeCxNQsbDrgSU5zI2UZgT17Xw5a9RlMyPOhm37Vbk0HicksyT9FHYwAA/vq2q9Gjgm2khkknHyhAzkCHyo1OfM4E1QWYOgHFfXrfo84o+BRRmdjg13NfHus4lahs2BAlXfiUTrdnOaiE24/fm+aSjld4Da2rrGblos++TenqHCNKO5Jhdt0c0JthhTcUgg5IfEwvy9ZhI9Z36xsjkjh2PNrZP1ao/VYv+NQBk43vQPM3R/67Tg+Dq7sD2IPBT7x92t4NFzXt17XYOmlIyD6qOYmIZk5CbpyAbtew9Yu+MJ6bFJfgjd3k7YICaOviP6j/4idol3d9//JHMd01+ql7nbT8xRM14tlud97OrbqbZVOgijTSbRflIVOJdoJg0fjO/gCZ1K+WG1YuHB447SGdn7NsJCqmgMD+g28ZH1wM/7ZnrAyXgPqrPbhLqs9KAv7vTRnopYxNL7ZORKbx7ttTKdWpdxjKzr8qpN6JC2vNKeWokvYdl8F4GkKkLtdFD26IhBh2WS6oNDSW/5BUP9kJKE9Ob4AiRVhSamm9yN72fadQnBvxpgOQxJ33zPvd33NR7DnleXLe1w+jxG2ZgM3qfjRwJqLJNhaHh+nvaiXnEdmu2xMD9sim99KVAM5VsWVIYBzu/CxpasKmQVbp0ms4KdZ3djF88NW591z90fKbK7PfC1HH2pbwJBtOzRaBg0CvsHiKTI2CxLuwjFIN3b2mkWrpTTvE3gaWjvVcmp8YcLpLs+h5a4NIpjYSUDoSac8/WYbHQKl7XxZrADDoCdDyZ3yU0t4ag3//Et1dd+EYtjvmTVE0b1MnMHvkbk4gdBu7wfP4fdQOMhxYsc8PMnS7R4kft6cRSyTBjYH1TaP6VdEETqE7nCAIneyXSZ1leRWzU5eRx/qcm3mvk/wlL77rcy7F6ThpcbCTCMpadGqkC19xU9guEZXBy7IAfni69Z089J4S4vJ0fanNLWSkiPDUnZCYUpc6587dtduAzQ8ajJci3DhqluPehkW1YONF4h8mD3yhOceV7NnJ+F4dOQgc7cqiotQVtpKI6VUgJw+P7prBvtt/8z2wvQMi4vU5TjZmmM+dGgxNkElUeQ+RCMqVX1O/8//wGReQrcLSRJIOyLwZiozKKc/fR3YbqSKAFHD+ijyut2jI01tCW0WY73mxnxdIA+QG6YP7mX4WvrgAAA==",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"那么经过t时间（t <= T），小球运动的位移为："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"所以，我们可以这样定义自由落体动画："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"const S = 400; // 小球离地的初始高度\nconst T = 1000; // 落地时间\n\nconst target = document.getElementById('sphere')\n\nlet startTime = Date.now();\n\nfunction update() {\n  const t = Date.now() - startTime;\n  const p = Math.min(t / T, 1);\n  const top = S * p ** 2;\n  target.style.top = `${top}px`; // 更新动画变量——top属性\n  if(p < 1) {\n    requestAnimationFrame(update);\n  }\n}\n\nupdate();\n"})}),"\n",(0,r.jsx)(e.p,{children:"一个自由落体的动画就实现了："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRsICAABXRUJQVlA4ILYCAADwPACdASoIAqYBPp1Opk2lpCQiIDgImLATiWlu4XdhGr9aKUgAAmOzuT1S+DcJcfzZgdqA07f5PfyrnT2prBmlGNe2E5qGPQ/b+KzMxeyCeZmL2RxmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTzMxeyCeZmL2QTwsahUjgHHjDCT2TuegOPGGEnsnc9AceMMJPZO56A48YYSeydzottQyYe4DjxhhJ7J3PQHHjDCT2TuegOPGGEnsnc9AceMMJPXlTWGsAP75s+2rGPElJXkSLKnqRKp5F2SPOeaydyx7f/9dccfilzY39ns0f/3giU/SStPOd1sXDcVPeqJyux1xx6XLHLLfI73SjREcS5Hz5Xpg4fVjNnwMfY7eSk1Oz4J5Y7eLmzWFU4VThVOFU4VThVOFU4UsobzH6+uUKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGb8j/s5ZxSiP+OD5ATizrsFUFlbq+Rs5UwfdFr5rwqQc48VYA8YB42Okj+oQPmsrbgAAA",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"以上是动画的第一阶段，现在我们需要执行动画的第二个阶段——弹起。"}),"\n",(0,r.jsxs)(e.p,{children:["因为弹起动画是在自由落体动画结束之后，所以弹起动画必须等待自由落体动画执行结束后才能开始执行。这就涉及到一个异步的过程。我们需要对动画过程进行一下简单的封装，让它实现一个",(0,r.jsx)(e.code,{children:"asyn/await"}),"的过程。"]}),"\n",(0,r.jsx)(e.p,{children:"首先，利用我们之前学过的数据抽象和过程抽象，重构一下上面的代码："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"/*\n  @target 目标动画元素\n  @duration 动画经历的时间\n  @progress 动画执行回调函数\n*/\nfunction animate(target, duration, progress) {\n  const startTime = Date.now();\n  return new Promise((resolve) => {\n    function update() {\n      const t = Date.now() - startTime;\n      const p = Math.min(t / duration, 1);\n      progress(target, p);\n      if(p < 1) {\n        requestAnimationFrame(update);\n      } else {\n        resolve(p);\n      }\n    }\n    update();\n  });\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"这样，自由落体的动画就可以变成："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"const sphere = document.getElementById('sphere');\n\nanimate(sphere, 1000, (target, p) => {\n  const top = 400 * p ** 2;\n  target.style.top = `${top}px`;\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["注意，我们在",(0,r.jsx)(e.code,{children:"animate"}),"方法里返回了一个",(0,r.jsx)(e.code,{children:"Promise"}),"对象，这样的话，我们就可以通过异步的",(0,r.jsx)(e.code,{children:"async/await"}),"来连续执行动画。现在，我们就来实现弹起的动画。"]}),"\n",(0,r.jsx)(e.p,{children:"与自由落体运动相反，弹起的动画是一个“匀减速”运动，最终将初速度降为0。"}),"\n",(0,r.jsx)(e.p,{children:"在这一阶段，小球的初速度与加速度分别是:"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"那么经过t时间（t <= T），小球运动的位移为："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:l,alt:""})}),"\n",(0,r.jsx)(e.p,{children:"所以，弹跳阶段的JS，我们可以这样写："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate(sphere, 1000, (target, p) => {\n  // 起点是400，反向运动，所以要用400减\n  const top = 400 - 400 * p * (2 - p);\n  target.style.top = `${top}px`;\n});\n"})}),"\n",(0,r.jsx)(e.p,{children:"然后，我们把两个动画连起来："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"(async function () {\n  while(1) {\n    await animate(sphere, 1000, (target, p) => {\n      const top = 400 * p ** 2;\n      target.style.top = `${top}px`;\n    });\n    await animate(sphere, 1000, (target, p) => {\n      // 起点是400，反向运动，所以要用400减\n      const top = 400 - 400 * p * (2 - p);\n      target.style.top = `${top}px`;\n    });\n  }\n}());\n"})}),"\n",(0,r.jsx)(e.p,{children:"最终实现的效果如下图："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRh4CAABXRUJQVlA4IBICAAAQKwCdASpsAaoBPp1Op02lpKQiIF1YULATiWlu4XdhGryGAAAbSDOp15GOEnPMxjz/F0CtwpBF69evXrtbAjAsUwm/NC2GXb+h7ok2bNmzZt+LFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsWLFixYsGylCZDLwOBwOBwOBwOBwOBwOBwOBwOBwOBwOBwN+AAD++QDTZpkOHzQoN5GINFhoaZ1QAXziX5v09ue/ywuJhfG4xGGrpxPF52dEHrR6LO4lvptjlae1xesEs3voP+aHt67ptHEu6bRxLum0cS7ptHEu6bRxLum0cS7ptGLftlXTasW11EPEpti6XDeQNx5QQDNv4gXb+A2eWJJXVb3tlaJXb0iNR6SwhC9wz4KdAeTs+AAAAAAAAAAAAAAAAAAAAAAADqD/4fb/8YGkUkAAAA==",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"这个效果不是我们最终想要的，因为小球不停地弹跳而不会停止，所以我们需要给小球增加一个能量损耗。"}),"\n",(0,r.jsx)(e.p,{children:"假设小球每次与地面碰撞后，它的动能损耗30%，那么根据能量守恒，它弹起的高度将变为之前的0.7，而它弹起的时间将变为之前的根号0.7："}),"\n",(0,r.jsx)(e.p,{children:"所以最后我们将动画修改为："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"(async function () {\n  let height = 400;\n  let duration = 1000;\n\n  while(1) {\n    await animate(sphere, duration, (target, p) => {\n      const top = (400 - height) + height * p ** 2;\n      target.style.top = `${top}px`;\n    });\n\n    // 能量损耗后的动画执行高度和时间\n    height *= 0.7;\n    duration *= Math.sqrt(0.7);\n\n    await animate(sphere, duration, (target, p) => {\n      // 起点是400，反向运动，所以要用400减\n      const top = 400 - height * p * (2 - p);\n      target.style.top = `${top}px`;\n    });\n  }\n}());\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRiYEAABXRUJQVlA4IBoEAAAwVgCdASrgATECPp1OpU2lpCOiITHIeLATiWlu4XdhHvF5wbdftEfi/6d//22DvhH/YiBf+ePvwvdTf4B+/+z08fyDSs/OBHubaj3NtR7m2o9zOiuSY9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj1YYrvTdEfWuiPrXRH1roixBOCfjCH6KGm8M+7P8+SD+fJB/Pkg/niZ9GIZFrH3OCm9mpI2o9zbUe5tqPc21Hu5SGOI9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3NtR7m2o9zbUe5tqPc21Hubaj3M6G7ShXfMu+Zd8y75l3zLvmXfMu+Zd8y75l3zLvmXfMu+Zd8vJF3W2YUh/ZD+yH9kP7If2Q/sh/ZD+yH9kP7If2Q/sh/ZAL4Z+Ww5H9v41Zz2bQVfM9YIc0YtMb+NWc9m0FXzPWCHNGLTG/jVnPZtBV8z1ghzRi0xv41Zz2bQVfM9YIc0YtMb+NWc9m0FXzPWCHNGLTG/jVnPZtBV8z9qeFYAD+/s0qGe21/Q6iS/59osTPMkAAAAAAAAAAAAAAAAAAHOnRbhYy0PNaHN4I1OSsoedpF4HV/smxAVlWvkV/iXboe9/hisDLLgI6BRcw75DDLqjJL2w0I+nnDv+wNSUOnpL2wt7I9pDHJxuvAIRPVzQHRWvQlFjCM79sBODNriLy1SI4DukLs0xpKFzHw2SN1sS2zvscOZ8AAAAAAAAAAp/3BP/eT1tyQKpjUM7/c6v4kyqCV/dZ0fW6EvmtRcmevrY1e+BVG5y6hqxw85E7qAw/8FwJSX/8Om9dSnC1Bb80nuteX5M5dIoxbwnPYAxDKnsAcoqNOgADsHqQgB11VAR38HEnUBVaQByiqr6AAOxaJCAHYtH7TfKWkAYhlbSAOUVVfQAB2LRIQA7Fo/ab5S0gDEMraQByiqr6AAOxaJCAHYtH7TfKWkAYhlbSAOUVVfQAB2LRIQA7Fo/bCy+gQAA=",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["所以最终就实现了我们所期望的效果。",(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index2-v1.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})]}),"\n",(0,r.jsx)(e.p,{children:"现在我们来总结一下连续动画的思路："}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"将连续的动画分解为若干个固定轨迹的动画"}),"\n",(0,r.jsx)(e.li,{children:"为每个阶段的动画设计轨迹方程，找出动画变量和时间的关系"}),"\n",(0,r.jsx)(e.li,{children:"确定每个阶段的动画周期（duration）和与动画变量对应的CSS属性"}),"\n",(0,r.jsx)(e.li,{children:"利用异步的方式（Promise）连接每个阶段的动画，形成一个连续的动画效果"}),"\n"]}),"\n",(0,r.jsxs)(e.h2,{id:"第四个故事常用动画实现技巧",children:["第四个故事：常用动画实现技巧",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#第四个故事常用动画实现技巧",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"通过前面的三个故事，我们学习了两种非常常见的动画模式：固定轨迹动画和连续动画。"}),"\n",(0,r.jsx)(e.p,{children:"连续动画实际上是由多段固定轨迹动画组合而成的。在第三个故事里，我们使用Promise来处理连续动画，这是一种最方便的异步处理方式，在第八日的故事中，我们会有更详细的讨论。"}),"\n",(0,r.jsxs)(e.p,{children:["而固定轨迹动画可以抽象为一个由",(0,r.jsx)(e.strong,{children:"动画周期(T)"}),"、",(0,r.jsx)(e.strong,{children:"动画执行时间(t)"}),"，以及",(0,r.jsx)(e.strong,{children:"时间与属性值的映射函数(progress)"})," 共同决定的模型。"]}),"\n",(0,r.jsxs)(e.h3,{id:"插值",children:["插值",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#插值",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"在固定轨迹动画模型里，知道T、t以及progress，我们就能唯一确定动画元素target在t时刻的属性值。其中比较复杂的是progress，我们可以对它进行规范："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"progress可以由起始值（start）、结束值（end）、以及插值函数（interpolate）确定。"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["我们用这个规范，重构一下上一个故事中的",(0,r.jsx)(e.code,{children:"animate"}),"函数："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"/*\n  @target 目标元素\n  @prop CSS属性\n  @duration 动画周期\n  @start 动画开始时，CSS属性的值\n  @end 动画结束时，CSS属性值\n  @interpolate 插值函数\n*/\nfunction animate({target, prop, duration, start, end, interpolate} = {}) {\n  const startTime = Date.now();\n\n  return new Promise((resolve) => {\n    function update() {\n      const t = Date.now() - startTime;\n      const p = Math.min(t / duration, 1);\n      target.style[prop] = interpolate(start, end, p);\n      if(p < 1) {\n        requestAnimationFrame(update);\n      } else {\n        resolve(p);\n      }\n    }\n    update();\n  });\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["如上代码所示，",(0,r.jsx)(e.code,{children:"interpolate(start, end, p)"}),"这个函数的返回值就是根据",(0,r.jsx)(e.code,{children:"p"}),"对应的比例落在",(0,r.jsx)(e.code,{children:"start"}),"到",(0,r.jsx)(e.code,{children:"end"}),"之间的值，也叫做",(0,r.jsx)(e.strong,{children:"插值"}),"。而",(0,r.jsx)(e.code,{children:"p"}),"的值是在[t/duration, 1]之间 （也就是[0,1]之间)，所以这里的插值简单来说，表示根据动画的起始值（start）和动画的结束值（end)，在当前时间下计算出的位于start和end之间的值。"]}),"\n",(0,r.jsx)(e.p,{children:"下面，我们来看看这个插值是如何被计算出来的："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'top',\n  duration: 1000,\n  start: 100,\n  end: 400,\n  interpolate(start, end, p) {\n    p **= 2; //匀加速\n    return `${start * (1 - p) + end * p}px`;\n  }\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["上面的代码实现了第三个故事中自由落体的动画。其中，",(0,r.jsx)(e.code,{children:"start * (1 - p) + end * p"}),"是一个最简单的插值公式，它的返回值是一个",(0,r.jsx)(e.strong,{children:"线性插值"}),"。如果我们不加",(0,r.jsx)(e.code,{children:"p **= 2"}),"，那么返回的插值是线性的，这样的话小球就是匀速运动。"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:c,alt:""})}),"\n",(0,r.jsx)(e.p,{children:"如果需要小球做匀加速运动，根据前面的公式："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["这里",(0,r.jsx)(e.code,{children:"t/T"}),"就是",(0,r.jsx)(e.code,{children:"p"}),"，当",(0,r.jsx)(e.code,{children:"p"}),"等于",(0,r.jsx)(e.code,{children:"p ** 2"}),"即",(0,r.jsx)(e.code,{children:"p"}),"的平方，动画就变成匀加速了。"]}),"\n",(0,r.jsx)(e.p,{children:"同样的，如果我们要做弹起的动画，可以："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'top',\n  duration: 1000,\n  start: 400,\n  end: 100,\n  interpolate(start, end, p) {\n    p *= (2 - p); //匀减速\n    return `${start * (1 - p) + end * p}px`;\n  }\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["插值不仅可以改变像",(0,r.jsx)(e.code,{children:"top"}),"、",(0,r.jsx)(e.code,{children:"left"}),"或者",(0,r.jsx)(e.code,{children:"width"}),"、",(0,r.jsx)(e.code,{children:"height"}),"这样的属性值，还可以处理更复杂的属性值，比如颜色："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"function lerp(start, end, p) {\n  return start * (1 - p) + end * p;\n}\n\nanimate({\n  target: sphere,\n  prop: 'background',\n  duration: 1000,\n  start: [0, 170, 255],\n  end: [255, 170, 0],\n  interpolate(start, end, p) {\n    const color = start.map((s, i) => {\n      return lerp(s, end[i], p);\n    });\n    return `rgb(${color})`\n  }\n});\n"})}),"\n",(0,r.jsx)(e.p,{children:"上面的代码给小球增加一个改变颜色的动画，这样我们会看到小球在弹起的同时，颜色也会发生改变。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRhACAABXRUJQVlA4IAQCAABwLQCdASpsAaoBPp1Opk2lpCOiIFgIoLATiWlu4XdhHcwOIvAOknJDpDB9Y82pp8kGMeLTJNpjHD5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBvqx5tTT5IN9WPNqafJBiJJ2k9GuOHyQb6sebUwx5zhg6BNTFeC4fX/mgVY82pp8kG+q8CS3RriBNPkg31Y82pp8kG+rHm1NPkg31Y82pp8kG+rHm1NPkg31Y82pp8kG+rHm1NPkg31Y82pp8kG+rHm1NPkg31Y82pp8j9vhZ8fbvqEhISEhISEhISEhISEhISEhISEfp5PDVL8rd9QkJCQkJCQkJCQkJCQkJCQkI/VWAoAA/uHpCZhIMIHjVsa15Y/QAAAAAAAAAAAFx0T+cEHOacrTeXrVeFzJpIFuki8uPku9Bwu4MRoUa+BgGN6fzYmBKvx2fIRSAX3gigy4mCvwPScEf8yzV9ZMj7BQKGAAAAOwVARTjQIM8KVBSMlpyXmjjxdRsdrOiSWdT5ojfLmaMtkwRyxDsh42G09ouzgAAAA=",alt:""})}),"\n",(0,r.jsxs)(e.h3,{id:"缓动",children:["缓动",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#缓动",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["我们看到，匀速运动使用线性插值",(0,r.jsx)(e.code,{children:"lerp"}),"函数，匀加速运动在线性插值前将",(0,r.jsx)(e.code,{children:"p"}),"改变为",(0,r.jsx)(e.code,{children:"p"}),"平方，而匀减速运动在线性插值前将",(0,r.jsx)(e.code,{children:"p"}),"改变为",(0,r.jsx)(e.code,{children:"p*(2-p)"}),"，实际上其他的运动形式也可以用这个模型处理，所以我们可以将改变",(0,r.jsx)(e.code,{children:"p"}),"的过程抽象出来，叫做",(0,r.jsx)(e.strong,{children:"缓动函数(easing)"}),"。"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"function animate({target, prop, duration, start, end, easing, interpolate} = {}) {\n  const startTime = Date.now();\n\n  return new Promise((resolve) => {\n    function update() {\n      const t = Date.now() - startTime;\n      const p = Math.min(t / duration, 1);\n\n      target.style[prop] = interpolate(start, end, easing ? easing(p) : p);\n      if(p < 1) {\n        requestAnimationFrame(update);\n      } else {\n        resolve(p);\n      }\n    }\n    update();\n  });\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"这样，匀减速的小球弹起就改写为："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'top',\n  duration: 1000,\n  start: 400,\n  end: 100,\n  easing(p) {\n    return p * (2 - p);\n  },\n  interpolate(start, end, p) {\n    return `${start * (1 - p) + end * p}px`;\n  }\n});\n"})}),"\n",(0,r.jsx)(e.p,{children:"除了匀加速、匀减速外，我们还可以实现其他的缓动函数，比如周期运动："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'background',\n  duration: 100000,\n  start: [0, 170, 255],\n  end: [255, 170, 0],\n  easing(p) {\n    return 100 * p % 1;\n  },\n  interpolate(start, end, p) {\n    const color = start.map((s, i) => {\n      return lerp(s, end[i], p);\n    });\n    return `rgb(${color})`\n  }\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["如上代码所示，这是个执行100秒的动画，但是分为100个周期，每个周期背景色都是从",(0,r.jsx)(e.code,{children:"rgb(0, 170, 255)"}),"线性渐变到",(0,r.jsx)(e.code,{children:"rgb(255, 170, 0)"}),"。"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'top',\n  duration: 100000,\n  start: 250,\n  end: 100,\n  easing(p) {\n    return Math.sin(100 * Math.PI * p);\n  },\n  interpolate(start, end, p) {\n    return `${start * (1 - p) + end * p}px`;\n  }\n});\n"})}),"\n",(0,r.jsx)(e.p,{children:"上面的代码是执行100秒的动画，分为50个周期，让小球以250点为起点，做幅度半径为150的简谐振动。"}),"\n",(0,r.jsx)(e.p,{children:"我们可以将上面两个动画合起来，它的效果如下所示："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index2-ex.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRgoCAABXRUJQVlA4IP4BAAAwLQCdASpsAaoBPp1OpU2lpCOiIrFICLATiWlu4XdhG6WAAxxvO0OLaYxw+EJH1jWR9ewm0xjh8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhCR9Y82pp8ISPrHm1NPhBKjYA64yacdBO7oyu1NPhCR9Y8zexngt66f2+/eGRpfWPNqafBoPWoG4Vd9m8HoDjRagZSrvs3g9AcaLUDKVdplVKOt4PQHGi1AylXfZvB6A40WoGUq77N2XKtoAAP748WK7TFpidC0H3El7k4AAAAAAAAAAAAAAAAAFKvm8kFiBlBlplT46/PQcoyr6gXXUD4ik9EE9GFk7lvwMAIgP3pR7YJEQOqXJ8iiOxboumxT64mlmCJc14jzL/DM2vEeMN8+TgzUwa3oT4+vZp2ZXsy7ZZCwf+K5iypIh7tGJHbdGl4uOF/qtgAA=",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"如果你熟悉CSS动画，你一定知道CSS动画中也是有缓动函数的概念的，而大多数缓动效果可以使用三阶贝塞尔曲线描述。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:a,alt:""})}),"\n",(0,r.jsx)(e.p,{children:"三阶贝塞尔曲线是由P0、P3两个固定点和P2、P1两个动点表述的连续曲线，满足如下线性方程。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"在CSS动画中内置了贝塞尔曲线的缓动函数，比如我们可以写这样的动画："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<div id="block"></div>\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#block {\n  position: absolute;\n  width: 50px;\n  height: 50px;\n  left: 100px;\n  background: red;\n  animation: move 3s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n}\n\n@keyframes move {\n  from {left: 100px}\n  to {left: 400px}\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRhACAABXRUJQVlA4IAQCAAAQJQCdASpMAtYAPp1Opk2lpCOiIPzICLATiWlu4XX1iz/wAAVcS6i281j6wS5XUe4+uFzJo1CXfTtqC3kUJd9O2oLeQuHPT/X/Si0rRjuydOnTp06dOnTp06zL/SjP9RXxuCVXy9xp7yb6dOnTpvhP+/lD8fCuXWjctS5k6dOnTp06dOnTp06dOs9YquTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dOnTp06dN+Qn75jsnTp06dOnTp06dOnTp0dRXunAAD++DwGIGzsDHpM3o+0JXi1/3MAhEPvSVKC+KQxp/fxNouCPtq6IohO81V3/Yub///BNouCIar8SfZ8imHBMOCYcEw4JhwTDgmHBMOCYcEw4JhwTCiRJ5I1WJNrR704C90JYXgFx/ANcsmpRCNP9AR+nYJ5u2Sl5bzAAAwJ6OF0UgPdUlLYhe2kYk7/AAXehKbhKXqDqSxfYVxwXwL3jqo5flhNF2P/oGQn/8iuPnJAEoAAAAAAAAAAAAAAAAAAAWzSGkwiRuADH0OsYwbjZULrgAA=",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"有许多缓动函数都可以通过三阶贝塞尔曲线来实现："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:i,alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["在JS中，我们也可以构造三阶贝塞尔曲线缓动函数，我们可以直接使用",(0,r.jsx)(e.a,{href:"https://github.com/gre/bezier-easing",target:"_blank",rel:"noopener noreferrer",children:"bezier-easing"}),"这个开源库。"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<script src="https://s5.ssl.qhres.com/!8cf7bfcd/bezier-easing.js"><\/script>\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"animate({\n  target: sphere,\n  prop: 'top',\n  duration: 2000,\n  start: 400,\n  end: 100,\n  easing: BezierEasing(0.68, -0.55, 0.265, 1.55),\n  interpolate(start, end, p) {\n    return `${start * (1 - p) + end * p}px`;\n  }\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["上面的代码产生的小球动画效果如下：",(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index2-ex2.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRjACAABXRUJQVlA4ICQCAABwKwCdASoyAdwBPp1OpU2lpCOiIEiQsBOJaW7hdrEe5CmBxhnrwBlZ5r2prBmlFuvQMdZ7U1gzSjIMeZr2prBmlGQY8zXtTWDNKMgx5mvamsGaUZBjzNe1NYM0oyDHma9qawZpRkGPM17U1gzSjIMeZr2prBmlGQY8zXtTWDNKMgx5mvamsGaUZBjzNe1NYM0oyDHma9qawZpRkGPM17U1gzSjIMeZr2prBmlGQY8zXtTWDNKMgx5mvamsGaUZBjzNe1NYM0oyDHma9qawZpRkGPM17U1gzSjIMeZr2prBmlGQY8zXtTWDNKMgx5mvamsGaUZBjzNe0+ISPfiYgvy42PM17U1CUUQZQPmGfyNBZ4PN0liJl1Cm3Qcwz+T6D5hn8n0GV9iyD5hn8n0H84HzDP5PoPmGfyfQfdtTWDNKMgx5mvamsGaUZBjzNe1NYM0oyDHmYq1D7b8Wea9qawZBbNH6AAD+/7M2bo55dTmR/9+/+g9YR40pm7iKYAAAAAAAAAAAAAAABtzWP2zF9+pa7bii4dbfUzd3IeDYc+mDG9je53ESgzq7ZJZ53V/errEYoKRKufo7dTC8vYGE8JHaf9/1/s78q09BtcHrn44Dki+N57cJMRMwhgFAyY3/bN58+HHpATPMLY/PaYghDxBzW6ll8gapGZPZ9+iYbq4Ie6+uN/in6ed75aTCWyL2DBbe8ABTbWGlMwj9wSpV+nMr+uAAAA==",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["实际上，在较新的浏览器环境中，提供了JavaScript原生的动画API，叫做",(0,r.jsx)(e.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API",target:"_blank",rel:"noopener noreferrer",children:"Web Animation API"}),"。这是一个目前还处在草案阶段的新特性，仅被部分较新的浏览器所支持。"]}),"\n",(0,r.jsx)(e.p,{children:"Web Animation API 为DOM元素提供了原生的animate方法，它接受keyframes和options两个参数，能够用JS实现和CSS基本上一致的关键帧动画："}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"sphere.animate([\n  {top: '400px'},\n  {top: '100px'},\n], {\n  duration: 2000,\n  easing: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)',\n  fill: 'forwards',\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["上面的代码和前一个例子实现的效果一致，但是不需要依赖我们自己实现的动画方法，直接用原生的",(0,r.jsx)(e.code,{children:".animate"}),"方法即可。"]}),"\n",(0,r.jsx)(e.p,{children:"\uD83D\uDCA1因为现在Web Animation API仍然处于ED(Editor Draft)阶段，所以支持的浏览器有限，而且未来API可能还会有所变化，所以现在不建议直接使用。"}),"\n",(0,r.jsx)(e.p,{children:"好在，通过前面的例子我们也看到，自己实现一个简单的JS动画函数，也不是什么困难的事情，有了通用灵活的动画机制，我们就可以实现各种有趣的动画效果。不过，有些特殊的动画效果，除了使用动画函数外，可能还需要运用一些特殊的CSS属性。"}),"\n",(0,r.jsxs)(e.h2,{id:"第五个故事特殊的动画效果",children:["第五个故事：特殊的动画效果",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#第五个故事特殊的动画效果",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"前面说了动画的基本思路，基本上所有的动画都可以用前面思路来实现。这个故事，我将带你看一些用特殊的元素属性，实现比较神奇的动画效果。"}),"\n",(0,r.jsxs)(e.h3,{id:"元素渐显",children:["元素渐显",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#元素渐显",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"最简单的渐显元素的方式是改变元素的透明度，通过操作CSS的opacity属性就能实现。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRnQBAABXRUJQVlA4IGgBAABwEACdASoaAUoAPp1Ook0lpKMiIpSY4LATiWlu4W/BK2wEhrv8ewhMi9oitQ5XLkbvh9SyLZJqoO0u78DHqYzRo4hmGZOhgPnvdq2LY7bYmFISCHefZmUDFh7RTcvaYiNLXCXvj+EVL5z7hEQfefaIrSS2G+yvO2sVxFx1m1b/5namJp8riafK2W5yAAD+/f80HOLrF//v3+zZs2sCyY82Ti2SrqzhtCMs4RAsHU29mB5l5usttTif7EflR+7wBRDWyHZFjCnfBluvCcbMsAzAQ9kL3t8pU1uwdj9CnHEsqRrq/Fi0OYKiLUZZVWomfqGYhz5NLaxbMgwdzosEtEqofcZ3/nIcTjR4BsdjPo0iO+aO/0KubL7TWcXNIWWEbx//k05HkIBrulUAiaI1F6Sq76I1xErOTxKdf03fNPqSl3c9W5OWskStD0oA7VTYEAF0rGOslwD2pdl+VOjAgvqQiOJAY86iQAA=",alt:""})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<div id="content">文字内容</div>\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#content {\n  display: inline-block;\n  padding: 5px;\n  border: solid 1px;\n  font-size: 1.5rem;\n  opacity: 0;\n  animation: fade-in 5s infinite;\n}\n\n@keyframes fade-in {\n  to {opacity: 1};\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"那么，如果我们要让元素从上往下，或者从左往右渐显出来，要如何实现呢："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRvYAAABXRUJQVlA4IOoAAAAwDACdASoaAUoAPp1Oo0ylpKMiI+gAsBOJaW7hdUHG8vv8bv2bhkvvwf8i1CiaOMWdS0KA3msH7kXlZaxi5ujjFnB0St4cJhAt7+V5ujiouqI4jMNSZDy1jFzdG63qonxGjjFzdHFN5cAAAP79xRnR/jrEzw/bEpn46+7v8IBD8J7Ft//ANbk4RpCchyFlDs7vc9eZAXzwnQbLXwdbzucQ3J9yNvv07mpBwLb5vuhAZxlWJPAa9tk8AxCw6V/qJbpk5+3ATG2KCnUqkg0QOz9i2//gGDsBdgvGTNX5C52x+gH9BrNkgPiQAAA=",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"我们可以用伪元素遮盖住元素内容，然后用动画改变伪元素的宽或高："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index3-v2.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#content {\n  position: relative;\n  display: inline-block;\n  padding: 5px;\n  border: solid 1px;\n  font-size: 1.5rem;\n}\n\n#content::after {\n  position: absolute;\n  top: -1px;\n  right: -1px;\n  width: calc(100% + 2px);\n  height: calc(100% + 2px);\n  content: ' ';\n  background: white;\n  animation: slide 2s ease-in forwards;\n}\n\n@keyframes slide {\n  to {width: 0};\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"上面的代码需要注意的细节是："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["如果元素有border，伪元素的宽高要设为100%加上border，对应的",(0,r.jsx)(e.code,{children:"top"}),"和",(0,r.jsx)(e.code,{children:"right"}),"要设置为负的border宽度。"]}),"\n",(0,r.jsxs)(e.li,{children:["因为动画中，文字元素是从左往右显现，所以伪元素的宽度需要从左往右缩小，所以我们需要将伪元素的固定点设置在右上角或者右下角，即：设置",(0,r.jsx)(e.code,{children:"top"}),"/",(0,r.jsx)(e.code,{children:"bottom"}),"和",(0,r.jsx)(e.code,{children:"right"}),"属性；如果动画要从右往左显现，则需要设置",(0,r.jsx)(e.code,{children:"top"}),"/",(0,r.jsx)(e.code,{children:"bottom"}),"和",(0,r.jsx)(e.code,{children:"left"}),"属性；同样，如果从上往下显现，那么就设置",(0,r.jsx)(e.code,{children:"left"}),"/",(0,r.jsx)(e.code,{children:"right"}),"和",(0,r.jsx)(e.code,{children:"bottom"}),"属性。"]}),"\n"]}),"\n",(0,r.jsxs)(e.h4,{id:"clip-path属性",children:["clip-path属性",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#clip-path属性",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["上面这个方法有点不够完美，主要是我们给",(0,r.jsx)(e.code,{children:"after"}),"伪元素设置了一个白色的背景，如果父元素的背景不是白色，或者改变了，我们就需要修改对应的属性值。实际上，这个问题有个更简单的解决方案，使用CSS的",(0,r.jsx)(e.code,{children:"clip-path"}),"属性："]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index3-v3.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#content {\n  position: relative;\n  display: inline-block;\n  padding: 5px;\n  border: solid 1px;\n  font-size: 1.5rem;\n  clip-path: polygon(0% 0%, 0% 0%, 0% 100%, 0% 100%);\n  animation: slide 2s forwards;\n}\n\n@keyframes slide {\n  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"clip-path"})," 属性可以创建一个只有元素的部分区域可以显示的剪切区域。区域内的部分显示，区域外的隐藏。剪切区域是被引用内嵌的URL定义的路径或者外部svg的路径，或者作为一个形状例如",(0,r.jsx)(e.code,{children:"polygon()"}),"。而且，重要的是，",(0,r.jsx)(e.code,{children:"clip-path"}),"支持CSS动画。"]}),"\n",(0,r.jsxs)(e.p,{children:["上面的代码中，我们采用",(0,r.jsx)(e.code,{children:"polygon"}),"方法剪切可视区域。这个方法接受8个参数，每两个分别表示一个点的坐标。所以，",(0,r.jsx)(e.code,{children:"polygon(0% 0%, 0% 0%, 0% 100%, 0% 100%)"}),"分别表示前2个点在元素的左上角，后两个点在元素的左下角。",(0,r.jsx)(e.code,{children:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)}"}),"这个是动画结束的状态，4个点分别位于元素的左上角、右上角、右下角和左下角。所以，这段CSS规则表示的是从左到右的渐显动画。"]}),"\n",(0,r.jsxs)(e.p,{children:["稍微修改一下",(0,r.jsx)(e.code,{children:"clip-path"}),"的初始值，我们还可以做斜向或者其他形式的渐显动画："]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index3-v4.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#content {\n  position: relative;\n  display: inline-block;\n  padding: 5px;\n  border: solid 1px;\n  font-size: 1.5rem;\n  clip-path: polygon(0% 0%, 0% 0%, 0% 0%, 0% 100%);\n  animation: slide 2s forwards;\n}\n\n@keyframes slide {\n  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRqAAAABXRUJQVlA4IJQAAADQBwCdASrUAD4APp1Oo00lpKMiI2gAsBOJaW7hc+ABZSTAE2HnLjX/UdkED7NgpR5y41/uwrYabxhvClHF27HjzlxsG2U2MAD+68fHR//vviPsn/a+jmoJq1l/9fHifumQGEDzJBsIvJfB3Su7BUgnuyYL2K8wNc8bHyI6KGJ4/2EiDAIpO/sugMTQ82VksRZAwAAA",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"或者："}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index3-v5.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#content {\n  position: relative;\n  display: inline-block;\n  padding: 5px;\n  border: solid 1px;\n  font-size: 1.5rem;\n  clip-path: polygon(50% 50%, 50% 50%, 50% 50%, 50% 50%);\n  animation: slide 2s forwards;\n}\n\n@keyframes slide {\n  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRoQAAABXRUJQVlA4IHgAAACwBwCdASrUAD4APp1OokylpCMiI2gAsBOJaW7hc+ABjIN4U2Dc2Dctwwn8AdzYNzYNs00j8Up9+Z9+Si/AeHGwbmwZDp+AAP7ub9Gxb/E+pJmP1DyiIXQxgBM9UpE1HSwcKfReFP0aWSk7+rsBiaHmysliLIGAAAA=",alt:""})}),"\n",(0,r.jsxs)(e.h4,{id:"mask属性",children:["mask属性",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#mask属性",children:"#"})]}),"\n",(0,r.jsxs)(e.p,{children:["更复杂的渐显动画可以使用CSS遮罩：",(0,r.jsx)(e.code,{children:"mask"}),"属性，不过这是一个非标准属性，目前需要加-webkit前缀，只有Chorme和Safari等少数浏览器的新版本支持。"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"mask"}),"属性可以指定图片作为元素的遮罩，遮罩外的内容隐藏，而且我们可以把遮罩设置为渐变，所以我们就可以使用渐变遮罩来实现更复杂的渐显效果。"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"#logo {\n  display: inline-block;\n  width: 150px;\n  height: 164px;\n  background-image: url(https://p1.ssl.qhimg.com/t01d64366d00102132a.png);\n  background-size: 100%;\n  -webkit-mask: linear-gradient(to right, #000 0%, transparent 0) 0/20px;\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["如上代码所示，",(0,r.jsx)(e.code,{children:"-webkit-mask"}),"可以设置一张图片作为遮罩图片，这个图片可以是SVG图片、PNG图片、线性渐变或者其他渐变，我们这里使用线性渐变。除了设置遮罩图片，还可以设置遮罩位置/宽高，",(0,r.jsx)(e.code,{children:"0/20px"}),"表示遮罩位置为",(0,r.jsx)(e.code,{children:"0,0"}),"，遮罩宽为20px（这里省略了y轴的100%）。"]}),"\n",(0,r.jsxs)(e.p,{children:["不过因为",(0,r.jsx)(e.code,{children:"linear-gradient"}),"不支持CSS动画，所以我们还需要使用JS："]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"function animate({target, prop, duration, start, end, easing, interpolate} = {}) {\n  const startTime = Date.now();\n\n  return new Promise((resolve) => {\n    function update() {\n      const t = Date.now() - startTime;\n      const p = Math.min(t / duration, 1);\n\n      target.style[prop] = interpolate(start, end, easing ? easing(p) : p);\n      if(p < 1) {\n        requestAnimationFrame(update);\n      } else {\n        resolve(p);\n      }\n    }\n    update();\n  });\n}\n\nanimate({\n  target: logo,\n  prop: 'webkitMask',\n  duration: 1000,\n  start: 0,\n  end: 100,\n  interpolate(start, end, p) {\n    const v = start * (1 - p) + end * p;\n    return `linear-gradient(to right, #000 ${v}%, transparent 0) 0/20px`;\n  }\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["最终实现的效果如下：",(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index3-v6.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,UklGRhwFAABXRUJQVlA4IBAFAABQKACdASrKAMgAPp1Kn0olpKMhq9kIqLATiWNu9sAF+mQBKQdd9PzSg8Xydwxz0j6F+yb7RlUCyVn51nyOcL+6GiVkYw3V8Ul9bB9YGmjwH7Y8KH/xMQGxbPK07kNY1F7NwVGv2aX26DbN2tNxf1J44VYRbZYZzXZLtxkL/wINi/l0nYRYnBS2yEKC72C0E1/VFEOcM8hcQPaI4HWuUYYkIbvx1X8c85nYa2zUx/PbqpjPPaIw0U2FEA/+lcp1zH5A0cwClNOodLxbVTu+GlBJUXAVzWwnfqG3wjkw7nYcFSQIG6m1Xpxfq53OmacwdlOztEpouEZa6BIARvpDJ261UrrED1ExTUb+p+KCpLihuY2gjBRzOl53x5irzMT5gdl/7yU7thFEkUDw9X3gee04qq0AXb32fnlak7fchVlrV8uSCVqQ7LrrucMsAP76qMtXOxRvtuAPGNL+xSEs64FFhBYmrxQBVzL4qCijqq2hnpLj9xHMePskTxk5mmFDmlaX0oXfRJsqhm52CHAz7w6aehpNdhWxQ7FN0ooukeZGIniS8m4/RrTS+LkBHVM3KAAADeDdzbtJtCmKGUXhLJFWAqZ2pKVf7eHb9Cz00Tupvt52HbYmT8HTPcoCAC501K0/8IsnLn/DaYZUCbPeL+rklq7jK9QJal0vunDbwWR8fUMjvNT65HOF6ZjhtoIDCpIF0vQulT6MeruQ5Z685AoFSYP0kbjsh4gKY6OYxXTxNGK0aL+SSnLFwFKMCDnlpkGoaGfMSNmQQZyZZbF6CMbF+HloMtXlA1FcMUSmfHrTN1o05438NV32EvTKaKEHN6vda0lAEAVhQuSuH6ZyAtIv0gMrjtKSUS9vfY31vVFTk2eb25xx+hpgl/yIc29giDujKtIczTH/xIxOsmpn3nozPl7UmJny2JClpbkjyxA7Ysexeh1dkrcvjPDJkqUOUTcMCtt9jkzQLuFu04wDeTkXshL5k0ugF3nKmRdXC62GgO3aHt37TqJV9wT+zkNTvOS0sefG2oWMQJ9figqWV2QIyGjMUcZc3cMPzdfJAUtwOuASkhe54IfOhaBskOUAVVl/DVa5Xyo9ebZj7BV/Ed6w8xHUD3EADMz0slTdKnpOxK07Wuzs6mxGzzZusIQ0FIYlVPXoHnyLDvzhijQUwEXRwxYP+xBCBP2/qWfnRPXrPzhnAFTUQHx/mtg3jYGdWaSI2fB793vXAy+gBLtCrnBFgZIzeRdeCS9Tl4R6Uzm60B67vzNZyHM0WVAnXMr0Dj21jsV3FHGP1ahkHVXv2Y3Ra6lCEL/buc8jeEdvEyYMOJOKqm5rwciywfkESWfcij5ZwLX1PwuWFv55t0icG6BE76SFJbbS+4uVcR8U2ZnnktidZAdpLFHX225LXKlDWLm5KRkIZ4B9yX2Lb6Ai8Sw6HCrexDANT9bDU/jbp3B7kfpQ02hC8EKZ12nRhRk3fDk/cTSmIcSnfXCZ9HMe0YPq5DEAPlObWI4z9yPs9HRb4B80CSje91+6pNuy1vIh3oNBIIrZoBmmzk5rklB9f+Q9omKBmZh+YghyzJb/hqgtkkb+X5MrIkkEHPJbroSH0AAZAJ4Nbo+qfhmoP+C6TrIHKeZB+68el9V6q6t3aoR+sWvY+IDHW/wvESDl+Yhl9GyVt5uVbztA/oxb/q3q1Yj5DUzJ6atAAAAAAAYxo6c9DsfAAAMvWmP/U1ZsnzgAAAA=",alt:""})}),"\n",(0,r.jsxs)(e.h3,{id:"描边动画",children:["描边动画",(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#描边动画",children:"#"})]}),"\n",(0,r.jsx)(e.p,{children:"描边动画是指演示描绘某个图形的动画，比如实现下面的描绘五角星动画。"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:["这样的描边动画可以通过改变SVG元素的",(0,r.jsx)(e.code,{children:"stroke-dasharray"}),"和",(0,r.jsx)(e.code,{children:"stroke-dashoffset"}),"两个属性来实现。"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://junyux.github.io/FE-Advance/day08/index4.html",target:"_blank",rel:"noopener noreferrer",children:"在线演示"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="500" height="500">\n  <g fill="none">\n    <polygon points="100,10 40,180 190,60 10,60 160,180">\n  </g>\n</svg>\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-css",children:"svg polygon {\n  stroke: red;\n  stroke-dasharray: 1000;\n  stroke-dashoffset: 1000;\n  stroke-width: 5;\n  animation: stroke-path 5s linear infinite;\n}\n\n@keyframes stroke-path {\n  to {\n    stroke-dashoffset: 0;\n  }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"stroke-dasharray"}),"表示将图形以虚线描绘，",(0,r.jsx)(e.code,{children:"stroke-dasharray:1000"}),"表示虚线实线每一个线段长度都是",(0,r.jsx)(e.code,{children:"1000px"}),"，一开始第一条线段是实线，第二条线段是虚线，第三条线段是实线...这样依次交替。"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"stroke-dashoffset"}),"表示虚线的偏移，将它也设置为",(0,r.jsx)(e.code,{children:"1000"}),"，那么第一条线就被移出了可见区域，从虚线（即第二条线）开始展示，所以此时的五角星并没有显示出来，然后我们以动画的方式改小虚线的偏移量，这样的话，第一条线（实线）就被慢慢移回可视区域，于是图形的线条就逐步展示出来了。"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)("img",{src:d,alt:""})}),"\n",(0,r.jsx)(e.p,{children:"SVG元素除了使用CSS、JS动画，还可以使用SVG支持的SMIL动画，SMIL是Synchronized Multimedia Integration Language的简称。关于SVG的SMIL动画，超过了本课程讨论的范畴，在这里不做进一步讨论，在后续专门讨论SVG的课程中，会有深入的讨论。"})]})}function j(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,t.ah)(),n.components);return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(x,{...n})}):x(n)}let m=j;j.__RSPRESS_PAGE_META={},j.__RSPRESS_PAGE_META["%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BF%9B%E9%98%B6%2010%20%E6%97%A5%E8%B0%88%2F8.%E7%AC%AC%E5%85%AB%E6%97%A5%EF%BC%9A%E7%8E%A9%E8%BD%AC%E5%8A%A8%E7%94%BB.md"]={toc:[{text:"第一个故事：匀速圆周运动",id:"第一个故事匀速圆周运动",depth:2},{text:"圆周运动",id:"圆周运动",depth:3},{text:"第二个故事：匀速圆周运动 2.0",id:"第二个故事匀速圆周运动-20",depth:2},{text:"第三个故事：自由落体和弹跳小球",id:"第三个故事自由落体和弹跳小球",depth:2},{text:"第四个故事：常用动画实现技巧",id:"第四个故事常用动画实现技巧",depth:2},{text:"插值",id:"插值",depth:3},{text:"缓动",id:"缓动",depth:3},{text:"第五个故事：特殊的动画效果",id:"第五个故事特殊的动画效果",depth:2},{text:"元素渐显",id:"元素渐显",depth:3},{text:"clip-path属性",id:"clip-path属性",depth:4},{text:"mask属性",id:"mask属性",depth:4},{text:"描边动画",id:"描边动画",depth:3}],title:"8.第八日：玩转动画",headingTitle:"8.第八日：玩转动画",frontmatter:{}}}}]);