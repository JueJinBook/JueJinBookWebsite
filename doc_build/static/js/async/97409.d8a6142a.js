"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["97409"],{427772:function(e,s,n){n.r(s),n.d(s,{default:()=>M});var i=n(552676),c=n(740453);let a=n.p+"static/image/126d68c17bb0712a53e15706beedae5e.aa60d466.webp",p=n.p+"static/image/5429522f4f295b432cbb9d8ba21afa5d.e7b9000a.webp",t=n.p+"static/image/fabe6f1550a9621e95c4fae8245f16fa.720e0265.webp",r=n.p+"static/image/8414c71a80cf7d8b9f631af366b7c0c4.3f56f2f4.webp",d=n.p+"static/image/0829a30bd9cf05f25c6a7126a4d7441b.8fe4389a.webp",l=n.p+"static/image/891616969aa632a1786ed8d065e9915b.b1ca00c4.webp",j=n.p+"static/image/a6143377b49fef367272735d37770125.6b9d88bf.webp",x=n.p+"static/image/50847bd3302e6b53b034f27cfb8c7b2c.30b74637.webp",b=n.p+"static/image/ac929561af9d6f0ab878e7d24a005bc7.f166a4c7.webp",f=n.p+"static/image/3573b114a11fe4734ffc6e5abb7b9486.53801dcf.webp",h=n.p+"static/image/8e34165bedb1f84c010c8bf8d2ec243f.b83dfb1f.webp",g=n.p+"static/image/f3ff4698eb56bb9039ec648ab3247dc3.f8d9dcda.webp",m=n.p+"static/image/f85fd5ae2aebc5d37765f14068dbda26.b7e7be31.webp",o=n.p+"static/image/21d9a13e6413a954b2fe79416fca039a.5f76c168.webp",u=n.p+"static/image/f10de8475492f917c22db89ac1cff568.1b7a95ea.webp",A=n.p+"static/image/97d074496e07bf37b8f70155437ef9c1.df3ea1ba.webp",E=n.p+"static/image/893a0e9e55287fdf426f9adb7c1cf2aa.517a4d20.webp",w=n.p+"static/image/5689d370a79ff88643cc22a80ebc1c04.50b78883.webp",F=n.p+"static/image/1f852f64862945cdb1b61da8d3f3e80f.007b6eae.webp",B=n.p+"static/image/3c3dbd9b79d5b68cf11d59d2825d4bd5.47a1e699.webp",S=n.p+"static/image/7b6df5df105b940ca127edd0fd024e34.c342ef89.webp";function X(e){let s=Object.assign({h1:"h1",a:"a",p:"p",img:"img",strong:"strong",pre:"pre",code:"code",h2:"h2"},(0,c.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.h1,{id:"27加餐typescript-新语法-satisfies用声明-or-用推导",children:["27.加餐：TypeScript 新语法 satisfies：用声明 or 用推导？",(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#27加餐typescript-新语法-satisfies用声明-or-用推导",children:"#"})]}),"\n",(0,i.jsx)(s.p,{children:"用了 TypeScript 之后，我们就可以声明类型，然后给 js 变量加上这个类型。"}),"\n",(0,i.jsx)(s.p,{children:"比如这样："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:S,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"就有类型提示了："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(s.p,{children:"也会做类型检查："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:B,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"但也不是所有的变量都要手动声明类型，因为 ts 会做自动类型推导："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:F,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"同样是有类型提示和检查的："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:w,alt:""})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:E,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"而且推导的时候还可以加上 as const，这样推导出的是字面量类型（不过会有 readonly 的修饰）："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:A,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"那问题来了，什么时候手动声明类型，什么时候用自动推导呢？"}),"\n",(0,i.jsx)(s.p,{children:"比如上面这个 obj，b 属性推导出的是 string，但其实也可能是一个 number。"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:u,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"但给它赋值 number 会报错："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:o,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"这种就得手动声明类型了："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:m,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"还有，函数的参数，只有调用的时候才能知道参数具体的类型，这时候怎么自动推导？"}),"\n",(0,i.jsx)(s.p,{children:"没办法推导。"}),"\n",(0,i.jsx)(s.p,{children:"所以也得手动声明类型："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:g,alt:""})}),"\n",(0,i.jsxs)(s.p,{children:["总之，",(0,i.jsx)(s.strong,{children:"ts 代码包括自动推导出的类型、手动声明的类型两种。"})]}),"\n",(0,i.jsx)(s.p,{children:"自动类型推导省去了很多写类型的麻烦，但很多情况下还是要手动声明类型的。"}),"\n",(0,i.jsx)(s.p,{children:"但手动声明的类型是有局限性的，比如这样的类型："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:h,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"key:string 那部分是索引签名，也就是任意的 key 为 string，value 为任意类型的索引都可以加。"}),"\n",(0,i.jsx)(s.p,{children:"它是可以检查出类型错误，也支持扩展任意索引。"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:f,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"但它只会提示声明的索引，动态添加的那些是不会提示的："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:b,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"这样其实有的时候并不方便。"}),"\n",(0,i.jsx)(s.p,{children:"而如果自动推导呢？"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:x,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"这样就可以提示所有的索引了。"}),"\n",(0,i.jsx)(s.p,{children:"但是呢其中 b 的类型又不对，还是需要声明类型来约束。"}),"\n",(0,i.jsx)(s.p,{children:"是不是就很头疼？"}),"\n",(0,i.jsx)(s.p,{children:"用声明的方式少了具体赋值的变量类型的信息，用自动推导的方式又不能保证类型是对的。"}),"\n",(0,i.jsx)(s.p,{children:"有没有两全其美的办法呢？"}),"\n",(0,i.jsx)(s.p,{children:"4.9 之前还真没有。"}),"\n",(0,i.jsx)(s.p,{children:"不过 4.9 加入了一个 satisfies 的新语法。"}),"\n",(0,i.jsx)(s.p,{children:"这样用："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:j,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"不需要给变量声明这个类型了，用自动推导出来的类型，这样提示就是根据具体的值来的。"}),"\n",(0,i.jsx)(s.p,{children:"而且，还有了声明的方式的类型检查。"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:l,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"是不是两全其美！"}),"\n",(0,i.jsx)(s.p,{children:"这就是为什么 ts 要增加 satisfies 这个语法。"}),"\n",(0,i.jsxs)(s.p,{children:["它的作用就是",(0,i.jsx)(s.strong,{children:"让你用自动推导出的类型，而不是声明的类型，增加灵活性，同时还可以对这个推导出的类型做类型检查，保证安全。"})]}),"\n",(0,i.jsx)(s.p,{children:"但是，satisfies 的方式也有它的问题，比如这里用了推导出的类型："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:d,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"那就不能动态扩展索引了："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"而如果是声明的那种索引签名，是支持扩展的："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:t,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"所以，具体什么时候用声明的类型，什么时候用推导出的类型 + satisfies，还是要看情况的。"}),"\n",(0,i.jsx)(s.p,{children:"这个新语法还是很有用的，估计以后在代码里会经常看到。"}),"\n",(0,i.jsx)(s.p,{children:"不过现在还没咋见，因为他还是在 beta 的版本。"}),"\n",(0,i.jsx)(s.p,{children:"需要下载 ts 指定 beta 才行："}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"npm install typescript@beta\n"})}),"\n",(0,i.jsx)(s.p,{children:"这里的 @beta 是指定标签的意思。"}),"\n",(0,i.jsx)(s.p,{children:"我猜大家都用过 xxx@latest 的方式下载过 npm 包。"}),"\n",(0,i.jsx)(s.p,{children:"这个 latest 也同样是标签。"}),"\n",(0,i.jsx)(s.p,{children:"你可以通过 npm dist-tag ls 的方式看到 npm 包的所有 tag："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:p,alt:""})}),"\n",(0,i.jsx)(s.p,{children:"所以说 npm install typescript 是下载不了 beta 版本的包的，它下载的是 latest 的 tag 对应的版本。只有手动指定 typescript@beta 才可以。"}),"\n",(0,i.jsx)(s.p,{children:"说点题外话，这个 tag 是怎么打上的呢？"}),"\n",(0,i.jsx)(s.p,{children:"发包的时候会用 npm publish，这种会自动打上 latest 的 tag。"}),"\n",(0,i.jsx)(s.p,{children:"也可以手动 npm publish --tags beta，这样打的就是 beta 的 tag了。"}),"\n",(0,i.jsx)(s.p,{children:"除了发包的时候可以指定 tag，平时也可以通过 npm dist-tag 命令来给某个版本的包打上 tag："}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)("img",{src:a,alt:""})}),"\n",(0,i.jsxs)(s.h2,{id:"总结",children:["总结",(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,i.jsx)(s.p,{children:"TypeScript 中变量的类型有两种，一种是手动声明的，一种是自动推导的。"}),"\n",(0,i.jsx)(s.p,{children:"大多数情况下，不用手动声明类型，用自动推导的就行，比较方便。"}),"\n",(0,i.jsx)(s.p,{children:"但像函数参数、需要约束的变量类型等情况下就得手动声明了。"}),"\n",(0,i.jsx)(s.p,{children:"有的时候还是自动推导出的类型更合适一些，但是还需要通过声明的方式对其中的类型做约束。"}),"\n",(0,i.jsx)(s.p,{children:"不能两全其美。"}),"\n",(0,i.jsx)(s.p,{children:"所以 ts 加入了 satisfies 的语法，这样就可以用自动推导出的类型了，它也可以加上类型的约束。"}),"\n",(0,i.jsx)(s.p,{children:"算是融合了自动推导的类型和手动声明的类型的优点。"}),"\n",(0,i.jsx)(s.p,{children:"现在这个语法还在 4.9-beta 的包里，需要 npm install 的时候手动指定 dist-tag。"}),"\n",(0,i.jsx)(s.p,{children:"估计等它到正式版之后，你再写 ts 代码会有新的纠结了："}),"\n",(0,i.jsx)(s.p,{children:"我是用手动声明的类型，还是自动推导的类型 + satiesfies 呢？这是个问题。"})]})}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.ah)(),e.components);return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(X,{...e})}):X(e)}let M=v;v.__RSPRESS_PAGE_META={},v.__RSPRESS_PAGE_META["TypeScript%20%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F27.%E5%8A%A0%E9%A4%90%EF%BC%9ATypeScript%20%E6%96%B0%E8%AF%AD%E6%B3%95%20satisfies%EF%BC%9A%E7%94%A8%E5%A3%B0%E6%98%8E%20or%20%E7%94%A8%E6%8E%A8%E5%AF%BC%EF%BC%9F.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"27.加餐：TypeScript 新语法 satisfies：用声明 or 用推导？",headingTitle:"27.加餐：TypeScript 新语法 satisfies：用声明 or 用推导？",frontmatter:{}}}}]);