"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["80955"],{821330:function(e,n,s){s.r(n),s.d(n,{default:()=>o});var i=s(552676),r=s(740453);let c=s.p+"static/image/54c695e078097bc7366aa2599ec67a0d.0ff857b4.webp",t=s.p+"static/image/0808513fcc0534e9cd1e32a439c6893f.56297913.webp",a=s.p+"static/image/dd38c28549a7f18e1c9a970ff6762133.fe477d61.webp";function l(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",img:"img",pre:"pre",code:"code",ul:"ul",li:"li",strong:"strong",blockquote:"blockquote",ol:"ol"},(0,r.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"18-实战8搜索组件开发",children:["18 实战8：搜索组件开发",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#18-实战8搜索组件开发",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"本节主要讲如何引入搜索组件，以及如何定制搜索组件。"}),"\n",(0,i.jsxs)(n.h2,{id:"发现页与视频页面添加标题栏",children:["发现页与视频页面添加标题栏",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#发现页与视频页面添加标题栏",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"细心的小伙伴早就可能发现了首页与视频页面并没有头部。这一块头部的添加是相关联搜索的，需要特殊处理一下，因此放到这一节来说。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:a,alt:""})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:t,alt:""})}),"\n",(0,i.jsx)(n.p,{children:"由于发现页面布局的改变，因此原有的代码也是需要进行稍微的调整，改为：头部标题栏 + 滚动浏览区域。"}),"\n",(0,i.jsx)(n.p,{children:"发现页相关代码："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<view>\n  \x3c!-- 头部 --\x3e\n  <uni-nav-bar fixed status-bar>\n	<block slot="left"><image class="top-img" src="/static/image/search/6.png"></image></block>\n	<view class="top-search flex-box">\n	  <image class="search-icon" src="/static/image/search/2.png"></image>\n	  {{ searchTxt }}\n	</view>\n	\x3c!-- #ifdef APP-PLUS || H5 --\x3e\n	<block slot="right"><image class="top-img" src="/static/image/mine/r.png"></image></block>\n	\x3c!-- #endif --\x3e\n  </uni-nav-bar>\n  \x3c!-- 滚动区域 --\x3e\n  <view class="page-content">\n	<mescroll-uni ref="mescroll" :fixed="false" :down="downOption" :up="upOption" @down="downCallback" @up="upCallback">\n	  滚动区域内容\n	</mescroll-uni>\n  </view>\n</view>\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:".page-content {\n  position: fixed;\n  top: 64px;\n  left: 0;\n  right: 0;\n  bottom: 0px;\n  /* #ifdef H5 || MP-WEIXIN */\n  top: 44px;\n  /* #endif */\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"在发现页与视频页面上的搜索框并不是 input 表单控件，是直接由 view 模拟的。"}),"\n",(0,i.jsx)(n.p,{children:"上面介绍了页面标题栏，那么就是确定了搜索的入口了。我们要实现的是点击首页的模拟搜索框，然后搜索页出现的交互。接下来我们开始开发这个组件。"}),"\n",(0,i.jsxs)(n.h2,{id:"开发搜索组件",children:["开发搜索组件",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#开发搜索组件",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"类似这样的窗口类的组件页面，我们在定义的时候，就要控制显示及隐藏。"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<template>\n  <view class="search-page" v-if="isShow">\n	主体内容\n  </view>\n</template>\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"data() {\n  return {\n	  isShow: false\n  }\n},\nmethods: {\n  close () {\n		this.$emit('close')  // 分发关闭事件给父组件监听\n		this.isShow = false\n	// 业务逻辑\n  },\n  open () {\n		this.isShow = true\n	// 业务逻辑\n  },\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"这样就可以在父页面进行引入调用，控制搜索组件显示及隐藏了。"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<search ref="search" @close="closeSearch"></search>\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"import search from '@/components/search.vue';\nexport default {\n  components: {\n		search\n  },\n  methods: {\n		// 打开搜索\n		openSearch() {\n			this.$refs.search.open()\n		},\n		// 监听关闭搜索\n		closeSearch() {\n			// 业务逻辑\n		}\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"说完搜索组件的调用，接下来讲解一下如何写实现页面。"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:c,alt:""})}),"\n",(0,i.jsx)(n.p,{children:"这个组件的布局相关代码："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<template>\n  <view class="search-page" v-if="isShow">\n	\x3c!-- 头部 --\x3e\n	<uni-nav-bar fixed :isShowLeft="false" :status-bar="true" @clickLeft="goCloud" @clickRight="goCloud">\n	  <view class="search-box  flex-box">\n		<view class="top-search flex-box flex-item">\n		  <image class="search-icon" src="/static/image/search/2.png"></image>\n		  <input class="flex-item" :focus="isFocus" type="text" v-model="searchTxt" @confirm="addSearch" confirm-type="search">\n		</view>\n		<view class="cancle" @click="close">取消</view>\n	  </view>\n	  \x3c!-- #ifdef APP-PLUS || H5 --\x3e\n	  <block slot="right"><image class="top-img" src="/static/image/search/1.png"></image></block>\n	  \x3c!-- #endif --\x3e\n	</uni-nav-bar>\n	\x3c!-- 滚动区域 --\x3e\n	<scroll-view class="page-content">\n	  内容区域\n	</scroll-view>\n  </view>\n</template>\n'})}),"\n",(0,i.jsx)(n.p,{children:"关键代码："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<input class="flex-item" :focus="isFocus" type="text" v-model="searchTxt" @confirm="addSearch" confirm-type="search">\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:':focus="isFocus"'})," 获取焦点，是否唤起键盘；"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'v-model="searchTxt"'})," 监听输入值；"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'confirm-type="search"'})," 键盘右下角按钮显示为",(0,i.jsx)(n.strong,{children:"搜索"}),'（仅在 type="text" 时生效）；']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'@confirm="addSearch"'})," 点击右下角",(0,i.jsx)(n.strong,{children:"搜索"}),"执行 ",(0,i.jsx)(n.code,{children:"addSearch"})," 事件。"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["整个交互逻辑是从发现页点击入口加载这个页面，然后输入框自动聚焦，唤起软键盘。输入框输入文字后点击软键盘的",(0,i.jsx)(n.strong,{children:"搜索"}),"完成一次搜索。软键盘弹出后，点击非置焦区域可收起软键盘。点击输入框旁边的",(0,i.jsx)(n.strong,{children:"取消"}),"关闭搜索组件。"]}),"\n",(0,i.jsx)(n.p,{children:"由于当前开发的输入框不是 app 平台的原生输入框，存在一个问题是当 input 获得焦点，键盘弹起，然后不点击键盘的完成，就无法关闭键盘。官方作出解释："}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"App 平台在 iOS 上，webview 中的软键盘弹出时，默认在软键盘上方有一个横条，显示着：上一项、下一项和完成等按钮。如不想显示这个横条，可以配置 softinputNavBar: 'none'。"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"配置方式，在 pages.json 中配置 style"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'"app-plus": {\n	"softinputNavBar": "none"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"在 pages.json 单个页面的设置："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'{\n  "path": "pages/index/index",\n  "style": {\n	"navigationBarTitleText": "发现",\n	"navigationStyle": "custom",\n	"app-plus":{\n	  "titleNView": false,\n	  "bounce" : "none", // 取消iOS回弹,避免和下拉刷新冲突\n	  "disableScroll": true,   // Android小程序卡顿\n	  "softinputNavBar": "none"\n	}\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"原生输入框在iOS上不会有软键盘上方的横条。"}),"\n",(0,i.jsxs)(n.h2,{id:"使用-storage-存储搜索记录",children:["使用 storage 存储搜索记录",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用-storage-存储搜索记录",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsxs)(n.p,{children:["这一块的信息一般就是由前端的存储机制去做了，在这使用 Uniapp 的 ",(0,i.jsx)(n.code,{children:"uni.setStorageSync()"})," ，",(0,i.jsx)(n.code,{children:"uni.getStorageSync()"})," 进行存取搜索历史。"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// 获取搜索历史\ngetSearchList () {\n  try {\n	  const value = uni.getStorageSync('searchlist');\n	  if (value) {\n	  this.historyList = JSON.parse(value)\n	  }\n  } catch (e) {\n	  // error\n  }\n},\n// 清除历史\nclearSearch () {\n  uni.showModal({\n	  title: '',\n	  content: '确认清除全部历史记录？',\n	  success: res => {\n		  if (res.confirm) {\n		uni.setStorageSync('searchlist', '')\n		this.historyList = []\n		  } else if (res.cancel) {\n			  // console.log('用户点击取消');\n		  }\n	  }\n  });\n  \n},\n// 添加搜索\naddSearch () {\n  const txt = this.searchTxt.trim()\n  \n  if (txt.length == 0) {  // 空字符不添加\n	return false\n  }\n  \n  const tempIndex = this.historyList.indexOf(txt)\n  if (tempIndex !== -1) {  // 如果存在相同的删除旧的\n	this.historyList.splice(tempIndex, 1)\n  }\n  \n  // 插入数组前\n  this.historyList.unshift(txt)\n  if (this.historyList.length > 7) {  // 数组长度7\n	this.historyList = this.historyList.slice(0, 7)\n  }\n  uni.setStorageSync('searchlist', JSON.stringify(this.historyList))\n},\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"使用防抖功能优化请求",children:["使用防抖功能优化请求",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用防抖功能优化请求",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"防抖(debounce)：单位时间内多次触发只会执行一次，即如果短时间内大量触发同一事件，只会执行一次函数。"}),"\n",(0,i.jsx)(n.p,{children:"这个在前端开发的过程中比较容易遇到，经常需要绑定一些持续触发的事件，如 resize、scroll、mousemove、change 等等，但我们并不希望在事件持续触发的过程中那么频繁地去执行函数。防止高频率的触发请求后台服务器。"}),"\n",(0,i.jsx)(n.p,{children:"我们要做的优化策略是当事件被触发时，设定一个周期延迟执行搜索动作，若期间又被触发，则重新设定周期，直到周期结束，执行搜索动作。这样搜索的请求控制在一定时间内。"}),"\n",(0,i.jsx)(n.p,{children:"防抖代码："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// 防抖\nfunction debounce(fn, wait = 300) {    \n    var timeout = null;    \n    return function() {        \n        if(timeout !== null) clearTimeout(timeout);        \n        timeout = setTimeout(fn, wait);    \n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"代码使用："}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<input type="text" v-model="searchTxt" confirm-type="search" @input="inputSearch">\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"methods: {\n	// 输入搜索\n	inputSearch: debounce(() => {\n	 	// 未搜索或者写入空格的情况下不显示搜索建议\n		if (!that.searchTxt.trim().length) {\n			that.suggestList = []\n			return false\n		}\n		const par = {\n			type: 'mobile',\n			keywords: that.searchTxt.trim(),\n		}\n		// 请求后台数据\n		apiSearchSuggest(par).then(res => {\n			that.suggestList = res.result.allMatch\n		})\n	})\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"像很多抢票、抢购这类操作很多都加了防抖优化策略，为了避免用户大量点击造成服务器压力，当固定时间内，不论点击多少次，只执行一次抢的动作。"}),"\n",(0,i.jsxs)(n.p,{children:["感兴趣的小伙伴可以扩展了解一下与防抖实现的效果类似的",(0,i.jsx)(n.strong,{children:"节流"}),"。"]}),"\n",(0,i.jsxs)(n.p,{children:["业界最标准的当属 ",(0,i.jsx)(n.code,{children:"lodash"})," 库的两个方法，",(0,i.jsx)(n.a,{href:"https://www.lodashjs.com/docs/latest#debounce",target:"_blank",rel:"noopener noreferrer",children:"debounce"}),"，",(0,i.jsx)(n.a,{href:"https://www.lodashjs.com/docs/latest#throttle",target:"_blank",rel:"noopener noreferrer",children:"throttle"}),"，有兴趣的可以查看源码。"]}),"\n",(0,i.jsx)(n.p,{children:"当前的搜索组件的主要逻辑就是这么多，引入到发现页与视频页即可。"}),"\n",(0,i.jsxs)(n.h2,{id:"小结",children:["小结",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#小结",children:"#"})]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"类似窗口类的组件页面，我们在定义的时候，就要暴露方法给父组件控制显示及隐藏；"}),"\n",(0,i.jsx)(n.li,{children:"一些不用后台处理的信息可以放到前端去处理，这样可以避免与后台不必要的交互，防止资源浪费；"}),"\n",(0,i.jsx)(n.li,{children:"防抖是有效解决高频率触发请求后台服务器的方法。"}),"\n",(0,i.jsxs)(n.li,{children:["本章代码 ",(0,i.jsx)(n.a,{href:"https://github.com/front-end-class/uniapp-music-code/blob/master/uni-course-%E5%AE%9E%E6%88%98%E5%BC%80%E5%8F%91%E6%90%9C%E7%B4%A2%E9%A1%B5.zip",target:"_blank",rel:"noopener noreferrer",children:"uni-course-实战开发搜索页"}),"。"]}),"\n"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}let o=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["Uniapp%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6%2F18%20%E5%AE%9E%E6%88%988%EF%BC%9A%E6%90%9C%E7%B4%A2%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91.md"]={toc:[{text:"发现页与视频页面添加标题栏",id:"发现页与视频页面添加标题栏",depth:2},{text:"开发搜索组件",id:"开发搜索组件",depth:2},{text:"使用 storage 存储搜索记录",id:"使用-storage-存储搜索记录",depth:2},{text:"使用防抖功能优化请求",id:"使用防抖功能优化请求",depth:2},{text:"小结",id:"小结",depth:2}],title:"18 实战8：搜索组件开发",headingTitle:"18 实战8：搜索组件开发",frontmatter:{}}}}]);