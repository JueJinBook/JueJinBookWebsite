"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["18130"],{250595:function(n,e,a){a.r(e),a.d(e,{default:()=>E});var t=a(552676),s=a(740453);let i=a.p+"static/image/650931b35e5bda50163f6d5067d7ac74.6ac01cb8.gif",r=a.p+"static/image/774b13c7df46462a73e23fbf29dbb638.883ee41d.webp",c=a.p+"static/image/f7ca9b55ce2e37fd17711f922cfacddb.a52856c3.webp",o=a.p+"static/image/f68d2a0b4cc7f50bef2aa86cebbd666c.2e16430d.webp",d=a.p+"static/image/dbe99bd0f31f6fa913c3d2fdbcfd1cd5.3c6831ac.webp",l=a.p+"static/image/1200e3f9db2d34f61baebf7004aaf767.e92be3bb.webp",m=a.p+"static/image/0dbb22c97f0e2696e37075e687c1a211.271330d7.webp",p=a.p+"static/image/29b4139f09d89dec345c0a635779bdac.331b9432.webp",h=a.p+"static/image/1b9d3a939f572513b384d7d09aa690e3.f77b69ad.webp",b=a.p+"static/image/67270ce0f586e133b12f2f70a054107a.5f00866f.webp",g=a.p+"static/image/c31d1bd9f4fb3e179fcc87b8746950d8.459031c3.webp",x=a.p+"static/image/667b79cd3bb5a977d5c233ccaf926767.2e6e1eaa.webp",u=a.p+"static/image/22e34e9cc1b3da6a361bcbec471edee8.f873ac62.gif",f=a.p+"static/image/ce9afec27929f02f77832589f3a5c337.db256b0b.webp",j=a.p+"static/image/5b1588ee159535b1b5a6e2c9d67b05be.aadb7e31.webp",k=a.p+"static/image/a12ac1918e200841646a57a8055711b9.3a8b5b9a.webp",v=a.p+"static/image/e951c3d02b91ccb51257d03a5edb1956.3038c47e.webp";function B(n){let e=Object.assign({h1:"h1",a:"a",p:"p",img:"img",pre:"pre",code:"code",h2:"h2"},(0,s.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.h1,{id:"31-图书管理系统图书模块前端开发--图书搜索",children:["31. 图书管理系统：图书模块前端开发--图书搜索",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#31-图书管理系统图书模块前端开发--图书搜索",children:"#"})]}),"\n",(0,t.jsx)(e.p,{children:"这节继续来写图书管理模块的前端部分。"}),"\n",(0,t.jsx)(e.p,{children:"就是一个页面和几个弹窗："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:v,alt:""})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:k,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"我们先写下图书列表："}),"\n",(0,t.jsx)(e.p,{children:"改下 BookManage/index.tsx"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:'import { Button, Card, Form, Input } from \'antd\';\nimport \'./index.css\';\n\nexport function BookManage(){\n    return <div id="bookManage">\n        <h1>图书管理系统</h1>\n        <div className="content">\n            <div className=\'book-search\'>\n                <Form\n                    name="search"\n                    layout=\'inline\'\n                    colon={false}\n                >\n                    <Form.Item label="图书名称" name="name">\n                        <Input />\n                    </Form.Item>\n                    <Form.Item label=" ">\n                        <Button type="primary" htmlType="submit">\n                            搜索图书\n                        </Button>\n                        <Button type="primary" htmlType="submit" style={{background: \'green\'}} >\n                            添加图书\n                        </Button>\n                    </Form.Item>\n                </Form>\n            </div>\n            <div className="book-list">\n                {\n                    [1,2,3,4,5,6,7].map(item => {\n                        return <Card\n                            className=\'card\'\n                            hoverable\n                            style={{ width: 300 }}\n                            cover={<img alt="example" src="https://os.alipayobjects.com/rmsportal/QBnOOoLaAfKPirc.png" />}\n                        >\n                            <h2>西游记</h2>\n                            <div>神说要有光</div>\n                            <div className=\'links\'>\n                                <a href="#">详情</a>\n                                <a href="#">编辑</a>\n                                <a href="#">删除</a>\n                            </div>\n                        </Card>\n                    })\n                }    \n            </div>\n        </div>\n    </div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"上面是一个 Form，下面是 Card 的列表。"}),"\n",(0,t.jsx)(e.p,{children:"在 index.css 写下样式："}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-css",children:"#bookManage {\n    display: flex;\n    flex-direction: column;\n}\n\n#bookManage h1 {\n    height: 80px;\n    line-height: 80px;\n    border-bottom: 2px solid #ccc;\n    padding-left: 20px;\n}\n\n#bookManage .content {\n    padding: 20px;\n}\n\n#bookManage .book-list{\n    padding: 20px;\n    display: flex;\n    flex-wrap: wrap;\n}\n\n#bookManage .book-list .card{\n    margin-left: 30px;\n    margin-bottom: 30px;\n}\n\n#bookManage .book-list .links{\n    display: flex;\n    \n    flex-direction: row;\n    justify-content: space-around;\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"这里还需要重置样式，在 main.tsx 里引入下："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:j,alt:""})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:f,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"看下效果："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:u,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"然后我们在 interfaces/index.ts 里加下图书列表的请求："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:x,alt:""})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"export async function list() {\n    return await axiosInstance.get('/book/list');\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"然后在组件里调用下："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:g,alt:""})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:b,alt:""})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:'import { Button, Card, Form, Input, message } from \'antd\';\nimport \'./index.css\';\nimport { useEffect, useState } from \'react\';\nimport { list } from \'../../interfaces\';\n\ninterface Book {\n    id: number;\n    name: string;\n    author: string;\n    description: string;\n    cover: string;\n}\n\nexport function BookManage(){\n\n    const [bookList, setBookList] = useState<Array<Book>>([]);\n\n    async function fetchData() {\n        try {\n            const data = await list();\n            \n            if(data.status === 201 || data.status === 200) {\n                setBookList(data.data);\n            }\n        } catch(e: any) {\n            message.error(e.response.data.message);\n        }\n    }\n\n    useEffect(() => {\n        fetchData();\n    }, []);\n\n    return <div id="bookManage">\n        <h1>图书管理系统</h1>\n        <div className="content">\n            <div className=\'book-search\'>\n                <Form\n                    name="search"\n                    layout=\'inline\'\n                    colon={false}\n                >\n                    <Form.Item label="图书名称" name="name">\n                        <Input />\n                    </Form.Item>\n                    <Form.Item label=" ">\n                        <Button type="primary" htmlType="submit">\n                            搜索图书\n                        </Button>\n                        <Button type="primary" htmlType="submit" style={{background: \'green\'}} >\n                            添加图书\n                        </Button>\n                    </Form.Item>\n                </Form>\n            </div>\n            <div className="book-list">\n                {\n                    bookList.map(book => {\n                        return <Card\n                            className=\'card\'\n                            hoverable\n                            style={{ width: 300 }}\n                            cover={<img alt="example" src={`http://localhost:3000/${book.cover}`} />}\n                        >\n                            <h2>{book.name}</h2>\n                            <div>{book.author}</div>\n                            <div className=\'links\'>\n                                <a href="#">详情</a>\n                                <a href="#">编辑</a>\n                                <a href="#">删除</a>\n                            </div>\n                        </Card>\n                    })\n                }    \n            </div>\n        </div>\n    </div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"我现在服务端的 books.json 是这样的："}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'[\n  {\n    "id": 328555,\n    "author": "曹雪芹",\n    "name": "红楼梦",\n    "description": "这是中国古代四大名著之一，被认为是中国文学的巅峰之作。它以贾、史、王、薛四大家族的婚姻和命运为线索，描绘了中国封建社会的荣辱兴衰、人情世故、爱恨情仇等。",\n    "cover": "uploads/1721191961112-224327292-qiong.png"\n  },\n  {\n    "id": 281167,\n    "author": "施耐庵",\n    "name": "水浒传",\n    "description": "这是中国古代四大名著之一，以108位好汉的故事为主线，反映了宋朝末年民变斗争与各阶层人民的痛苦生活。该作品强调了义气、反抗不平等待遇等社会主题。",\n    "cover": "uploads/1721191961112-224327292-qiong.png"\n  },\n  {\n    "id": 197528,\n    "author": "吴承恩",\n    "name": "西游记",\n    "description": "这是中国古代四大名著之一，讲述了唐僧师徒四人西天取经、斩妖除魔的故事。作品深入探讨了佛教和道教的思想，同时也展示了人性的善恶之间的斗争。",\n    "cover": "uploads/1721191961112-224327292-qiong.png"\n  }\n]\n'})}),"\n",(0,t.jsx)(e.p,{children:"看下效果："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:h,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"可以看到，图书列表加载并渲染了出来。"}),"\n",(0,t.jsx)(e.p,{children:"然后来实现下搜索，之前的 list 接口没支持搜索，我们改造下："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:p,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"在 /book/list 接口添加一个 name 参数。"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"@Get('list')\nasync list(@Query('name') name: string) {\n    return this.bookService.list(name);\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"然后在 BookService 里实现下搜索："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:m,alt:""})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"async list(name: string) {\n    const books: Book[] = await this.dbService.read();\n    return name ? books.filter(book => {\n        return book.name.includes(name);\n    }) : books;\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"在 postman 里测试下："}),"\n",(0,t.jsx)(e.p,{children:"当没传参数时："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:l,alt:""})}),"\n",(0,t.jsxs)(e.p,{children:["传 name=西 时：\n",(0,t.jsx)("img",{src:d,alt:""})]}),"\n",(0,t.jsxs)(e.p,{children:["传 name=水 时：\n",(0,t.jsx)("img",{src:o,alt:""})]}),"\n",(0,t.jsx)(e.p,{children:"然后我们在前端代码里调用下："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:c,alt:""})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"export async function list(name: string) {\n    return await axiosInstance.get('/book/list', {\n        params: {\n            name\n        }\n    });\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:r,alt:""})}),"\n",(0,t.jsx)(e.p,{children:"当 form 提交的时候，修改 name 的 state，然后 name 的 state 改变触发重新搜索。"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:'import { Button, Card, Form, Input, message } from \'antd\';\nimport \'./index.css\';\nimport { useEffect, useState } from \'react\';\nimport { list } from \'../../interfaces\';\n\ninterface Book {\n    id: number;\n    name: string;\n    author: string;\n    description: string;\n    cover: string;\n}\n\nexport function BookManage(){\n\n    const [bookList, setBookList] = useState<Array<Book>>([]);\n    const [name, setName] = useState(\'\');\n\n    async function fetchData() {\n        try {\n            const data = await list(name);\n            \n            if(data.status === 201 || data.status === 200) {\n                setBookList(data.data);\n            }\n        } catch(e: any) {\n            message.error(e.response.data.message);\n        }\n    }\n\n    useEffect(() => {\n        fetchData();\n    }, [name]);\n\n    async function searchBook(values: { name: string}) {\n        setName(values.name);\n    }\n\n    return <div id="bookManage">\n        <h1>图书管理系统</h1>\n        <div className="content">\n            <div className=\'book-search\'>\n                <Form\n                    onFinish={searchBook}\n                    name="search"\n                    layout=\'inline\'\n                    colon={false}\n                >\n                    <Form.Item label="图书名称" name="name">\n                        <Input />\n                    </Form.Item>\n                    <Form.Item label=" ">\n                        <Button type="primary" htmlType="submit">\n                            搜索图书\n                        </Button>\n                        <Button type="primary" htmlType="submit" style={{background: \'green\'}} >\n                            添加图书\n                        </Button>\n                    </Form.Item>\n                </Form>\n            </div>\n            <div className="book-list">\n                {\n                    bookList.map(book => {\n                        return <Card\n                            className=\'card\'\n                            hoverable\n                            style={{ width: 300 }}\n                            cover={<img alt="example" src={`http://localhost:3000/${book.cover}`} />}\n                        >\n                            <h2>{book.name}</h2>\n                            <div>{book.author}</div>\n                            <div className=\'links\'>\n                                <a href="#">详情</a>\n                                <a href="#">编辑</a>\n                                <a href="#">删除</a>\n                            </div>\n                        </Card>\n                    })\n                }    \n            </div>\n        </div>\n    </div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"测试下："}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)("img",{src:i,alt:""})}),"\n",(0,t.jsxs)(e.p,{children:["案例代码上传了",(0,t.jsx)(e.a,{href:"https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/book-management-system-frontend/",target:"_blank",rel:"noopener noreferrer",children:"小册仓库"})]}),"\n",(0,t.jsxs)(e.h2,{id:"总结",children:["总结",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,t.jsx)(e.p,{children:"这节我们新增了图书列表页面，改造了 /book/list 接口支持搜索，然后在前端项目调用，实现了图书列表和搜索。"}),"\n",(0,t.jsx)(e.p,{children:"下节我们继续实现增删改的功能。"})]})}function y(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,s.ah)(),n.components);return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(B,{...n})}):B(n)}let E=y;y.__RSPRESS_PAGE_META={},y.__RSPRESS_PAGE_META["Nest%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%20%20%E6%9C%80%E6%96%B0200%E7%AB%A0%2F31.%20%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%9A%E5%9B%BE%E4%B9%A6%E6%A8%A1%E5%9D%97%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91--%E5%9B%BE%E4%B9%A6%E6%90%9C%E7%B4%A2.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"31. 图书管理系统：图书模块前端开发--图书搜索",headingTitle:"31. 图书管理系统：图书模块前端开发--图书搜索",frontmatter:{}}}}]);