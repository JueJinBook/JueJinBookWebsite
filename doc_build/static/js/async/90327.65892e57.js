"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["90327"],{719079:function(e,n,r){r.r(n),r.d(n,{default:()=>C});var A=r(552676),s=r(740453);let d=r.p+"static/image/4bbfe42aac71893709ed7ecc72832aec.eb469c89.webp",i=r.p+"static/image/c5f7466c0f2afe060f3fbd63a2adb726.80dac28a.webp",c=r.p+"static/image/30e20311e3a0ea0fb8b1f9c04a1425a0.53489d72.webp",t=r.p+"static/image/c17096bce8239e02f6155e35a284bcc2.9573c295.webp",h=r.p+"static/image/33bb1c2122b5d8f85583d3e709fd386c.5c926d6d.webp",l=r.p+"static/image/6aaab4f34b9f2220944f2f52f112169a.edcd7dac.webp",a=r.p+"static/image/281033e6c04d956b97950e8676d36df3.23f370dd.webp",p=r.p+"static/image/483e049f412d31fdc4a6f99092c298be.8d15324e.webp",x=r.p+"static/image/d02b6635310912eddd8d1e9787a6a5e0.6bfcc45e.webp",j=r.p+"static/image/d64e83a98d71a09024f9df3543deae27.05dc328f.webp",g=r.p+"static/image/1087939a4ff1ff585972d518b95d5361.5d81a636.webp",u=r.p+"static/image/1fc0af05cb09a1c409dc2823873087da.bb236e0d.webp",o=r.p+"static/image/d852c851bb39911aba473f141b55e8bd.5be34b15.webp";function m(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",img:"img",strong:"strong",h3:"h3",pre:"pre",code:"code",em:"em"},(0,s.ah)(),e.components);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(n.h1,{id:"8套路四数组长度做计数",children:["8.套路四：数组长度做计数",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#8套路四数组长度做计数",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"类型系统不是图灵完备，各种逻辑都能写么，但好像没发现数值相关的逻辑。"}),"\n",(0,A.jsx)(n.p,{children:"没错，数值相关的逻辑比较绕，被我单独摘了出来，就是这节要讲的内容。"}),"\n",(0,A.jsx)(n.p,{children:"这是类型体操的第四个套路：数组长度做计数。"}),"\n",(0,A.jsxs)(n.h2,{id:"数组长度做计数",children:["数组长度做计数",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#数组长度做计数",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"TypeScript 类型系统没有加减乘除运算符，怎么做数值运算呢？"}),"\n",(0,A.jsx)(n.p,{children:"不知道大家有没有注意到数组类型取 length 就是数值。"}),"\n",(0,A.jsx)(n.p,{children:"比如："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:o,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:u,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"而数组类型我们是能构造出来的，那么通过构造不同长度的数组然后取 length，不就是数值的运算么？"}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.strong,{children:"TypeScript 类型系统中没有加减乘除运算符，但是可以通过构造不同的数组然后取 length 的方式来完成数值计算，把数值的加减乘除转化为对数组的提取和构造。"})}),"\n",(0,A.jsx)(n.p,{children:"(严格来说构造的是元组，大家知道数组和元组的区别就行)"}),"\n",(0,A.jsx)(n.p,{children:"这点可以说是类型体操中最麻烦的一个点，需要思维做一些转换，绕过这个弯来。"}),"\n",(0,A.jsx)(n.p,{children:"下面我们就来做一些真实的案例来掌握它吧。"}),"\n",(0,A.jsxs)(n.h2,{id:"数组长度实现加减乘除",children:["数组长度实现加减乘除",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#数组长度实现加减乘除",children:"#"})]}),"\n",(0,A.jsxs)(n.h3,{id:"add",children:["Add",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#add",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"我们知道了数值计算要转换为对数组类型的操作，那么加法的实现很容易想到："}),"\n",(0,A.jsx)(n.p,{children:"构造两个数组，然后合并成一个，取 length。"}),"\n",(0,A.jsx)(n.p,{children:"比如 3 + 2，就是构造一个长度为 3 的数组类型，再构造一个长度为 2 的数组类型，然后合并成一个数组，取 length。"}),"\n",(0,A.jsx)(n.p,{children:"构造多长的数组是不确定的，需要递归构造，这个我们实现过："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type BuildArray<\n    Length extends number, \n    Ele = unknown, \n    Arr extends unknown[] = []\n> = Arr['length'] extends Length \n        ? Arr \n        : BuildArray<Length, Ele, [...Arr, Ele]>;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Length 是要构造的数组的长度。类型参数 Ele 是数组元素，默认为 unknown。类型参数 Arr 为构造出的数组，默认是 []。"}),"\n",(0,A.jsx)(n.p,{children:"如果 Arr 的长度到达了 Length，就返回构造出的 Arr，否则继续递归构造。"}),"\n",(0,A.jsx)(n.p,{children:"构造数组实现了，那么基于它就能实现加法："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type Add<Num1 extends number, Num2 extends number> = \n    [...BuildArray<Num1>,...BuildArray<Num2>]['length'];\n"})}),"\n",(0,A.jsx)(n.p,{children:"我们拿大一点的数测试下："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:g,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"结果是对的。"}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCCAnDBDEAeAKCmKgBkIA7Ac2AAsoIAPYSlAZygrgFsAjCDABooREgFEk0ALxQ4FANYUA9gHcKw0cUwYGzVhzmLVFANoBdKDPMEAfJajaTAcknU6Ti0xYV2ZSjXpNEmIAfgcsEWDggC5YRFRtXDxyN1phCQhhEwA6XO10yTMbAG4CMtBIBxQUPAA5HgBGXW9fLj4BYXruACZm-U4efgw7GSCc3PhkdCwkroabQVzsyYSZ-C7umzNnVwCPUvLwaDRqgCUINjgkYHsTmoBmbuFugFYSoA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsx)(n.p,{children:"就这样，我们通过构造一定长度的数组取 length 的方式实现了加法运算。"}),"\n",(0,A.jsxs)(n.h3,{id:"subtract",children:["Subtract",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#subtract",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"加法是构造数组，那减法怎么做呢？"}),"\n",(0,A.jsx)(n.p,{children:"减法是从数值中去掉一部分，很容易想到可以通过数组类型的提取来做。"}),"\n",(0,A.jsx)(n.p,{children:"比如 3 是 [unknown, unknown, unknown] 的数组类型，提取出 2 个元素之后，剩下的数组再取 length 就是 1。"}),"\n",(0,A.jsx)(n.p,{children:"所以减法的实现是这样的："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type Subtract<Num1 extends number, Num2 extends number> = \n    BuildArray<Num1> extends [...arr1: BuildArray<Num2>, ...arr2: infer Rest]\n        ? Rest['length']\n        : never;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Num1、Num2 分别是被减数和减数，通过 extends 约束为 number。"}),"\n",(0,A.jsx)(n.p,{children:"构造 Num1 长度的数组，通过模式匹配提取出 Num2 长度个元素，剩下的放到 infer 声明的局部变量 Rest 里。"}),"\n",(0,A.jsx)(n.p,{children:"取 Rest 的长度返回，就是减法的结果。"}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:j,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCCAnDBDEAeAKCmKgBkIA7Ac2AAsoIAPYSlAZygrgFsAjCDABooREgFEk0ALxQ4FANYUA9gHcKw0cUwYGzVhzmLVFANoBdKDPMEAfJajaTAcknU6Ti0xYV2ZSjXpNEmIAfgcsEWDggC5YRFRtXDxyN1phCQhhEwA6XO10yTMbAG4CAlBIKABlOF5gHABjYDwAOR4ARl1vXy4+AWE27gAmLv1OHn4MOxkg+GR0LCTB9rsvMZzc7Cx22LmExfxBoZthXOytjCHYhAoAMwEoACUINmAzIOCw59fnVwCPD4kWIUCAANwEpTKFWgNTqjWA3zgSGA9lh9WwTTwAGYscJ2sdSkA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsx)(n.p,{children:"就这样，我们通过数组类型的提取实现了减法运算。"}),"\n",(0,A.jsx)(n.p,{children:"有同学可能会问，后面那部分需要 infer 提取，所以起个 arr2 的名字没问题。前面那部分不需要名字呀，可以去掉 arr1 么？"}),"\n",(0,A.jsx)(n.p,{children:"试一下就知道了："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:x,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"报错显示元组成员或者全部有名字，或者全部没有。"}),"\n",(0,A.jsxs)(n.h3,{id:"multiply",children:["Multiply",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#multiply",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"我们把加法转换为了数组构造，把减法转换为了数组提取。那乘法怎么做呢？"}),"\n",(0,A.jsx)(n.p,{children:"为了解释乘法，我去翻了下小学教材，找到了这样一张图："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:p,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"1 乘以 5 就相当于 1 + 1 + 1 + 1 + 1，也就是说乘法就是多个加法结果的累加。"}),"\n",(0,A.jsx)(n.p,{children:"那么我们在加法的基础上，多加一个参数来传递中间结果的数组，算完之后再取一次 length 就能实现乘法："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type Mutiply<\n    Num1 extends number,\n    Num2 extends number,\n    ResultArr extends unknown[] = []\n> = Num2 extends 0 ? ResultArr['length']\n        : Mutiply<Num1, Subtract<Num2, 1>, [...BuildArray<Num1>, ...ResultArr]>;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Num1 和 Num2 分别是被加数和加数。"}),"\n",(0,A.jsx)(n.p,{children:"因为乘法是多个加法结果的累加，我们加了一个类型参数 ResultArr 来保存中间结果，默认值是 []，相当于从 0 开始加。"}),"\n",(0,A.jsx)(n.p,{children:"每加一次就把 Num2 减一，直到 Num2 为 0，就代表加完了。"}),"\n",(0,A.jsx)(n.p,{children:"加的过程就是往 ResultArr 数组中放 Num1 个元素。"}),"\n",(0,A.jsx)(n.p,{children:"这样递归的进行累加，也就是递归的往 ResultArr 中放元素。"}),"\n",(0,A.jsx)(n.p,{children:"最后取 ResultArr 的 length 就是乘法的结果。"}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:a,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCCAnDBDEAeAKCmKgBkIA7Ac2AAsoIAPYSlAZygrgFsAjCDABooREgFEk0ALxQ4FANYUA9gHcKw0cUwYGzVhzmLVFANoBdKDPMEAfJajaTAcknU6Ti0xYV2ZSjXpNEmIAfgcsEWDggC5YRFRtXDxyN1phCQhhEwA6XO10yTMbAG4CAlBIKABlOF5gHABjYDwAOR4ARl1vXy4+AWE27gAmLv1OHn4MOxkg+GR0LCTB9rsvMZzc7Cx22LmExfxBoZthXOytjCHYhAoAMwEoACUINmAzIOCw59fnVwCPD4kWIUCAANwEpXK4GgAFk4MAEGAkIcOqMfBxepMBjwRmt0eM+kIni84EhgGjfIZlGpzPZzNMgkcKRwAAxQL4ksm-fzud5RIFQOEIpEo7jtYQ1OqNZpHYQrLJnPYLHCi+VQM7fUlvEplMoVWHwxHIzVk+xCo34ADMwiGtpKQA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsx)(n.p,{children:"就这样，我们通过递归的累加实现了乘法。"}),"\n",(0,A.jsxs)(n.h3,{id:"divide",children:["Divide",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#divide",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"乘法是递归的累加，那除法不就是递归的累减么？"}),"\n",(0,A.jsx)(n.p,{children:"我再去翻了下小学教材，找到了这样一张图："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:l,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"我们有 9 个苹果，分给美羊羊 3 个，分给懒羊羊 3 个，分给沸羊羊 3 个，最后剩下 0 个。所以 9 / 3 = 3。"}),"\n",(0,A.jsx)(n.p,{children:"所以，除法的实现就是被减数不断减去减数，直到减为 0，记录减了几次就是结果。"}),"\n",(0,A.jsx)(n.p,{children:"也就是这样的："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type Divide<\n    Num1 extends number,\n    Num2 extends number,\n    CountArr extends unknown[] = []\n> = Num1 extends 0 ? CountArr['length']\n        : Divide<Subtract<Num1, Num2>, Num2, [unknown, ...CountArr]>;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Num1 和 Num2 分别是被减数和减数。"}),"\n",(0,A.jsx)(n.p,{children:"类型参数 CountArr 是用来记录减了几次的累加数组。"}),"\n",(0,A.jsx)(n.p,{children:"如果 Num1 减到了 0 ，那么这时候减了几次就是除法结果，也就是 CountArr['length']。"}),"\n",(0,A.jsx)(n.p,{children:"否则继续递归的减，让 Num1 减去 Num2，并且 CountArr 多加一个元素代表又减了一次。"}),"\n",(0,A.jsx)(n.p,{children:"这样就实现了除法："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:h,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCCAnDBDEAeAKCmKgBkIA7Ac2AAsoIAPYSlAZygrgFsAjCDABooREgFEk0ALxQ4FANYUA9gHcKw0cUwYGzVhzmLVFANoBdKDPMEAfJajaTAcknU6Ti0xYV2ZSjXpNEmIAfgcsEWDggC5YRFRtXDxyN1phCQhhEwA6XO10yTMbAG4CMtBIKABlOF5gHABjYDwAOR4ARl1vXy4+AWE27gAmLv1OHn4MOxkg+GR0LCTB9rsvMZzc7Cx22LmExfxBoZthXOytjCHYhAoAMwEoACUINmAzIOCw59fnVwCPD4kWIUCAANwEpXK4GgABEEKCECgIK0OqMfBxepMBjwRmt0eM+kIoABhJRyYDaNG+QzKNTmezmaZBZZUjgABigYVJ5McLn87neUSBUDhCKReBqdUazWW2OGJygRyyNOMp1y3IoFKwRUhUMqosREG+cCQwHsBvFAGY2cIAKwlMpAA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsx)(n.p,{children:"就这样，我们通过递归的累减并记录减了几次实现了除法。"}),"\n",(0,A.jsx)(n.p,{children:"做完了加减乘除，我们再来做一些别的数值计算的类型体操。"}),"\n",(0,A.jsxs)(n.h2,{id:"数组长度实现计数",children:["数组长度实现计数",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#数组长度实现计数",children:"#"})]}),"\n",(0,A.jsxs)(n.h3,{id:"strlen",children:["StrLen",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#strlen",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"数组长度可以取 length 来得到，但是字符串类型不能取 length，所以我们来实现一个求字符串长度的高级类型。"}),"\n",(0,A.jsx)(n.p,{children:"字符串长度不确定，明显要用递归。每次取一个并计数，直到取完，就是字符串长度。"}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type StrLen<\n    Str extends string,\n    CountArr extends unknown[] = []\n> = Str extends `${string}${infer Rest}` \n    ? StrLen<Rest, [...CountArr, unknown]> \n    : CountArr['length']\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Str 是待处理的字符串。类型参数 CountArr 是做计数的数组，默认值 [] 代表从 0 开始。"}),"\n",(0,A.jsx)(n.p,{children:"每次通过模式匹配提取去掉一个字符之后的剩余字符串，并且往计数数组里多放入一个元素。递归进行取字符和计数。"}),"\n",(0,A.jsx)(n.p,{children:"如果模式匹配不满足，代表计数结束，返回计数数组的长度 CountArr['length']。"}),"\n",(0,A.jsx)(n.p,{children:"这样就能求出字符串长度："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:t,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/C4TwDgpgBAysBOAZCA7APAKCt2CoQA9hUATAZyjIQEsUBzAGixwGEB7AVxWAEF558RUhS4BrFGwDuKANoBdKAF4o8jAD4luAYWIpyUAAYASAN5V4tOgF9TtAGYQBAJQhUrBqAH4tydC6oMKgB0IexcvPyBYhLSchoAXFBh3HzwMgDkADaodMAAFulyGMUYoJA+qP4cmcCacEioaOkAEhCZmWxQAOps8Jkk6WoA3EA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsxs)(n.h3,{id:"greaterthan",children:["GreaterThan",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#greaterthan",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"能够做计数了，那也就能做两个数值的比较。"}),"\n",(0,A.jsx)(n.p,{children:"我们往一个数组类型中不断放入元素取长度，如果先到了 A，那就是 B 大，否则是 A 大："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type GreaterThan<\n    Num1 extends number,\n    Num2 extends number,\n    CountArr extends unknown[] = []\n> = Num1 extends Num2 \n    ? false\n    : CountArr['length'] extends Num2\n        ? true\n        : CountArr['length'] extends Num1\n            ? false\n            : GreaterThan<Num1, Num2, [...CountArr, unknown]>;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Num1 和 Num2 是待比较的两个数。"}),"\n",(0,A.jsx)(n.p,{children:"类型参数 CountArr 是计数用的，会不断累加，默认值是 [] 代表从 0 开始。"}),"\n",(0,A.jsx)(n.p,{children:"如果 Num1 extends Num2 成立，代表相等，直接返回 false。"}),"\n",(0,A.jsx)(n.p,{children:"否则判断计数数组的长度，如果先到了 Num2，那么就是 Num1 大，返回 true。"}),"\n",(0,A.jsx)(n.p,{children:"反之，如果先到了 Num1，那么就是 Num2 大，返回 false。"}),"\n",(0,A.jsx)(n.p,{children:"如果都没到就往计数数组 CountArr 中放入一个元素，继续递归。"}),"\n",(0,A.jsx)(n.p,{children:"这样就实现了数值比较。"}),"\n",(0,A.jsx)(n.p,{children:"当 3 和 4 比较时："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:c,alt:""})}),"\n",(0,A.jsx)(n.p,{children:"当 6 和 4 比较时："}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)("img",{src:i,alt:""})}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/FAFwngDgpgBA4gJygQxFBAVAFsgdgHmBmJgDkBXAWwEYYoAPNXAEwGcZcqAjdAGiJIVKAJjqMoLdp0o8E-EjADCAe3K4QAQQQIxTNjDUBrXMoDuuANoBdGAF4Y14AD47ZKrQZ72Q0QOIB+GAAzZAAbVig-GAAuJVV1LQQLAHJQiQBzECxkm08JfR8ohUCQBHJIhQVYlTVNbRS03Ezs3PFJNxoiyoDgsIiu7tjEFDRMHAIhal4O4WmLADpFmoTtaaMTcysnAG5gPfBoeCRUdGw8ACUoVnJQkFdhk7G8fABmaYAWHf3IWAfRs9wl2ut1E9j+p3G+AAbB8dkA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsxs)(n.h3,{id:"fibonacci",children:["Fibonacci",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#fibonacci",children:"#"})]}),"\n",(0,A.jsx)(n.p,{children:"谈到了数值运算，就不得不提起经典的 Fibonacci 数列的计算。"}),"\n",(0,A.jsx)(n.p,{children:"Fibonacci 数列是 1、1、2、3、5、8、13、21、34、…… 这样的数列，有当前的数是前两个数的和的规律。"}),"\n",(0,A.jsxs)(n.p,{children:[(0,A.jsx)(n.em,{children:"F"}),"(0) = 1，",(0,A.jsx)(n.em,{children:"F"}),"(1) = 1,\xa0",(0,A.jsx)(n.em,{children:"F"}),"(n) = ",(0,A.jsx)(n.em,{children:"F"}),"(n - 1) + ",(0,A.jsx)(n.em,{children:"F"}),"(n - 2)（",(0,A.jsx)(n.em,{children:"n"})," ≥ 2，",(0,A.jsx)(n.em,{children:"n"})," ∈ N*）"]}),"\n",(0,A.jsx)(n.p,{children:"也就是递归的加法，在 TypeScript 类型编程里用构造数组来实现这种加法："}),"\n",(0,A.jsx)(n.pre,{children:(0,A.jsx)(n.code,{className:"language-typescript",children:"type FibonacciLoop<\n    PrevArr extends unknown[], \n    CurrentArr extends unknown[], \n    IndexArr extends unknown[] = [], \n    Num extends number = 1\n> = IndexArr['length'] extends Num\n    ? CurrentArr['length']\n    : FibonacciLoop<CurrentArr, [...PrevArr, ...CurrentArr], [...IndexArr, unknown], Num> \n\ntype Fibonacci<Num extends number> = FibonacciLoop<[1], [], [], Num>;\n"})}),"\n",(0,A.jsx)(n.p,{children:"类型参数 PrevArr 是代表之前的累加值的数组。类型参数 CurrentArr 是代表当前数值的数组。"}),"\n",(0,A.jsx)(n.p,{children:"类型参数 IndexArr 用于记录 index，每次递归加一，默认值是 []，代表从 0 开始。"}),"\n",(0,A.jsx)(n.p,{children:"类型参数 Num 代表求数列的第几个数。"}),"\n",(0,A.jsx)(n.p,{children:"判断当前 index 也就是 IndexArr['length'] 是否到了 Num，到了就返回当前的数值 CurrentArr['length']。"}),"\n",(0,A.jsx)(n.p,{children:"否则求出当前 index 对应的数值，用之前的数加上当前的数 [...PrevArr, ... CurrentArr]。"}),"\n",(0,A.jsx)(n.p,{children:"然后继续递归，index + 1，也就是 [...IndexArr, unknown]。"}),"\n",(0,A.jsx)(n.p,{children:"这就是递归计算 Fibinacci 数列的数的过程。"}),"\n",(0,A.jsxs)(n.p,{children:["可以正确的算出第 8 个数是 21:\n",(0,A.jsx)("img",{src:d,alt:""})]}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/FAFwngDgpgBAYgSwEYHsB2BDAxlhAZFFCAHmBnJgAUAnKANwEFrqYoAPEKNAEwGcYArmgDWaFAHc0AbQC6AGhhkKAYQHMuIJi3ace-IaInT5iijACSPdltYcufQSLGTZMALwxZCpeQByAgFtbXQc0QKQoFg8ARmAAPncLKzYtKQByABsuAHMQAAs0mWD7fn8AnxgAfhhVdTRNZnSstFyCmQqALnhkdGxcAiJiWtp6rQUpADopmnoxmCmJ4Y0tE0mpy25rZgUDZzQTMoTgUEhYRFRMHARiMuK9GDCAiOoEj3Peq4GSKWjVv4VDgBuY7AAD0oJg0UAgAzQgBMUIAzFCAKxQgAcMKRsOhCIALCdoN0Ln0EAAlKC8AQZECJd6XXDENFxQFAA",target:"_blank",rel:"noopener noreferrer",children:"试一下"})}),"\n",(0,A.jsxs)(n.h2,{id:"总结",children:["总结",(0,A.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,A.jsxs)(n.p,{children:["TypeScript 类型系统没有加减乘除运算符，所以我们",(0,A.jsx)(n.strong,{children:"通过数组类型的构造和提取，然后取长度的方式来实现数值运算"}),"。"]}),"\n",(0,A.jsx)(n.p,{children:"我们通过构造和提取数组类型实现了加减乘除，也实现了各种计数逻辑。"}),"\n",(0,A.jsx)(n.p,{children:"用数组长度做计数这一点是 TypeScript 类型体操中最麻烦的一个点，也是最容易让新手困惑的一个点。"}),"\n",(0,A.jsx)(n.p,{children:(0,A.jsx)(n.a,{href:"https://www.typescriptlang.org/play?#code/PTAEEEBNIKAFwJ4AcCmoBCBXAlgG0uAE6ECGCAPDKNaADIoB2A5nABagoAecjkAzqAaYAtgCMUhADSgqNAKK40AXlCYGAawYB7AO4Nps6kUIduvAWs26GAbQC6oFfZgA+RxGI2A5IuZsvDlw8DPx0jCzshjTUAPweJlHRAFwYOPjGZOT0fqzSCijSNgB0JcZ5inYuANwwtYioENDkAHIiAIymwaFCYhLSrcIATJ3mgiLihG4qUcUlWHgExJkDbS6SJUXz6UsUA4Mudt6+EQE1dchoUJAASih8mLhw7lfkAMyD0oMArNW1MCCgADKmFEcFIAGM4PALkCQWCSJCWu0RiEBD0Jv0RMMgqN0RIpjJoltFqRdu03DjUaBZkUSMQ2iliRkyUM1qANnTCIMUtgGAAzCSgW58OB2RI0OLCuBHcL+MXRZKCFAANwkZ3qaGBoIhcGFDyeKi18MRr1e0ja+zOAIAsvrsEhcAhoQ1bXB7Y6kcIOpTuuM+qA9ijfb0pEK7vqgxYNNo9PZ3PYplFAz6BAAGUCS8OPGU5ALi6gpV3ulltaRGnWej6gVaFDZMnaemvskp6x6VdUwosOhCtg2gLses2gQYj37-MAAEWwyuwkBQzrQU5nc8bkbGIcxQzXeNDAGEtGo4MY15YY7YHE5Ko4k8iU6B03F94fjDmTvKFQXQEvZyhyOWEXAjabvswGFKe1jSBsT4MEexDtucDTfnOvbuEhv6vKm0g-Gc45AmC2QLnhhDZJQ0SAmCa4ioQvJMJIUTQbBJh3uBsYXtSYoEuRTFmFSAAGAAkADeVE0QAvkJvICiYUqibxGZESRUq1iUDFlKo0bWFeKSqZ4PiyqweaEVx2QoYa+GMOQXgABIoLguBaKAADqWiEPgXhjrhADihAoCQPCEAAKqwJAMIR3m+f5QUhaRNArNufpSDeW53judHRDp3FdFGVisfGHHuHFd6BlEcR8iQuB8POioZa+cprns+byWCmBVR+oDaQeMEvnpuaBDxoQrI10SleVlVDTQKThX5EhRQwQEBliylFBl0gsQw8EIWgU2RcFDCmaA20zbtbzSAALGOGoHT502BbtvbDCoh23dFABsZ1jgCABi2CiFoDAIuC2CEd9v3-eCgO0FoWhIDF1AAAo+cqx7MRprEGOlmDEIwjEnqj57ozQACSIRcMj-XZWecaXgT1ADPFIbuG0rjuMTc6cN1xx1UVIglaAu6Yz5XW6ZzBnvp+IN-QD2CQ9D5D81jQuhjSCMqmpUEC9jxh2EtrOk8Qq149rC3CG4m2gBLYOA569MTASFtSzLMM2G0Rv2IURsDB5AJtIAgAy+4MPuvD7Xw+wAHH7QeDL7ryncDP2S+D2D7fbifkKH1RAA",target:"_blank",rel:"noopener noreferrer",children:"本文案例的合并"})})]})}function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,A.jsx)(n,{...e,children:(0,A.jsx)(m,{...e})}):m(e)}let C=B;B.__RSPRESS_PAGE_META={},B.__RSPRESS_PAGE_META["TypeScript%20%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F8.%E5%A5%97%E8%B7%AF%E5%9B%9B%EF%BC%9A%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6%E5%81%9A%E8%AE%A1%E6%95%B0.md"]={toc:[{text:"数组长度做计数",id:"数组长度做计数",depth:2},{text:"数组长度实现加减乘除",id:"数组长度实现加减乘除",depth:2},{text:"Add",id:"add",depth:3},{text:"Subtract",id:"subtract",depth:3},{text:"Multiply",id:"multiply",depth:3},{text:"Divide",id:"divide",depth:3},{text:"数组长度实现计数",id:"数组长度实现计数",depth:2},{text:"StrLen",id:"strlen",depth:3},{text:"GreaterThan",id:"greaterthan",depth:3},{text:"Fibonacci",id:"fibonacci",depth:3},{text:"总结",id:"总结",depth:2}],title:"8.套路四：数组长度做计数",headingTitle:"8.套路四：数组长度做计数",frontmatter:{}}}}]);