"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["65318"],{785123:function(e,c,n){n.r(c),n.d(c,{default:()=>D});var d=n(552676),s=n(740453);let i=n.p+"static/image/314c66d09fa6a3df48faf357dc87ba75.eee632e0.webp",r=n.p+"static/image/30222e1dd8619b11c3dc068f3de0a76e.251b475d.webp",p=n.p+"static/image/2068ac05834994426396c0c040ee2947.f453f8e4.webp",a=n.p+"static/image/5c2d12f062b40fa8e8b142cf4e7050d4.b174bf54.webp",o=n.p+"static/image/07b1356f995b2877b77dc5e25c7bde27.1c635dbe.webp",l=n.p+"static/image/686dc26794b3089d57588b0f49cf5646.33396a5c.webp",t=n.p+"static/image/f328cbe6f783214c8e49dffb9d9a4466.1e01ca38.webp",j=n.p+"static/image/bc35a0086479f385df5675fcbbeb8e83.34cdc5e9.webp",h=n.p+"static/image/f3968a5d20b9077cd3a522ebc1aaddad.bf57446d.webp",x=n.p+"static/image/db479820fda8b5302d19f0974ab5cf30.43e95949.webp",b=n.p+"static/image/f265616ec774f5bcf2a60423ca190cab.0df32861.webp",m=n.p+"static/image/9e5d8ec46c1bfa7633a29f74628783b8.29a05b6b.webp",f=n.p+"static/image/afd13e60ca16ef3be2f73d8ac4ebb04b.d00dc11d.webp",g=n.p+"static/image/d3599947d5da97ce529554e64eaa1147.26b720bb.webp",u=n.p+"static/image/dbdc228bbed681d8840257d138763f69.5d74ad99.webp",w=n.p+"static/image/fbf013d1318373c1243bd1d643e1f6d0.17c3a296.webp",E=n.p+"static/image/ef1d511a3b4f6b90cc16eecb75d69c1e.308b0a41.webp",A=n.p+"static/image/72855a8978ad99a0d37df87d1de840cf.6f002e1b.webp",v=n.p+"static/image/a2a90a58ef586e0f076b9f37d5927dbd.4fd1681b.webp",M=n.p+"static/image/12d7fbb3d1db66d59a68e7cfd2e0c0ef.41fdf463.webp",_=n.p+"static/image/14eb1c7035b9d1d30e6918749a6d3699.8938867d.webp",k=n.p+"static/image/dd06b544c3c47a33fad13495f41d5010.b35cbe74.webp",S=n.p+"static/image/19467e50b62add6ad7918feab69a1236.0ef818cc.webp";function B(e){let c=Object.assign({h1:"h1",a:"a",p:"p",pre:"pre",code:"code",img:"img",h2:"h2"},(0,s.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(c.h1,{id:"88-使用-compodoc-生成文档",children:["88. 使用 compodoc 生成文档",(0,d.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#88-使用-compodoc-生成文档",children:"#"})]}),"\n",(0,d.jsx)(c.p,{children:"Nest 项目会有很多模块，模块之间相互依赖，模块内有 controller、service 等。"}),"\n",(0,d.jsx)(c.p,{children:"当项目复杂之后，模块之间的关系错综复杂。"}),"\n",(0,d.jsx)(c.p,{children:"这时候我们可以用 compodoc 生成一份文档，把依赖关系可视化。"}),"\n",(0,d.jsx)(c.p,{children:"compodoc 本来是给 angular 项目生成项目文档的，但是因为 angular 和 nest 项目结构类似，所以也支持了 nest。"}),"\n",(0,d.jsx)(c.p,{children:"我们创建个项目："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"nest new compodoc-test\n"})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:S,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"安装 compodoc："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npm install --save-dev @compodoc/compodoc\n"})}),"\n",(0,d.jsx)(c.p,{children:"然后生成一份文档："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npx @compodoc/compodoc -p tsconfig.json -s -o\n"})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:k,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"这个 README 就是项目下的 README.md:"}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:_,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"改一下 READMD.md，然后重新执行命令生成："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:M,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"可以看到页面上的也变了："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:v,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"overview 部分上面是依赖图，下面是项目有几个模块、controller，可注入的 provider"}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:A,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"我们在项目下加几个模块："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"nest g resource aaa\n\nnest g resource bbb\n"})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:E,alt:""})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:w,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"在 AaaModule 里把 AaaService 导出："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:u,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"然后 BbbModule 引入 AaaModule："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:g,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"在 BbbService 里注入 AaaService："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:f,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"先跑起来看一下："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npm run start:dev\n"})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:m,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"没啥问题："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:b,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"类似这种依赖关系，compodoc 可视化之后是什么样的呢？"}),"\n",(0,d.jsx)(c.p,{children:"重新跑一下 compodoc："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npx @compodoc/compodoc -p tsconfig.json -s -o\n"})}),"\n",(0,d.jsx)(c.p,{children:"依赖可视化是这样的："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:x,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"用不同的颜色表示 Module、Provider、Exports 等。"}),"\n",(0,d.jsx)(c.p,{children:"可以看到 AppModule 引入了 AaaModule、BbbModule。"}),"\n",(0,d.jsx)(c.p,{children:"AaaModule 导出了 AaaService。"}),"\n",(0,d.jsx)(c.p,{children:"以及每个模块的 provider。"}),"\n",(0,d.jsx)(c.p,{children:"都可以可视化的看到。"}),"\n",(0,d.jsx)(c.p,{children:"点击左侧的 Modules，可以看到每个模块的可视化分析："}),"\n",(0,d.jsx)(c.p,{children:"AaaModule："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:h,alt:""})}),"\n",(0,d.jsxs)(c.p,{children:["BbbModule：\n",(0,d.jsx)("img",{src:j,alt:""})]}),"\n",(0,d.jsx)(c.p,{children:"AppModule："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:t,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"当然，我们这个例子还是比较简单，当项目依赖复杂之后，这个可视化还是比较有用的。"}),"\n",(0,d.jsx)(c.p,{children:"此外，可以看到每个 Controller、Service 或者其他的 class 的属性、方法，点进去可以看到方法的参数、返回值等："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:l,alt:""})}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:o,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"当新人接手这个项目的时候，可以通过这份文档快速了解项目的结构。"}),"\n",(0,d.jsx)(c.p,{children:"回过头来，我们看下 compodoc 的一些 cli 选项："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npx @compodoc/compodoc -p tsconfig.json -s -o\n"})}),"\n",(0,d.jsx)(c.p,{children:"-p 是指定 tsconfig 文件"}),"\n",(0,d.jsx)(c.p,{children:"-s 是启动静态服务器"}),"\n",(0,d.jsx)(c.p,{children:"-o 是打开浏览器"}),"\n",(0,d.jsxs)(c.p,{children:["更多选项在 ",(0,d.jsx)(c.a,{href:"https://compodoc.app/guides/options.html",target:"_blank",rel:"noopener noreferrer",children:"compodoc 文档"}),"里可以看到:"]}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:a,alt:"image.png"})}),"\n",(0,d.jsx)(c.p,{children:"比如 --theme 可以指定主题，一共有 gitbook,aravel, original, material, postmark, readthedocs, stripe, vagrant 这 8 个主题："}),"\n",(0,d.jsx)(c.p,{children:"跑一下："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npx @compodoc/compodoc -p tsconfig.json -s -o --theme postmark\n"})}),"\n",(0,d.jsx)(c.p,{children:"可以看到文档主题换了："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:p,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"选项还是挺多的，如果都写在命令行也不现实，compodoc 同样支持配置文件。"}),"\n",(0,d.jsx)(c.p,{children:"我们在项目下添加一个 .compodoc.json 的文件："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{className:"language-json",children:'{\n    "port": 8888,\n    "theme": "postmark"\n}\n'})}),"\n",(0,d.jsx)(c.p,{children:"然后再跑下 compodoc："}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{children:"npx @compodoc/compodoc -p tsconfig.json -s -o -c .compodoc.json\n"})}),"\n",(0,d.jsx)(c.p,{children:"可以看到，配置生效了："}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:r,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"文档里写的这些 cli options，基本都可以写在配置文件里。"}),"\n",(0,d.jsx)(c.p,{children:(0,d.jsx)("img",{src:i,alt:""})}),"\n",(0,d.jsx)(c.p,{children:"不过一般也不咋用配置。"}),"\n",(0,d.jsxs)(c.p,{children:["案例代码上传了",(0,d.jsx)(c.a,{href:"https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/compodoc-test",target:"_blank",rel:"noopener noreferrer",children:"小册仓库"}),"。"]}),"\n",(0,d.jsxs)(c.h2,{id:"总结",children:["总结",(0,d.jsx)(c.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,d.jsx)(c.p,{children:"我们学习了用 compodoc 生成 nest 项目的文档，它会列出项目的模块，可视化展示模块之间的依赖关系，展示每个模块下的 provider、exports 等。"}),"\n",(0,d.jsx)(c.p,{children:"对于新人接手项目来说，还是比较有用的。"}),"\n",(0,d.jsx)(c.p,{children:"而且可视化分析依赖和模块结构，对于复杂项目来说，是比较有帮助的。"}),"\n",(0,d.jsx)(c.p,{children:"compodoc 算是一个不错的 nest 相关的工具。"})]})}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:c}=Object.assign({},(0,s.ah)(),e.components);return c?(0,d.jsx)(c,{...e,children:(0,d.jsx)(B,{...e})}):B(e)}let D=R;R.__RSPRESS_PAGE_META={},R.__RSPRESS_PAGE_META["Nest%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%20%20%E6%9C%80%E6%96%B0200%E7%AB%A0%2F88.%20%E4%BD%BF%E7%94%A8%20compodoc%20%E7%94%9F%E6%88%90%E6%96%87%E6%A1%A3.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"88. 使用 compodoc 生成文档",headingTitle:"88. 使用 compodoc 生成文档",frontmatter:{}}}}]);