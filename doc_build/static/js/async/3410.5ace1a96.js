"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["3410"],{466584:function(e,n,t){t.r(n),t.d(n,{default:()=>m});var s=t(552676),i=t(740453);let l=t.p+"static/image/0cf425bc784b111a1ce7978183252c63.00cfbbab.webp",r=t.p+"static/image/8ed851505fe065e7a55c7474b0e7a984.26afee68.webp",c=t.p+"static/image/4bdd84e6697458d319ff6a9273340c25.7577cb21.webp",d=t.p+"static/image/b1f1d4c7b35fbe4166ab7da9f7d7e283.54eee961.webp",a=t.p+"static/image/cd4e3e0cd2160bc2acbb6a32a071af58.1ac0221b.webp",o=t.p+"static/image/97399bae3375c5e2bda6da40da948ccd.f01d1796.webp",p=t.p+"static/image/ea517fd456b69b6bbf8e1126f98c7a87.50d1ece0.webp",h=t.p+"static/image/e51a796bf84650fb830d6b1856198e9c.5de9e83d.webp",u=t.p+"static/image/4163df0c8232a88485669df7d82d0686.bf2fc46d.webp",x=t.p+"static/image/42d32324ff6a59ae3c3d1926a3a6d021.54f79d18.webp",v=t.p+"static/image/09a91ad6c55fd2d9ed778009142b48d4.db2da809.webp",f=t.p+"static/image/45ec7aad6d833e81072f5a6481172afe.a76ae32d.webp",j=t.p+"static/image/03a00c29d139da42d72897c72ca5057e.09ea6025.webp";function b(e){let n=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",h2:"h2",strong:"strong",code:"code",pre:"pre",img:"img"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"7-语法篇--actions",children:["7-语法篇 ❘ Actions",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#7-语法篇--actions",children:"#"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"推荐学习指数：⭐️️"}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"1-前言",children:["1. 前言",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-前言",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"本篇我们讲解 Svelte 中的重要概念 —— Actions。虽然本身比较简单，但它极大的增强了 Svelte 的功能。简单来说，就是能玩出花儿……本篇我们会举出丰富的例子帮助大家理解 Actions 的作用。"}),"\n",(0,s.jsx)(n.p,{children:"那就让我们来看看怎么使用吧！"}),"\n",(0,s.jsxs)(n.h2,{id:"2-actions-介绍",children:["2. Actions 介绍",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-actions-介绍",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions 是元素级别的生命周期函数。"})," 也就是说，当它搭配 ",(0,s.jsx)(n.code,{children:"use"}),"指令用在 HTML 元素时，可设置该元素的生命周期函数。"]}),"\n",(0,s.jsx)(n.p,{children:"在 Svelte 4 中，其用法如下："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  export let bar;\n\n  function foo(node, bar) {\n    // node 表示元素的引用，bar 是自定义传入的值\n    // 挂载 DOM 的时候执行\n\n    return {\n      update(bar) {\n        // 当 bar 的值改变的时候执行\n      },\n\n      destroy() {\n        // 从 DOM 中移除的时候执行\n      }\n    };\n  }\n<\/script>\n\n<div use:foo={bar} />\n"})}),"\n",(0,s.jsxs)(n.p,{children:["在 Svelte 5 中，原本的写法依然可用，但建议改为使用 ",(0,s.jsx)(n.code,{children:"$effect"}),"："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  function myaction(node) {\n    // node 表示元素的引用，此时节点已挂载到 DOM 中\n\n    $effect(() => {\n      // ...\n      return () => {\n        // 从 DOM 中移除的时候执行\n      };\n    });\n  }\n<\/script>\n\n<div use:foo>...</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:"注意：如果你要获取传入值的更新，这种方式是不可以的："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  function myaction(node, bar) {\n    $effect(() => {\n      console.log(bar)\n    });\n  }\n<\/script>\n\n<div use:foo={bar}>...</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:"你应该改为函数的形式："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  function myaction(node, fn) {\n    $effect(() => {\n      console.log(fn())\n    });\n  }\n<\/script>\n\n<div use:foo={() => (bar)}>...</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:"我们先从最简单的使用例子开始说起："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  let name = 'world';\n\n  function log(node) {\n    console.log(node)\n  }\n<\/script>\n\n<h1 use:log>Hello {name}!</h1>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["我们使用 ",(0,s.jsx)(n.code,{children:"use"}),"指令调用了自定义的 log 函数，这个 log 函数在 Svelte 中就被称为“Action”。"]}),"\n",(0,s.jsxs)(n.p,{children:["该函数会在元素挂载到 DOM 上的时候执行，相当于元素的 ",(0,s.jsx)(n.code,{children:"onMount"})," 函数。函数的第一个参数为 ",(0,s.jsx)(n.code,{children:"node"}),"，表示引用的 DOM 节点。"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/0c06a722cc6343479cb42a3c28222a18?version=5.1.12",title:"https://svelte.dev/playground/0c06a722cc6343479cb42a3c28222a18?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:j,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"我们举个更复杂的例子，包含挂载、更新、销毁："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  let name = $state('world');\n  let checked = $state(true);\n\n  function log(node, fn) {\n    console.log('mounted')\n    $effect(() => {\n      console.log('setup')\n      node.innerHTML = fn()\n      return () => {\n        console.log('teardown')\n      };\n    });\n  }\n<\/script>\n\n<label>\n  <input type=\"checkbox\" bind:checked={checked} />\n  show\n</label>\n\n{#if checked}\n  <figure>\n    <input bind:value={name} />\n    <h1 use:log={() => (name)}>'loading'</h1>\n  </figure>\n{/if}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/a912b9f030354ac6b997d549e1770037?version=5.1.12",title:"https://svelte.dev/playground/a912b9f030354ac6b997d549e1770037?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:f,alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["当元素挂载的时候的时候，运行 ",(0,s.jsx)(n.code,{children:"log()"})," 函数，打印 ",(0,s.jsx)(n.code,{children:"mounted"}),"和 ",(0,s.jsx)(n.code,{children:"setup"}),"，当传入值更新的时候，打印 ",(0,s.jsx)(n.code,{children:"teardown"}),"和 ",(0,s.jsx)(n.code,{children:"setup"}),"，当元素销毁的时候，打印 ",(0,s.jsx)(n.code,{children:"teardown"}),"。"]}),"\n",(0,s.jsxs)(n.p,{children:["Actions 的用法就这么多，Svelte Tutorial 中介绍的也不多，但",(0,s.jsx)(n.strong,{children:"实际上 Actions 是一个非常强大的功能"}),"。我们举几个例子，大家可以在实际操作中体会。"]}),"\n",(0,s.jsxs)(n.h2,{id:"3-用途-1输入框聚焦",children:["3. 用途 1：输入框聚焦",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3-用途-1输入框聚焦",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"现在我们来实现这样一个效果："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:"data:image/webp;base64,UklGRjQJAABXRUJQVlA4ICgJAAAwNQCdASp2AmkAPm02l0kkIqIhIZO5MIANiWlu4XVRG/OT8Y9in9s/Hzzd8Nflv2o9WGtq1Hfjf2b/AfmJ6898/wr/iPUI9Sf5je2wAflv9Z/3fgIf0foR+QeoB/IP5z/t/zM99/9P4O3cXsAfy/+0f9/2UP5b/x/5Xzs/TP7R/AV+uHW+9GkRBgvqwope4s78+1y7kOLO/PtctLnXPQsUh6UpC+ezwa40ym3doSmRRDizvz7XLuQ4s2GIRsAiu8xHwCZGAQQAazbi4sJeRPSwatcHX7vysr8T9n0YCMoK3AE5rwHo1jdDeJ+Hw4XIEDZQtWoQNQhWNMkBf8kT7X5zyLI+1y7kOLO/Ptcu5DhwDKqDJidslwoYQZvfSgthmDqhMnkBAa0zgiJ2NMbaNH4S8zMtByUVvRA26sUSE232uXchxZ359rl3IdGR8AQq8ugbuQ4s78+1y7kOLO/Ptcu5Dizvz7XLuQ4s780I0pDW5pcNlso/U0MGx1MHhcL92FBlhSoNa4ghzwMc3najDizvz7XLuQ4s78+1y7FuXiZJ7Bmz5wPv5aDlwOwOJPDjotqYAAD+/3HUBF9WjzvRwQNhXOesRrvEqSy9yNrJ/2Eaaz/BREV6947d6zIZvv/Cn2mfNi4gPbgDhawAzX5aT6I39S3PP61zNW/ikmYHYWktg6Lbq9CqF2fCar8rsDS6t2ccSGAJYPlcHGnMbw30siBRXN1SiZxl4OOnI8dBWd85MMUzaXfzRP/22cZ7q0hNFThlDHFJs0ymKTog/3wSBpoc209PPtL9XwXHeDhuxTY4ErbzjPuWMTqWjDOo+5sG55DhF+88MUfIuXBX64Ydj7+iiR3sycPJQ+vfIE1aoMcUS/anGDMOykN6KUpQHsc+cPk+e3sQoQ4/ImUGc/zH3zf6va3RxXB1xsiT2zZkU0PwGeKPQltfimlIZxvABhVvqO2T95InVHehzF0DZix1+7jEmkdB2LJwXSejT+6ZSrSpy7XJIiqXj3uAaut3WnSY+fsMDsRsdTyfz3ZKU4Ri7GPTYYCsep0VIFUSxLVb/Tpoykl8ko5n4G7ZZZCm65UZx5KdXyepI0xlmvw3vuJZB+XHMDtQg3BnlLkom8OCRHUw1Y6XynPP0wZ7Qi9Bv5c5nfRD8eCbMYwU+P/R+XyaCT/rKnD/k1Nt8Uv+mWmuF5cqjLc3Fmj+CU40O2B6JfzqdR3JW0hpcf5eYl4qOzkTExWqbzpmfCbFws7t7jAgr8BRaKwAWFp2LxYa5MTvgp4VXgMZufcirMTQu4zJNSGECaDpctK/Dswm8d48yP5pOGzpDUXQv8WzmGFVgZfDut2+WVPeaxf3XBXuF6mdpLDXlGjt1GiS+7yuDQySztUoAR9sy4FJJnmybRYoYe9WnIhOrDG0zfLLmz1Ycj6T/XW8u+56G9pYZ2MDlJN+1EBzOWUwGYX6KcFcdn2SSXj2tQQnj5V+eDbahE2uBcLoYAmMXXZ4wtADGcI0y3QUp36WLcYc0Y5H3+9TDbsbsHV87yQvJ4Gkxoq2utpf3il3QNWSzuAtmOYt9F/VRw6SPr4+o5dgtaKoE6CSTcFXCXxAM2rTvlHu+/Q6sGMPyerwuCq1qkN37TdvByKRjWp5BlnO3w7fh7hWusY4AFezJ/53JX9TevLA5IAOAe9qAnfxvkZ4Z683gzkZ4rzf5V2s8lDWEb3NP/8XFPnNX9uQ2rlUziOwdxoUQOx321ywg0BP3WzF9P3pHVrfIV9/FxyfX6ufjmnjFcB4Jj93h7eABBCVmjY0tyynOUrLxoKqZVtoZ1J7Uaa/uJ/5LbC+TVZDVP/N3XiIFgLch8Eg//irCs0RWOVKr05W5s8kGdfqd7P5PjOBtN7qgAtmR3vrf8NXrvb4V6XN0lTanURF02r1RVmdXDUATOzYAd3yxE8cnlqa8DS+FK6404Qv3nGifPbecLOl5f4K8lN/JgTD9RhtdTYsbc4HvsO0TO+2v4ka6LCX5+2Vnj061uIRK/m7wbxnbPu2k8Z8n0vp1hK0UzDdzvC5tQW32AVToTP/vgdN8Y3Rsp+ApGtHAk+3V1b0kvF9vnsK3r5e6aYY1BmzfKxEyMqi3lkmgFC5kNu5yADQhH+ZZqoMsUJu62WMMmd5PZf4qKbfJw5N8U/KDsR8HQACTsTS9P/A3jL0lRfqyE80ZorCTAn11X/uwxu9EHB+wVc9ST5ZJdFJbsVKSKsgmtM5BneAg4a0hRLEeKj73e1aBCTknHj5NG891tFyqERrKwIjQkAAAAGabE/3278tAUB8q+dHx7ER0vh6n+4LCqr1OILG9K9Nz8CbIhsm0akp0AwF8qU4jlahhoIusl5akI3tQdE0cBeNMwDVY0AoiG61dxI2LINJuVu5bAiN93DQJrj2WhfVrKahFFjUgF0i2R/fK0ToReiMbBTGnDT1QQzZKsfadiDVTJ1ZnmX7+eTQqftlkLrFqWqm4NnBsDscuHWhUBH1FHy1ntGGWBxA6kfEXF04NYd6UYQ/Ebd63MaOjfbVcllPCST7cSESkfCXuWo0144rqEVvB6lQ8i9cJkAsN4D4TioAsY8pxnVjZ35a2a6i1SQbSV4c7JAP2x1RNpl+WtWr0FrWtCH0FgNMZ9Ng+w+7ecv/ML2bOY3B7NcJvu+f2QYeRUgCJqA0en+Izlo2+xiNInMCj0saEHC1rKFkqwQE94hc1PFIZvFDoDiY6MhcOtYOPUSUtQjPfTa7AJs4/KWd04syk7Tdylh+qUMI2EjnWxj4opGKVOAZIoNvB6PDEmJXj4kKObWMnDlFDxLK61SwPYvKVEN/elkvQc9Uy24bpRucDsRux3HT44pCVxMrX2xh0GakfTcpf0OzyjEMWvg0BvwUMbjHntwmdAGQUcReexyGjr27fLRF88vlW41rKBsAd/qKRKE/nCG23Dp8IK7m2+GdvBCiLxIrPglBxED5okcgfG6sAxlwYWjk438MdRhv0vm6nu5TgYLlacHb+yd0J39lK88ZAOPhsXKCsxIa4vZt+uE115YAKnQFN4hb+X9vKih7gh2uchbspIJxZ0jC3ykBGJRDF1IPlnpFN7hilr5otvZdV+msYTOZrQqCSXk64OAyyMbFNSzoIAAA",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["效果本身是比较简单的，实现的重点在于",(0,s.jsx)(n.strong,{children:"当点击编辑按钮的时候，输入框要聚焦，方便用户输入"}),"。"]}),"\n",(0,s.jsx)(n.p,{children:"第一种实现方式如下："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  import { tick } from 'svelte';\n\n  let input = $state();\n  let name = $state('YaYu');\n  let editing = $state(false);\n\n  async function toggleEdit() {\n    editing = !editing\n    if (editing) {\n      await tick()\n      input.focus();\n    }\n  }\n<\/script>\n\n昵称：\n{#if editing}\n  <label>\n    <input type=\"text\" bind:this={input} bind:value={name}>\n  </label>\n\n{:else}\n  {name}\n{/if}\n\n<button onclick={toggleEdit} style=\"display: inline\">\n  {editing ? '确定' : '编辑'}\n</button>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["在这段代码中，我们首先使用 ",(0,s.jsx)(n.code,{children:"bind:this"})," 获取 ",(0,s.jsx)(n.code,{children:"<input>"}),"引用，然后在点击编辑的时候，调用 ",(0,s.jsx)(n.code,{children:".focus()"}),"方法。"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/232e637001b144bdb04033e18c368bc9?version=5.1.12",title:"https://svelte.dev/playground/232e637001b144bdb04033e18c368bc9?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:v,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"第二种实现方式如下："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- App.svelte --\x3e\n<script>\n  import Input from './Input.svelte';\n  let name = $state('YaYu');\n  let editing = $state(false);\n\n  function toggleEdit() {\n    editing = !editing\n  }\n<\/script>\n\n昵称：\n{#if editing}\n  <Input bind:value={name} />\n{:else}\n  {name}\n{/if}\n\n<button onclick={toggleEdit} style=\"display: inline\">\n  {editing ? '确定' : '编辑'}\n</button>\n\n\x3c!-- Input.svelte --\x3e\n<script>\n  let { value = $bindable() } = $props();\n\n  let input = $state();\n\n  import { onMount } from 'svelte';\n  onMount(() => {\n    input.focus();\n  });\n<\/script>\n\n<label>\n  <input type=\"text\" bind:this={input} bind:value>\n</label>\n"})}),"\n",(0,s.jsx)(n.p,{children:"在这段代码中，我们将输入框移到一个单独的组件中，在挂载的时候，将输入框聚焦。"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/43914e8b561b43c78d853cec6bd36664?version=5.1.12",title:"https://svelte.dev/playground/43914e8b561b43c78d853cec6bd36664?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下"}),"（其实效果跟上面是一样的）："]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:x,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"第三种方法是使用 Actions："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"<script>\n  import { tick } from 'svelte';\n\n  let input = $state();\n  let name = $state('YaYu');\n  let editing = $state(false);\n\n  function toggleEdit() {\n    editing = !editing\n  }\n\n  function focusOnMount(node) {\n    node.focus();\n  }\n<\/script>\n\n昵称：\n{#if editing}\n  <label>\n    <input use:focusOnMount type=\"text\" bind:this={input} bind:value={name}>\n  </label>\n\n{:else}\n  {name}\n{/if}\n\n<button onclick={toggleEdit}>\n  {editing ? '确定' : '编辑'}\n</button>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/ed1f4e8be40c475ea4d4a3aa873c75d5?version=5.1.12",title:"https://svelte.dev/playground/ed1f4e8be40c475ea4d4a3aa873c75d5?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果同上"})}),"\n",(0,s.jsx)(n.p,{children:"这三种方法中，哪种更好一点呢？"}),"\n",(0,s.jsxs)(n.p,{children:["理论上，Actions 这个方法更好，因为复用方便。如果还有其他输入框，直接添加 ",(0,s.jsx)(n.code,{children:"use:focusOnMount"}),"即可。"]}),"\n",(0,s.jsx)(n.p,{children:"借这个简单的例子是为了说明 Actions 可以解决 DOM 操作的复用问题。我们再进阶看一个例子。"}),"\n",(0,s.jsxs)(n.h2,{id:"4-用途-2双击事件",children:["4. 用途 2：双击事件",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-用途-2双击事件",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"现在我们来实现一个双击效果，即当双击按钮的时候，打印一个值："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  function doubleClick(element) {\n    let count = 0;\n    let timeoutId;\n\n    $effect(() => {\n      function onClick() {\n        if (++count === 2) {\n          element.dispatchEvent(new CustomEvent('doubleClick'));\n        }\n\n        timeoutId && clearTimeout(timeoutId);\n        timeoutId = setTimeout(() => {\n          timeoutId = null;\n          count = 0;\n        }, 800);\n      }\n\n      element.addEventListener('click', onClick);\n\n      return () => {\n         element.removeEventListener('click', onClick);\n      }\n    });\n  }\n<\/script>\n\n<button\n  use:doubleClick\n  ondoubleClick={() => console.log('doubleClick!')}\n>doubleClick</button>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/dce940ea61bc48bca389e240c28cedad?version=5.1.12",title:"https://svelte.dev/playground/dce940ea61bc48bca389e240c28cedad?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:u,alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["这是 Actions 一个非常常见的例子。当元素加上 ",(0,s.jsx)(n.code,{children:"use:doubleClick"}),"指令的时候，元素会监听点击事件，并在双击的时候，发送自定义的 doubleClick 事件，然后元素可以使用 ",(0,s.jsx)(n.code,{children:"ondoubleClick"}),"监听该事件。"]}),"\n",(0,s.jsxs)(n.p,{children:["这也是 ",(0,s.jsx)(n.a,{href:"https://learn.svelte.dev/tutorial/actions",title:"https://learn.svelte.dev/tutorial/actions",target:"_blank",rel:"noopener noreferrer",children:"Tutorial"})," 中介绍的常见的 4 种用法之一："]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:h,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"当然不止双击，各种手势操作都可以通过这种方式实现："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  import { on } from 'svelte/events';\n\n  function gestures(node) {\n    $effect(() => {\n      // ...\n      node.dispatchEvent(new CustomEvent('swipeleft'));\n\n      // ...\n      node.dispatchEvent(new CustomEvent('swiperight'));\n    });\n  }\n<\/script>\n\n<div\n  use:gestures\n  onswipeleft={next}\n  onswiperight={prev}\n>...</div>\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"5-用途-3tooltips",children:["5. 用途 3：tooltips",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#5-用途-3tooltips",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"tooltips 是 Tutorial 中介绍的例子。我们再列举一遍当做复习了。"}),"\n",(0,s.jsxs)(n.p,{children:["有的时候，为了开发方便，你需要引入一些三方库，Actions 就可以搭配三方库一起使用。就比如实现 tooltips 的 ",(0,s.jsx)(n.a,{href:"https://atomiks.github.io/tippyjs/",title:"https://atomiks.github.io/tippyjs/",target:"_blank",rel:"noopener noreferrer",children:"tippy"}),"。它的基本用法如下："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'<button id="myButton">My Button</button>;\n\ntippy("#myButton", {\n  content: "I\'m a Tippy tooltip!",\n});\n'})}),"\n",(0,s.jsx)(n.p,{children:"浏览器效果如下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:p,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"如果我们要在 Svelte 项目中使用："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  import tippy from 'tippy.js';\n\n  let content = $state('Hello!');\n\n  function tooltip(node, fn) {\n    $effect(() => {\n      const tooltip = tippy(node, fn());\n\n      return tooltip.destroy;\n    });\n  }\n<\/script>\n\n<input bind:value={content} />\n\n<button use:tooltip={() => ({ content })}>\n  Hover me\n</button>\n\n<style>\n  :global {\n    [data-tippy-root] {\n      --bg: #666;\n      background-color: var(--bg);\n      color: white;\n      border-radius: 0.2rem;\n      padding: 0.2rem 0.6rem;\n      filter: drop-shadow(1px 1px 3px rgb(0 0 0 / 0.1));\n\n      * {\n        transition: none;\n      }\n    }\n\n    [data-tippy-root]::before {\n      --size: 0.4rem;\n      content: '';\n      position: absolute;\n      left: calc(50% - var(--size));\n      top: calc(-2 * var(--size) + 1px);\n      border: var(--size) solid transparent;\n      border-bottom-color: var(--bg);\n    }\n  }\n</style>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://learn.svelte.dev/tutorial/adding-parameters-to-actions",title:"https://learn.svelte.dev/tutorial/adding-parameters-to-actions",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"当然不止是 tippy，因为在函数中提供了元素的引用，可以搭配使用很多三方库，这极大的拓展了 Svelte 能够实现的功能。"}),"\n",(0,s.jsxs)(n.p,{children:["我认为这个例子很好的展示了 ",(0,s.jsx)(n.a,{href:"https://learn.svelte.dev/tutorial/actions",title:"https://learn.svelte.dev/tutorial/actions",target:"_blank",rel:"noopener noreferrer",children:"Tutorial"})," 中介绍的用法："]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:o,alt:""})}),"\n",(0,s.jsxs)(n.h2,{id:"6-用途-4clickoutside-与-modal",children:["6. 用途 4：clickOutside 与 Modal",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#6-用途-4clickoutside-与-modal",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"这个例子类似于双击事件，只不过是自定义的 clickOutside 事件："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  import { scale } from 'svelte/transition'\n\n  let open = $state(false)\n\n  function openModal() {\n    open = true\n  }\n\n  function closeModal() {\n    open = false\n  }\n\n  const clickOutside = (element) => {\n\n    $effect(() => {\n      function handleClick(event) {\n        if (element && !element.contains(event.target)) {\n          const clickOutsideEvent = new CustomEvent('outside')\n          element.dispatchEvent(clickOutsideEvent)\n        }\n      }\n\n      document.addEventListener('click', handleClick, true)\n\n      return () => {\n        document.removeEventListener('click', handleClick, true)\n      }\n    });\n  }\n<\/script>\n\n{#if open}\n  <div class=\"background\">\n    <div\n      class=\"modal\"\n      use:clickOutside\n      onoutside={closeModal}\n      transition:scale\n    >\n      <h2>Modal</h2>\n\n      <p>What's up?</p>\n\n    </div>\n\n  </div>\n\n{/if}\n\n<button onclick={openModal}>\n  Open\n</button>\n\n<style>\n  .background {\n    position: absolute;\n    inset: 0;\n    display: grid;\n    place-content: center;\n\n    & .modal {\n      width: 400px;\n      min-height: 300px;\n      padding: 2rem;\n      background-color: hsl(200 10% 10% / 80%);\n      backdrop-filter: blur(20px);\n      border: 1px solid hsl(200 10% 12%);\n      border-radius: 8px;\n      box-shadow: 1px 1px 10px hsl(0 0% 0% / 20%);\n\n      & p {\n        margin-top: 1rem;\n      }\n    }\n  }\n</style>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["我们在 modal 元素上添加了 ",(0,s.jsx)(n.code,{children:"use:clickOutside"}),"，在 ",(0,s.jsx)(n.code,{children:"clickOutside"})," Action 函数中我们判断 Modal 是否包含点击的元素，如果没有，那说明点击了 Modal 之外的位置，于是发送自定义的 ",(0,s.jsx)(n.code,{children:"outside"}),"事件。然后我们在 modal 元素上监听 outside 事件，关闭 modal。"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/43272a97a7ff44b0a56579a82b539190?version=5.1.12",title:"https://svelte.dev/playground/43272a97a7ff44b0a56579a82b539190?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:a,alt:""})}),"\n",(0,s.jsxs)(n.h2,{id:"7-用途-5图片懒加载",children:["7. 用途 5：图片懒加载",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#7-用途-5图片懒加载",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["图片懒加载就是当图片出现在视口内的时候，再开始加载图片。我们新建一个 ",(0,s.jsx)(n.code,{children:"lazyLoad.svelte.js"}),"："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'export function lazyLoadImage(node) {\n  $effect(() => {\n    const src = node.getAttribute("data-src");\n    let intersecting = false;\n\n    const handleIntersection = (entries) => {\n      intersecting = entries[0].isIntersecting;\n      if (entries[0].intersectionRatio > 0) {\n        node.src = src;\n      }\n      if (intersecting) {\n        observer.unobserve(node);\n      }\n    };\n\n    const observer = new IntersectionObserver(handleIntersection);\n\n    observer.observe(node);\n\n    return () => {\n      observer.unobserve(node);\n    };\n  });\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"当需要使用懒加载的时候："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<script>\n  import { lazyLoadImage } from \'./lazyLoad.svelte.js\'\n<\/script>\n\n{#each [...Array(15).keys()] as _}\n  <p>\n    Lorem ipsum dolor sit amet consectetur adipisicing elit. Aspernatur obcaecati ex totam laboriosam, culpa ipsa quis nostrum odio dolore aut eos numquam ratione quam maiores voluptates quas eius labore error?\n  </p>\n\n{/each}\n\n<img use:lazyLoadImage width="400px" data-src="https://plus.unsplash.com/premium_photo-1720706435477-bb1d79c2224c?q=80&w=4480&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="">\n'})}),"\n",(0,s.jsxs)(n.p,{children:["在图片元素上加上 ",(0,s.jsx)(n.code,{children:"use:lazyLoadImage"}),"，并在 ",(0,s.jsx)(n.code,{children:"data-src"}),"属性上加上该图片的实际地址。Actions 就会在该元素进入视口的时候，根据 ",(0,s.jsx)(n.code,{children:"data-src"}),"属性值加载对应图片。"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/edb85ec58d9045b8aa7a219838234842?version=5.1.12",title:"https://svelte.dev/playground/edb85ec58d9045b8aa7a219838234842?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:d,alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["这个例子展示了 ",(0,s.jsx)(n.a,{href:"https://learn.svelte.dev/tutorial/actions",title:"https://learn.svelte.dev/tutorial/actions",target:"_blank",rel:"noopener noreferrer",children:"Tutorial"})," 中介绍的懒加载用法："]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:c,alt:""})}),"\n",(0,s.jsxs)(n.h2,{id:"8-注意关于-svelte-4-中的-actions-顺序问题",children:["8. 注意：关于 Svelte 4 中的 Actions 顺序问题",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#8-注意关于-svelte-4-中的-actions-顺序问题",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"在 Svelte 4 中，使用 Actions 的时候要注意，Bindings 和 Actions 的顺序可能会影响最终的结果。我们举个例子："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  let value1 = '';\n  let value2 = '';\n\n  function uppercase(element) {\n    function onInput(event) {\n      element.value = element.value.toUpperCase();\n    }\n    element.addEventListener('input', onInput);\n    return {\n      destroy() {\n        element.removeEventListener('input', onInput);\n      }\n    }\n  }\n<\/script>\n\n<input\n  bind:value={value1}\n  use:uppercase\n/>\n<input\n  use:uppercase\n  bind:value={value2} />\n\n<div>{value1}</div>\n\n<div>{value2}</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/repl/de54ff5709d9457bb54f7166efe52bdd?version=4.2.18",title:"https://svelte.dev/repl/de54ff5709d9457bb54f7166efe52bdd?version=4.2.18",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:r,alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["我们的第一个输入框使用的是 ",(0,s.jsx)(n.code,{children:"<input bind:value={value1} use:uppercase />"}),"，当输入小写字母的时候，虽然输入框显示没有问题，但实际 value1 的值的最后一个字母是小写的。"]}),"\n",(0,s.jsxs)(n.p,{children:["这是因为按照顺序，我们先进行的双向绑定，然后再使用 Actions 修改的值。当输入第一个小写字符",(0,s.jsx)(n.code,{children:"a"}),"的时候，因为进行了双向绑定，所以 value1 的值显示为 ",(0,s.jsx)(n.code,{children:"a"}),"，但输入框有 Action，所以显示为大写。当输入第二个小写字符 ",(0,s.jsx)(n.code,{children:"s"}),"的时候，因为输入框之前的值 ",(0,s.jsx)(n.code,{children:"A"}),"，加上刚输入的 ",(0,s.jsx)(n.code,{children:"s"}),"，双向绑定后，修改 value 的值为 ",(0,s.jsx)(n.code,{children:"As"}),"，输入框因为有 Action，继续显示为大写 ",(0,s.jsx)(n.code,{children:"AS"}),"。以此类推……所以实际值的最后一个字符总是小写。"]}),"\n",(0,s.jsxs)(n.p,{children:["第二个输入框使用的是 ",(0,s.jsx)(n.code,{children:"<input use:uppercase bind:value={value2} />"}),"，按照顺序，我们先使用 Actions 修改输入框的值，再进行双向绑定，所以字符始终为大写。"]}),"\n",(0,s.jsx)(n.p,{children:"但在 Svelte 5 中，使用 $effect 的方式则顺序不会影响结果，都是最后一个字符小写："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<script>\n  let value1 = $state('');\n  let value2 = $state('');\n\n  function uppercase(element) {\n    $effect(() => {\n      function onInput(event) {\n        element.value = element.value.toUpperCase();\n      }\n      element.addEventListener('input', onInput);\n      return () => {\n        element.removeEventListener('input', onInput);\n      }\n    });\n  }\n<\/script>\n\n<input bind:value={value1} use:uppercase />\n<input use:uppercase bind:value={value2} />\n\n<div>{value1}</div>\n<div>{value2}</div>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://svelte.dev/playground/6ba4231f262742c8bd492706767a9d96?version=5.1.12",title:"https://svelte.dev/playground/6ba4231f262742c8bd492706767a9d96?version=5.1.12",target:"_blank",rel:"noopener noreferrer",children:"浏览器效果如下："})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:l,alt:""})}),"\n",(0,s.jsxs)(n.h2,{id:"9-最后",children:["9. 最后",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#9-最后",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"恭喜您完成了本篇内容的学习！Actions 是一个非常强大的功能，擅用 Actions 可以让我们的代码功能拆分更清晰，复用更方便。"})]})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(b,{...e})}):b(e)}let m=g;g.__RSPRESS_PAGE_META={},g.__RSPRESS_PAGE_META["Svelte%20%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%2F7-%E8%AF%AD%E6%B3%95%E7%AF%87%20%E2%9D%98%20Actions.md"]={toc:[{text:"1. 前言",id:"1-前言",depth:2},{text:"2. Actions 介绍",id:"2-actions-介绍",depth:2},{text:"3. 用途 1：输入框聚焦",id:"3-用途-1输入框聚焦",depth:2},{text:"4. 用途 2：双击事件",id:"4-用途-2双击事件",depth:2},{text:"5. 用途 3：tooltips",id:"5-用途-3tooltips",depth:2},{text:"6. 用途 4：clickOutside 与 Modal",id:"6-用途-4clickoutside-与-modal",depth:2},{text:"7. 用途 5：图片懒加载",id:"7-用途-5图片懒加载",depth:2},{text:"8. 注意：关于 Svelte 4 中的 Actions 顺序问题",id:"8-注意关于-svelte-4-中的-actions-顺序问题",depth:2},{text:"9. 最后",id:"9-最后",depth:2}],title:"7-语法篇 ❘ Actions",headingTitle:"7-语法篇 ❘ Actions",frontmatter:{}}}}]);