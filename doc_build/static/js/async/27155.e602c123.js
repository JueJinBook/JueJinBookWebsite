"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["27155"],{705467:function(n,e,c){c.r(e),c.d(e,{default:()=>nA});var i=c(552676),d=c(740453);let l=c.p+"static/image/caffc036b7e86c453a74bd7ff5187efa.f3aa8677.webp",s=c.p+"static/image/4d43febdd7e01287dafb2d3b30898432.0e5e17ec.webp",r=c.p+"static/image/ed71dcd2c527907d64f440f7656a1cde.7742c4b8.webp",a=c.p+"static/image/9272c4c03a504547f24ff1bea801d389.e22c166b.webp",x=c.p+"static/image/dfeffd9b1b73d5d111c94a94cd946c24.50901723.webp",p=c.p+"static/image/427940098782bd8238f8f92c28ed47ec.168b4714.webp",t=c.p+"static/image/29cf1b3eee98d46ce420f5522259cccb.c34adce8.webp",h=c.p+"static/image/e109cf00de7d9c6d4aeaf49808f74baa.cfa6e8b0.webp",j=c.p+"static/image/8bcd7df3744d0c11f313eb90289229f8.87d61b7e.webp",A=c.p+"static/image/ebb48765540c4f345eedac8b2e3fd54d.d37ee1b0.webp",f=c.p+"static/image/6681b6df785a36f78d4278bc46c677a3.07340de8.webp",b=c.p+"static/image/4790fe429233c71f2d7f7506b48975d7.6a452df0.webp",g=c.p+"static/image/53b661af79c4f23d5ab3f04ac475cfaf.df67f3ec.webp",o=c.p+"static/image/3ab34ca0cfc76c69475c69027cd31d99.499e891d.webp",m=c.p+"static/image/4045d52edb89195b55ece0c254a8a16a.25ede309.webp",u=c.p+"static/image/2d07c40ae714febe58cac8636391031b.1b3fdea7.webp",M=c.p+"static/image/bdf552a9365be348892f36ceb0583ddb.8110b2d8.webp",E=c.p+"static/image/356b3b48fcb7cd1b187e3592cc999400.db81de53.webp",X=c.p+"static/image/aa648561848ecf1eb98251090f1f5af1.1a2235e2.webp",v=c.p+"static/image/a722a4a5ba50ba06891547d37d8e3fcc.bc56fd7d.webp",w=c.p+"static/image/ecbd4dad4d8fea48d4c8e62916a72cc6.097a22e3.webp",P=c.p+"static/image/17901c2670fbabf5ed77b06f824f7d88.b82420b4.webp",J=c.p+"static/image/21d7747c6a548775d6857b33a29e5b99.fde1e6b6.webp",Y=c.p+"static/image/900798498359e021fea6173714efb6e6.7e74cb55.webp",k=c.p+"static/image/c74aacb36022964dd1d4000d681c7615.6ce3e254.webp",z=c.p+"static/image/4c88e9a082fbd12dddb4b3ca3ae7e92f.033d2769.webp",T=c.p+"static/image/95c2a949a3c4961c3f6028f81231c9e0.e59f57bb.webp",G=c.p+"static/image/09f8b5dce58327906fcc6961578b1346.3780f194.webp",Z=c.p+"static/image/af14f2aa96119d3c5715353f645972aa.cbd57b27.webp",D=c.p+"static/image/026e232806064572a88fc586f0b7755a.87d2b80e.webp",N=c.p+"static/image/8862bc3a4c3ad6c551385573df4ae08e.a019b65e.webp",I=c.p+"static/image/b68b303bd91c4b80af8742efa5831587.442d9ddb.webp",q=c.p+"static/image/d7d163711cea7f74cc515c5b2bf22405.eb65938e.webp",S=c.p+"static/image/26118500deab0117b6c55cda0977a92e.8853d9d9.webp",B=c.p+"static/image/9c180f0c40a389abb71873ec267029aa.333b1e07.webp",Q=c.p+"static/image/d09401a7dd3e3cdfff925dc2c750af6a.a28be03e.webp",C=c.p+"static/image/94b36bbde1ade397b2309a61b8ee078d.a4206a42.webp",L=c.p+"static/image/63ec3fc6b507876e8ae76719ad2fcb4a.82d3e399.webp",F=c.p+"static/image/a1a3eabeb009abb4cd1a762fb6a60a09.89420a44.webp",U=c.p+"static/image/6a2fdcde7a638794b2de6dd90691a1fd.e9b92c4b.webp",R=c.p+"static/image/5c3caf3aa6348c30990af9daf07da4a6.c5c0040b.webp",y=c.p+"static/image/fec302916cd96aa97e2b1df929536c18.d0200f3f.webp",O=c.p+"static/image/7a78636c87ac2780c3e6c39c50243740.c205b8ff.webp",W=c.p+"static/image/50c38bc606507837f36a5542adf99a4a.5b410bbf.webp",H=c.p+"static/image/d0442ac4e2e2aa8470776fe86af570ed.a8481cf9.webp",V=c.p+"static/image/a568ff4778e26a1b3666de12b59d0676.03c6a6d0.webp",K=c.p+"static/image/04dd5b23b4627e6b0ba2dfda4381195b.36db5054.webp",_=c.p+"static/image/f707eab7aa84ed861b329f6a7458cd4b.2bf813b6.webp",$=c.p+"static/image/6412c8b9e87e55587fb3b2e0b9e59cd0.d4228eb0.webp",nn=c.p+"static/image/10d0712128103695919ac8fc9d03d2a7.643e4f6a.webp",ne=c.p+"static/image/529e099e5f606421c99be350c9cc5147.5615e730.webp",nc=c.p+"static/image/93b1813935f89bcbcdf761ae18ff6ff3.9dfe6364.webp",ni=c.p+"static/image/b989fe0af04e01990801be29a49910cf.132efa97.webp",nd=c.p+"static/image/c31aa06783e2ca9de1701caf63798843.16f98c28.webp",nl=c.p+"static/image/5a5e7bc3580c192ce6121edae3692960.c3508688.webp",ns=c.p+"static/image/245524b2475cb19c40fdd06fbbc8652e.9633194b.webp",nr=c.p+"static/image/d71fca10dfeb9bfdc08b29e2539d6dd7.24ed5d73.webp",na=c.p+"static/image/519b7fb3f36cb64efa3ec085df0c0c9a.7567d104.webp",nx=c.p+"static/image/8c53d7020741109e8e3293162445a6c5.0ca060da.webp",np=c.p+"static/image/fb4f4a2a82a49cc1e4103867052c8f75.0c602dbf.webp",nt=c.p+"static/image/8fd3535b50130f8026f988ef673a31f5.98dd41ad.webp";function nh(n){let e=Object.assign({h1:"h1",a:"a",p:"p",img:"img",pre:"pre",code:"code",strong:"strong",ul:"ul",li:"li",h2:"h2"},(0,d.ah)(),n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.h1,{id:"79-快速掌握-nginx-的-2-大核心用法",children:["79. 快速掌握 Nginx 的 2 大核心用法",(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#79-快速掌握-nginx-的-2-大核心用法",children:"#"})]}),"\n",(0,i.jsx)(e.p,{children:"Nginx 是流行的服务器，一般用它对静态资源做托管、对动态资源做反向代理。"}),"\n",(0,i.jsx)(e.p,{children:"Docker 是流行的容器技术，里面可以跑任何服务。"}),"\n",(0,i.jsx)(e.p,{children:"那 Docker + Nginx 如何结合使用呢？"}),"\n",(0,i.jsx)(e.p,{children:"我们来试一下："}),"\n",(0,i.jsx)(e.p,{children:"搜索 nginx（这一步需要科学上网，因为要访问 hub.docker.com 这个网站），点击 run："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nt,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"输入容器名和要映射的端口："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:np,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这里把宿主机的 81 端口映射到容器内的 80 端口，点击 run。"}),"\n",(0,i.jsx)(e.p,{children:"这时候就可以看到 docker 容器跑起来了，并且打印了日志："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nx,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["浏览器访问下 ",(0,i.jsx)(e.a,{href:"http://localhost:81",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:81"})," 可以看到 nginx 欢迎页面："]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:na,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这很明显是容器里跑的服务。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nr,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"但是现在的页面是默认的，我想用 nginx 来托管我的一些静态 html 页面怎么做呢？"}),"\n",(0,i.jsx)(e.p,{children:"首先我们要知道现在的配置文件和页面都存在哪里。"}),"\n",(0,i.jsx)(e.p,{children:"在 files 面板可以看到容器内的文件："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:ns,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"里面的 /usr/share/nginx/html/ 目录下面就是所有的静态文件。"}),"\n",(0,i.jsx)(e.p,{children:"双击点开 index.html 看看："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nl,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nd,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"和我们浏览器看到的页面一毛一样。"}),"\n",(0,i.jsx)(e.p,{children:"也就是说，这个目录就是保存静态文件的目录。"}),"\n",(0,i.jsx)(e.p,{children:"那我们在这个目录下放我们自己的 html 不就行了？"}),"\n",(0,i.jsx)(e.p,{children:"我们先把这个目录复制出来："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp  nginx1:/usr/share/nginx/html ~/nginx-html\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:ni,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"docker cp 这个命令就是用于在宿主机和容器之间复制文件和目录的。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nc,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"比如我们把这个目录再复制到容器里："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp  ~/nginx-html nginx1:/usr/share/nginx/html-xxx\n"})}),"\n",(0,i.jsx)(e.p,{children:"可以看到容器内就多了这个目录："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:ne,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后我们在这个目录下添加两个 html 来试试看："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"echo aaa > aaa.html\n\necho bbb > bbb.html\n\ndocker cp  ~/nginx-html nginx1:/usr/share/nginx/html\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:nn,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"但当目标目录存在的时候，docker 会把他复制到目标目录下面："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:$,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"我们需要先删除容器的这个目录，再复制："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:_,alt:""})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp  ~/nginx-html nginx1:/usr/share/nginx/html\n"})}),"\n",(0,i.jsx)(e.p,{children:"这样就好了："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:K,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后浏览器访问下试试："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"现在就可以访问容器内的这些目录了。"}),"\n",(0,i.jsx)(e.p,{children:"也就是说只要放到 /usr/share/nginx/html 下的文件，都可以通过被访问到。"}),"\n",(0,i.jsx)(e.p,{children:"可是为什么呢？"}),"\n",(0,i.jsx)(e.p,{children:"这是因为 nginx 的默认配置。"}),"\n",(0,i.jsx)(e.p,{children:"我们看下 nginx 配置文件，也就是 /etc/nginx/nginx.conf。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:V,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"复制出来看看："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp  nginx1:/etc/nginx/nginx.conf ~/nginx-html\n"})}),"\n",(0,i.jsx)(e.p,{children:"这是就是 nginx 的默认配置："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:H,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"其实这个 nginx.conf 叫做主配置文件，里面一般做一些全局的配置，比如错误日志的目录等等。"}),"\n",(0,i.jsx)(e.p,{children:"可以看到 http 下面有个 include 引入了 /etc/nginx/conf.d/*.conf 的配置。"}),"\n",(0,i.jsx)(e.p,{children:"一般具体的路由配置都是在这些子配置文件里。"}),"\n",(0,i.jsx)(e.p,{children:"目录 conf.d 是 configuration directory 的意思。"}),"\n",(0,i.jsx)(e.p,{children:"我们把这个目录也复制出来看看："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp  nginx1:/etc/nginx/conf.d ~/nginx-html\n"})}),"\n",(0,i.jsx)(e.p,{children:"这里面就配置了 localhost:80 的虚拟主机下的所有路由。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:W,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"虚拟主机是什么呢？"}),"\n",(0,i.jsx)(e.p,{children:"就是可以用一台 nginx 服务器来为多个域名和端口的提供服务。"}),"\n",(0,i.jsx)(e.p,{children:"只要多加几个 server 配置就可以。"}),"\n",(0,i.jsx)(e.p,{children:"这里我们就配置 localhost:80 这一个虚拟主机。"}),"\n",(0,i.jsx)(e.p,{children:"下面的 location 就是路由配置。"}),"\n",(0,i.jsx)(e.p,{children:"比如这个配置："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:O,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"它就配置了 / 下的所有路由，都是在 root 指定的目录查找。"}),"\n",(0,i.jsxs)(e.p,{children:["所以 ",(0,i.jsx)(e.a,{href:"http://localhost/aaa.html",target:"_blank",rel:"noopener noreferrer",children:"http://localhost/aaa.html"})," 就是从 /usr/share/nginx/html/aaa.html 找的。"]}),"\n",(0,i.jsx)(e.p,{children:"location 支持的语法有好几个，我们分别试一下："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'location = /111/ {\n    default_type text/plain;\n    return 200 "111 success";\n}\n\nlocation /222 {\n    default_type text/plain;\n    return 200 $uri;\n}\n\nlocation ~ ^/333/bbb.*\\.html$ {\n    default_type text/plain;\n    return 200 $uri;\n}\n\nlocation ~* ^/444/AAA.*\\.html$ {\n    default_type text/plain;\n    return 200 $uri;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"把之前的 location / 删掉，添加这样几个路由配置。"}),"\n",(0,i.jsx)(e.p,{children:"具体这些配置都是什么意思待会再说。"}),"\n",(0,i.jsx)(e.p,{children:"把这个文件复制到容器内："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:"然后在容器内的 terminal 执行："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"nginx -s reload\n"})}),"\n",(0,i.jsx)(e.p,{children:"重新加载配置文件。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:y,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后来看第一条路由："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:R,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"location 和路径之间加了个 =，代表精准匹配，也就是只有完全相同的 url 才会匹配这个路由。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,UklGRjoNAABXRUJQVlA4IC4NAADwUACdASoiAqQAPp1OoE0lpCMiIXh5gLATiWlu/E85E1G4GuyTA/p4lLTxf/U+0v/HflT58+P72tnBf0XhJia9nf5z+4ebv+58Efgn/Q+oR64/z28d65/i/QC9yPov/P8E//H/u3qP9mfYA/l39l4mH0T2Bf0l6sP9n/5vu19uP1r7BX68f9XsWekmICPl4Pg9O/D6HweUytsIOyn6Kfop+in6Kfop52xbSpMnPAmqjQ5jSQemqf81afaOisj0RMeGMNJ2g+24nbiX6zYFU8pdYvTk/uAFR02iG/pmWUONfqwoYPlb29nCAJA4UEqk0XJA11sOUmeo/G9nftmBMvJgMlrhkRECbt4vyk/hckgvd9BSlFKUdzUzWx3OpQAt3QoGT6qPDfWYKuqCWu6rfIplPKZEeVoU3dKSaoBlv6X+96yzTGIjphzN9kCjdQIKb1DUW/vqpoJ4xK9Q212xw3Wxz1omVXdTKHv0jCpCzhlqcBKXB5Jy+MOi7vncj8LvveUP1jBetaDXhaXZyY8ashhTOAKyXMYrMI4uMRcKzITZf6BKkm57lANk2q7QuPg6I1KYOnoyUleIm04chcRlYKLotlC4kqF1cXcSVARnVAIFARTshnU/6u7ViZN/D7PqksbvWN3rG71jd6xu9Y1tqNXI5RM1M04yZ4rZrZfSC9oVM/hYsQmUNJi16SiII4QSqj4mYhP0UdclDlD61n048KbSODXfPMwJ1CXpFVctOlZOtYTDTIkTzY3esbvWN3rG71jd6xwAgtiknThovJ0Xk6LydF5Oi8nReTovJ0Xk6LxROHG8nOR2PYvmjEmViHXGZ5EddbbBFnfihqNrooMgkiH1BD6gh9QQ+oIfUEPqCKS7gAD+zsoqJBFd8qNWmElBwaPi28FilERYV3Cu4V3Cu4V3jXBiNchCyUq3LAaw52AeXbxGgwD9iiR/Lh+ov1zLCayZPnO3RQwzSU8D3m19OMdWZMIK/uP3/yNiFJpww9nrx5rSDr81ioz6B990s/jn26bwemDhhvQHiDsJuhW0rXOg44i8x0lo5mYE6sOXSbdPtVbTf1Bss1dcNGUJTvMsAwzLMAoeoXDpO4FcF/Nb37paH8wJLBXo74vUexn3FkJJ9f7jSvkN8WPluIr8/GDJxaD7odW1MtiBD/XPFNbzROyKCIh4mbvG7A+3LN5/MH3n1HWxC6iz5Af91Pw9fG5f+/Z7xxfCPLtSRYnLmi4aCaNOzC0l95wp3LoIJ+6+fJtCSyGfp5NpGXCKxE3YKySMwhLDUN84GUtRTDjOiGNBhscE/AY9AfKi+8zz9jsg6EuODekK61NO1cxyzTYfnacVrz6V6Gt7AMnZE9Zj3Xn6Geuz0X90prQRmdPZj3eFaQPuj9h8XO9LsUZkTpH5agHO26MmN28IJVZ5su1/WMbLRCYqGL5vYkPZrF1iX9UHZ0BijVKGiz/mVIppNdM199dMehII61cKSsK7sHfYOIB3tmfk0zE9HCghWqNVTeBh7owzVBV6/yjRJUZ0n9ZJdIvMJc+U05YSJXmrBdZGgY0B/FvSMQMZERYpn8gjd3UwkIhAWjoyNTOpq0/tPmTJeIOUYiF7FTZpZxSU2MSAeuvwKBJElwe94mUokl1Us/IgAxVA82vrRwER837ylmE7JF92nYhnorPmALz4uavPgVN3HoHBLHTPZPL3M/BYi9OKnM5/nGZwkzWw0Kpg/aYF7Rbgpn9wGh8qeyFWVZMWyJJLypRDhoylDCd1hVPi7nGwwB5VngFS8y2XBQdqB1PAva81p3zkvEs5tsdhFO9C25TLqlDR4nuhskPR+qSw8o30kZBG2HSQJaGAo/GFhqniM6HW12O1MY+7m/mRWqo+NrdL/avkoRmz541ZtPq64jN5Eo46clgx8oXOCymU6KPBhqfBVudfir6uujFLSi2A6cJ56CSI17EFZey+hpN4ZyDJCsNacyQ+jkGdKiFz72a3LcpuKwD1M8rKEij2ii5OyP+XN7zH6rWnFGxzcGA55Md/wXGqCsOZ+TSHN2S527a/pnWf0whSIWTuFMu5s4/CT2JBNuf22iMe0xKe8DqLTsifv4atXL4V+LTugyzIYcJ8JnDhlHvQ2d5H1Cln1ihj+ZV1+rPvKQACAILz83vDfmX8uP2R61WvVy66cIIQvKoNyVA2HPh/iFBL+JE7flCYtMPenGPN21l+ADW617iNQsFT1dY+uGbo+jQXUItJPIH0EfcJVOpriPyIGrNX6dNI0R9gClLCpWjRAfMkyZy83bMk2a3P0TVw9sk0YzMFar8FecGzbfHPaLo428H63xGpsRso+fFPfwdCSZGUQ/JPB3YRDU7fevX6YGwR/AmxTHzoxWJnv9hen1k20cGJ2bL7PO5M7U0hdYyet0RqR631VLJNBGRvsYgDoOvC2LLRzvUIVNmXHdw95cKvUFY18itDL+Trn43t/bSxE+xObEUBkrkWuJxINXxEv+5rmwR4SmzkBbJBZdu4UVhWTb1xS3QW5wFgn8KpQU3gu4OtC1lr2gqztGvqUFivoCLEbdYp0yJPiFxhQmhl7QMAHg2k5vD4vaDszvk0yLUygsgb5AbuvJcqVsoX4KkzcBxY4ZNv90rr30NUUHEIxQzSR4xxtS2B7ixT0AC9kSZMI70kfkUuo4RU6yfkGbRBONm67AeeONYZB8jWDYb1UO6fpUTP5UZsTWqiLDaMubz39ZZ+CQK6wrC8aEPZAyaAmt9q0kxByCSl/BnvTKteh68Hs0VgTSEGotleoWmGU0xQ9Fy2ZJPF3ON2MZ3dm028WHIn9FkEsoNDhsbSVCA68DpqmV2MViV51JvzAsG6UY+oN9efJEtAFIAEEJoiehgPbBQwjuu8xXiIcYitDoaOzuse8lmp8wyVcJ5DwTCmcsAFN5J2qVDWhIjH0kcAAAAuZ7gQ+WiyqpYxOY+uoK6m36Plko25yV3pj2nwLvcByi5ho5IzdiDDVP0oWHZFy1Z8wfQ8IrYFRvQg8ZkRPyjwES5+od0qzpYdTyVAlBePCzLK59zpO5xJjdbxVwpFRhK3GicnmS5uIIv34GXe7V49eY9Ver2AC4lV8/6E1fLinkxE4uyvJELMpUY7JbN4ChuRUCcSy33HfTB2Ff9oDmQ5eoYEyqPltC+WYoCEB6BNArWtrp5YpGP5leLf63oz8yDeU4HGq+93snchrAM2DgXpvHXzKLHM9M8hqTLlx3yjur5NRRNMFEGJi+dxUeCWjb+vXSyZEz8zBpyatU++97+J9nffbmXYOvUyBrofwRqauT3PBsgurXfJsmAcTBtjnL/G5kwKpF9VcIM8Hgw2xJ1m3Rkz99IfV2Yq/M2nktoGEfVigwJYtHlcS5aNVLF80JfJUgIxhsRiv5VImZtssqrMgQorVhNnGIVBnSzUR8/hTV+VO0o+QScZkkP8s0218Boq2NtieflDhoNMbDoedJ8CwQE1Fk7hW6JfTtXUwsYANzOPqI4GfwOSQn9EWf4X0H4t57msPGy6G1o9y4SVBwCTjTBDK9y2CSA3HXYLDfIMr9INUyCicPS7sK9QuKWR12n21eHUQcvCxMhSax2PT+dJ5QXj+41IbtASH1ArUyD+NhUchpMlJj2qTT5Igf6mlfo41XEmvhJ6hNxWlq06hy7mUvE5OgD0yoWz7edS6si0kkPikQ4U6FBH5AF87yvCr/o7oXZFbZp4BtVx1UVfJxiVQCYomYVJYxYw7ip8w+Dt7PNzlSW3c48XB+R6G5S8rC0udDnx5ObxLdc22XsF7KRqYDZr+lmw3W1JtpKSUnwtfkZcqXBWpdXLq2ro+xaEH9E2E4iGivP/FqNDIq01az40/Dcl6h4PQqio8CqHft4jHj9wpW3yaxtDfDECPgSi1KisA9YEl/Ydc5YB693d4EJ8eNLDiEc9SGQr5Yq9iTtnZW7LrAIW6ZKzCR+yy+QU+S/lJhFKAOc+X3/wQiQov/W/+A6HuXpv2YaLrXR+HAb2KnoGcMEUbkpVeXRMAzTuWM6ATPqfxwuplUoVxm7SRhTrXLAAAAFtL8w8O9pJ0Z+f4XdgH1MYbtOarSnG1h6nWfJBaacZVhNQMOq8lOcSS5p+8bgiZ0lmQzJCC0M/VKU6n3oviXLrZP7DXbPfNjD2slmxlnzkeV7/wi2TRekm1ezawF3HMzAo7DQQ3ZaK27hIYRoRwXU/QUlBN/wu/0TvzbPOSTt3oPLlrFwldHrpTkSu678KnrOyvrOmnKBs1BWcEJ26TfuYNagBVTjdVo4zNRizgNH0+NJDFL6kVeQvFzBj0pAciCt96zix8JDIi+Yux+geGB2oTIOjBE2ECbQLpi0ef0Q2RtdbG1ShrEoCtPIjiPApxeLodi8ioL/wP5FnDm5PeLLzgkeQ62IFbC1YqIChPmJ4OakTpgoAibetTTyXkBfarEKZdt1EQiVb4WAwUlHPVaHY67quLDUYNcw6C7oATE9fRebyv0eYe370dp2fne34LlPFhadYAAAAAA==",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:U,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"不带 = 代表根据前缀匹配，后面可以是任意路径。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:F,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这里的 $uri 是取当前路径。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:L,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:C,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后如果想支持正则，就可以加个 ~。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:Q,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这里的正则语法不难看懂，就是 /333/bbb 开头，然后中间是任意字符，最后 .html 结尾的 url。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:B,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:S,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"但是它是区分大小写的，比如这样就不行了："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:q,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"换成小写就可以："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:I,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"如果想让正则不区分大小写，可以再加个 *"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:N,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"试一下："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:D,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:Z,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"任意的大小写都是可以的。"}),"\n",(0,i.jsx)(e.p,{children:"此外，还有一种语法："}),"\n",(0,i.jsx)(e.p,{children:"在配置文件加上这个配置："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"location /444 {\n    default_type text/plain;\n    return 200 'xxxx';\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:G,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这时候就有两个 /444 的路由了："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:T,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这时候浏览器访问，还是匹配上面的那个路由："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:z,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"如果想提高优先级，可以使用 ^~"}),"\n",(0,i.jsx)(e.p,{children:"改成这样："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"location ^~ /444 {\n    default_type text/plain;\n    return 200 'xxxx';\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这时候同一个 url，匹配的就是下面的路由了："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:k,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"也就是说 ^~ 能够提高前缀匹配的优先级。"}),"\n",(0,i.jsx)(e.p,{children:"总结一下，一共 4 个 location 语法："}),"\n",(0,i.jsx)(e.p,{children:"location = /aaa 是精确匹配 /aaa 的路由。"}),"\n",(0,i.jsx)(e.p,{children:"location /bbb 是前缀匹配 /bbb 的路由。"}),"\n",(0,i.jsx)(e.p,{children:"location ~ /ccc.*.html 是正则匹配。可以再加个 * 表示不区分大小写 location ~* /ccc.*.html"}),"\n",(0,i.jsx)(e.p,{children:"location ^~ /ddd 是前缀匹配，但是优先级更高。"}),"\n",(0,i.jsx)(e.p,{children:"这 4 种语法的优先级是这样的："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"精确匹配（=） > 高优先级前缀匹配（^~） > 正则匹配（～ ~*） > 普通前缀匹配"})}),"\n",(0,i.jsx)(e.p,{children:"我们现在是直接用 return 返回的内容，其实应该返回 html 文件。"}),"\n",(0,i.jsx)(e.p,{children:"可以这样改："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"location /222 {\n    alias /usr/share/nginx/html;\n}\n\nlocation ~ ^/333/bbb.*\\.html$ {\n    alias /usr/share/nginx/html/bbb.html;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"都是能正确返回对应的 html 的："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:Y,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"前面用过 root："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:J,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"root 和 alias 有什么区别呢？"}),"\n",(0,i.jsx)(e.p,{children:"比如这样的两个配置："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"location /222 {\n    alias /dddd;\n}\n\nlocation /222 {\n    root /dddd;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"同样是 /222/xxx/yyy.html，如果是用 root 的配置，会把整个 uri 作为路径拼接在后面。"}),"\n",(0,i.jsx)(e.p,{children:"也就是会查找 /dddd/222/xxx/yyy.html 文件。"}),"\n",(0,i.jsx)(e.p,{children:"如果是 alias 配置，它会把去掉 /222 之后的部分路径拼接在后面。"}),"\n",(0,i.jsx)(e.p,{children:"也就是会查找 /dddd/xxx/yyy.html 文件。"}),"\n",(0,i.jsxs)(e.p,{children:["也就是 我们 ",(0,i.jsx)(e.strong,{children:"root 和 alias 的区别就是拼接路径时是否包含匹配条件的路径。"})]}),"\n",(0,i.jsx)(e.p,{children:"这就是 nginx 的第一个功能：静态文件托管。"}),"\n",(0,i.jsx)(e.p,{children:"主配置文件在 /etc/nginx/nginx.conf，而子配置文件在 /etc/nginx/conf.d 目录下。"}),"\n",(0,i.jsx)(e.p,{children:"默认的 html 路径是 /usr/share/nginx/html。"}),"\n",(0,i.jsx)(e.p,{children:"然后来看下 nginx 的第二大功能：动态资源的反向代理。"}),"\n",(0,i.jsx)(e.p,{children:"什么是正向、什么是反向呢？"}),"\n",(0,i.jsx)(e.p,{children:"从用户的角度看，方向一致的就是正向，反过来就是反向。"}),"\n",(0,i.jsx)(e.p,{children:"比如这样两个代理："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:P,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"第一个是正向代理，第二个是反向代理。"}),"\n",(0,i.jsx)(e.p,{children:"第一个代理是代理的用户请求，和用户请求方向一致，叫做正向代理。"}),"\n",(0,i.jsx)(e.p,{children:"第二个代理是代理服务器处理用户请求，和用户请求方向相反，叫做反向代理。"}),"\n",(0,i.jsx)(e.p,{children:"测试 nginx 做反向代理服务器之前，我们先创建个 nest 服务。"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"npx nest new nest-app -p npm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:w,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"把服务跑起来："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"npm run start:dev\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:v,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["浏览器就访问 ",(0,i.jsx)(e.a,{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:3000"})," 看到 hello world 就代表 nest 服务跑成功了："]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"添加一个全局的前缀 /api"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:X,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"改下 nginx 配置，添加个路由："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"location ^~ /api {\n    proxy_pass http://192.168.1.6:3000;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"这个路由是根据前缀匹配 /api 开头的 url， ^~ 是提高优先级用的。"}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["然后你访问 ",(0,i.jsx)(e.a,{href:"http://localhost:81/api",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:81/api"})," 就可以看到 nest 服务返回的响应了："]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"也就是这样的："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"为什么要多 nginx 这一层代理呢？"}),"\n",(0,i.jsx)(e.p,{children:"自然是可以在这一层做很多事情的。"}),"\n",(0,i.jsx)(e.p,{children:"比如修改 header："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:E,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"在 nest 服务的 handler 里注入 headers，打印一下："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:M,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后浏览器访问下。"}),"\n",(0,i.jsx)(e.p,{children:"直接访问 nest 服务的话，是没有这个 header 的："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:u,alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:m,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"访问 nginx 的反向代理服务器，做一次中转："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:o,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这就是反向代理服务器的作用，可以透明的修改请求、响应。"}),"\n",(0,i.jsx)(e.p,{children:"而且，还可以用它实现负载均衡。"}),"\n",(0,i.jsx)(e.p,{children:"在 controlller 里打印下访问日志："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:g,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"把 nest 服务停掉，然后重新 npm run start"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:b,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"3001 和 3002 端口各跑一个："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:f,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"浏览器访问下，都是正常的："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,UklGRswPAABXRUJQVlA4IMAPAADQWwCdASpQArYAPp1MoU0lpCMiIdXJQLATiWlu/HyZGuqEyP1N/sXax/jvDvxY+6/cH168n/mP8d5ofyf7r/oPzB9Wv+B4R/Eb/M9QX8j/n/+v3k/ZPML91Psv/I8P3Ug7/f9P3AP5j/b/+B5X3gmeN+wT/SP75+x/sMf+P+z9Af1h7CH6/78OJW5x3OO5x0m4dd7dljiLsoDKdkZxwWTWT9sSwTTmLNRN2QccSEzXU/1gZP3hKJ+gTm6pXTZTYDnnVOfMXymO2oc6bZdO1D5VT+cU5PA2b1O+lEB4+L+2BMXvx6C7s6WV9y++o4YMRprPaW83zapoYUM9DCxEgKqyKQi2GxcBmp1S22hEFEaNYTk8RR4bEz0GVXxagC3BAg4k2qGH9kqElZvY9jnzjTNhKIDdIuSBFmmSxPJpsJxbcUl0OzeMFX63s+p1aXCqlS0G3cScvIW6hOP6uX6cs3Hp2W+qvtI3raNgZCQhywZrO41O9pV23ryYIrkwZLukksitw7qwMZXFAjkNrvSPzpkschKqNOcDTJQm/1wv2EK2OvoTou9jF25RMl8VlGmVG13qhI4L75hyvJJQKKfQegp5Cw8rFL7sfAwFgZSFm17clV+e3JVfntv/ml7clUkdzjucdzjucdzjucdzjucdzbadxFg+mhetQ4Cg7T3XEjje9oKrmmL3KTnxNwJUNWr3aw5+O6JeWUKm/7mZqnWrAskR+wjE/kFPaZ7TPZvfC+ShSDCk9KSZYAdsw741Ly19Z8H/gEENwwN/tb3gzQm+zx+rO6AsTql0YHb97oPQC/q2xG56g/zsAFC+t0Heg/4Hc47nHc47nHc47nHesdzjucdzjucdzjucdzjucdzjucdzjucdzjucdzjucdzjucdzjucdzjucdzjFMGs+DHblZvmKzYdKq9+78BV19HQ8daaMrHqjtwgharcFLRfzUSTkMZc9MXPkjYv8DucdzjucdzjucdzjucdxgAD+/wRCUk3Dqk3k9pybstCJ4o14NBU18VFGvBoKmvioo14NBU18VEttVAQtG3L0tq8CdlKAc18h9j+iULGw16L2AhQ7fbkFjNYEeOnJEhk0g90C6qTHY2SGitLlcFRLeKH5h98HUTsQnlpUrZg1qwrUm7CUvTsu2b+lRTf6X+3/2Xu0KsRpzC2gIUaZvjkB02EXBKnLqrJUBYflaKl5P/Y8P9nIZcffTcMMyoPlTpIQYfSLv3yRLmRBLrDfmhtXBqQSwtk1prcE1NGENzJ6DcLvO5KCsSWGnvgnEq8j7LcgOwVIu0D6gT6hkzRW7WL63LYRma5Bi06xMTtaTetBs/1/5OmCfw3VkzgbkBjQsCVSPEPEZ2wV7zkK0DmrkKKgqkNPHxavWjvQawUm8IaYDRRXjamMKNOVf9A1UxQb35Oc1K5vcjl1VP1ad4kNWOv8hc9aF7oQMAiEAAUhxLbTNO9MZN7+xcOcYZKvXlt4Qxs6BAVPA4eeXpDLln2P03jAwG1O9zAOJp4UepuKL6kIB46OiTYeOqbeSKfzGn8CUMbjrKd/N61DbD7ve+L9Y/WbXSPTiGWszdE6OUIh+UnqvIw/f7R/5/+rmcvhc89N3I7MWGgoD2UvHnf+BvGMHPrPT6u/NWWD5R4wZQCacsA92tb7xCku5Ouw5Sc74rd68ThaPOTngmjgvFEBEWp2kur736DLZHIzd/9dF4t4Y63hplrc+DWIBBuoVEIGnqnr/AcZAi2Bhqsq5828d6nWVlRANYsIXY4YjpyVz8VS8ZPoCvboLD8ONcSL+5MPhzF0ARycU0LeqqaHaOgrETHskeW7BE6bW6P5OB8uJYoDtesdy+7jPIEO2ktAVEly4MG94srCYYcPibVGkBIU17YJ5iqne+vxfE0V/cBFWIJ8dkbPgrgJraS+WBRgbsTe6hm8rxTiB9Mjhyia8zFGqE+ZcoyyONaf3V60b40HUBqHkE11T6kPn8QcUCBBL+PlIP8nF+X5Jscbd88MoXcPo4MKyBm0hpg/tAgpETvdBfND0KVZeknANNaZC6srYdJZssNKbcgIxv7lTAPYrd3dKGXwW03JWeI70drsx+FukUntW6G+9+/JQq/G6ugMVn16lxZ+YnP9mfGdv7lZdmHtzfZAfQsFTtcyMYIBzOzyDgFFJq9fgtrXBXFLGRuRGRFCl7QSZn8f1zOEZLOtiPErplpDpEJm7ip8ZVP8l5VV9e5j9kADbg/jiOHPhK/WbE2PTBVw8c2XtqolLGo7sk4YHvsOBQRSQiHFJcaF8SB5CJ13EIrCmu43ff6e9YGAcNipaPFuow2mDB3nRNNqVxOUn7rdVzHvri6bOjAMdJryfODrJDLX0/+wfBXoErcq+gU3isjxK8qtkV2ByDhSoOA2Qpc4/9bkZcjT9qPhiQKg27KWqNj9TIoEiRQkQNY4/JWf4JyVYTm2nHUfMMeDb6C8R/Hc0BccXBmT76SDb3ZD41g3ZgLeZ6dyooP2JoNa6n5OguEVjoPa0g4ntLz+EEz9g64ThOkgmkRK7pIcCdnC+Hykoum/uQPnPc6BZLLAhi9QL/U7Rv8pULVQkvvP3UOUonXcYjnLs8meKPidfztIlxCyMn34m2oSfGaXKEtYrGNU6Yza32Q2ecZxx0FfEygTZCrAoSLroEwyJnvROJKjXeKk7i8ODkNgugGPt9HV9BozJCAYsdYHpzkNQCQES4YwbTyXj/dCi/1ft8WhGyRUgtz+/OOzjvPvBk2gxrYgYz460Lic5RnN7kLt8FtTDd5vgUUUIANo8jSZIZvb2ewO20q+sCdmOrJZprjjZPej5OwGZfZ6iMz0L/55q2Or5Qk7CUGZ10iid8vnwEgsMuvZ9D+qNRrYaQ2J20lRMNgo4AkgRCwyhbKUfiVMJpaS8oXFRMYnIz62j4anhX7n1nk1BkQD5sfy9w1RCU6/eD34rd/xuZ20yQlk/I5tZl2bJkKfsyEWWpSmEJOu/PS5Wm9gVtW/lf+UIoEII+NZmneje09GluoI+C2frUNJXw3SZma23DOEcc7CG4e999eyN8vtg0qK5LqMyXrsW+EPWqm5dcrG2zlQ5Ish7nNrYE/fofIOHO2GIbzV6ZP84DBbONXNWPygiXKI4pvg72IMqPpEXFRuRhYz1wslkzlhLc1USCapYQdhspZYOs1i+xhfejVhXXPAqtHpCvCOxG/fq3SdqY5DLmXFCvTkFbjJNR9btk1OhtmDo9e3DzSDLAus8uONVX59PEl59ECcoSotucT3DQO0eFezP99Sq8gZg5w2jM5eDUyD+RmgxgLOw6DwFZ1m39uDmbVD6mXt9+ZWxbmzXIorIUDT7Ewcnol6V+zmQQFfT3xBWTSI29sZ6797VKJidtd9Pkv/b828ovelD3kJ3DPw+gIUZNSqDliFizv3i0FyOFqttJIIdMRmdc/IQElhgFvaoPLs4M2uKY6yJEiRkE1XEtVi1im0wBMGzkLh7XgPxPw3H0hLJeivQAAADrs/mS/XM7VhSk6Op2Jn4/15PHSvuBv9tDL8KeDzaDjPIe1E4EH/T8aqDEp4LVQqeVbBf8wIihPs39iRQ3EmJC6BrElJPMjSj/jMTEY81h+vuh3jkt387fWR2fGqi4/1oTqxzdYRZAyZ6mc0oPIDyINo0qgYTfYgh1UICzKvNNttntNBXQ581aLjSUFhHnwA5BM6AKmHchMcYxM9wf8xz+L1UfLKV/0ObFx0wGI76yAvYEyqZ9vrS0r4LQZ2/qTyYpnzLvvB33Kh8kNaUZ39RcYJK0fhtP4zPYT0eZPSgr/wssNsMjY0+WeAntupUl+nyawwE++TTl+r6EjfprjTiHG3PimOyCbNQg3TS2wtJn117CS9GxtN8OTv/l68WAR9Qu42gewNR1m1V/N5g2YhXqy4SOOrHfbTgdSpTq0D8yKp3FHVq5Rr1KMpZR13F2NWQ4j0FRUxIdpRRxTZIpXcTvVI/azfURFv6WEABlkqL+XCuFxhY9KhNvMigNEVAqQepRffmHEDTuyH8c7W76Lk5mEW8tiHc75XmQi9W4nCrh+03UaZKjEE+nGfJ4MC9bsBM9rFxm2t8+OwWRjafgJx1holBPzpT17V5XaZznLRF0vZFBvf8Eod7Z/6aqLj/WhOrHlLleJkaJXlCJQAEebVE0+uvUBpp5S34HSUkopxn8HSefgmWKaZr+uilCWI+gbWgZk2IvG5cKJsHQAPPDoPTpsadHjv/UGf9/wO+QPydpmyJzBmEPAAq1XSoxL7Tuvan0Vu1sbtHDG23cXsr+C7EF260yPxs8t1Uph3LLWua7DJ6M5DcAOvrWZWxtKYCrFXs52RuERGPUh8Lf3/dXzvPiujnwb0GJSylfkXN+K+ePG/CA6AKsmDa8uVsPWSU+ldDfgMyOVtyPNYI0NZuErLYvltuvf4YkZVTwf3FSuP9zl5v0udKP9nLvZwkBE410j3bYg7vAlxjv2wSW+ZWxqxUEvd79EmmyMQ9AUgE5fPARuKkOYLlgXgfKHUQa0vN6xHHMPr/3GhhzbNymL7X7+yo/63zV0Qn6K+a2bl614zRMQ1hfhuPdlNZDcafnJpKcrUSk5obyfJDQC4zDBViyY0Gkygcq2fgonmpTK1IrGFOLEckrDfn/Uqxce/va7QG/riP+lWtvSBeC2dP5nfK69A3um14/q9U2y9QrRUo+u3LRctDhwcuEJyadlNOcZfLZH2BwvR4oHtqtcX6hP0LqYE+SP4pB+/wKTc1eY+U+5nCOgQOjk1BW0sZaVclR0R/O2U6c4Zb7Axf1KcbGjOuSSrrwfZ1LN/Qh59K/uDG44dBYJvBqKWml16IeVPwDuN5joxsO+zWuf/KSyhwT+/tb5UzkPkwfjuXfB+3OjkT9cIc966SNuR+7zQB7qaoLhAfloczFxGOGFZjtu+PJj5IAAAAAAwWZraZaX2bH66eUEypEb5uLEduweL9EhCfUPNAOvtsAaG7Ur4qPhb3tCBrzIqslZ6237TJbsx02Nyl9nkkNq/lNyRvF7N7c7bEC5xncJAsTnXUvsTwXkklcfEr1F6Pi5IgmY84mB3v7eQhCX2kOY+uQYIe8Xicfs3SuSRke8uAD+5paDeYCTVI6EuAj+PzIWpb1idgr19OpYXn80E4AlokHYJ/8uUKFMhiFfwI0gtuxTqeiDRYYNoiYmpqQ6KadhU/dwSrGF5LGbDlhU4PYYd2q8i4t1GVGBteMzFx3U0C3sO8Z78nA6cwg18VMXzkqFmtoOovmEDySFUmANhuYByIjs1/g8P6JwyTH27PIEmtjgS9fDYyj3dOx/wOfxBCSXHn8gCu+28KoofeQU+tcY5OQJXI7pelmsy75IbZmgJ4UpgcMKXU4y7b/8mKmDw2AAAAAA=",alt:""})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"控制台也打印了访问日志："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:A,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"问题来了，现在有一个 nginx 服务器，两个 nest 服务器了，nginx 该如何应对呢？"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:j,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"nginx 的解决方式就是负载均衡，把请求按照一定的规则分到不同的服务器。"}),"\n",(0,i.jsx)(e.p,{children:"改下 nginx 配置文件："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:h,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"在 upstream 里配置它代理的目标服务器的所有实例。"}),"\n",(0,i.jsx)(e.p,{children:"下面 proxy_pass 通过 upstream 的名字来指定。"}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["这时候我访问 ",(0,i.jsx)(e.a,{href:"http://localhost:81/api",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:81/api"})," 刷新 5 次页面："]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:"data:image/webp;base64,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",alt:""})}),"\n",(0,i.jsx)(e.p,{children:"可以看到两个 nest 服务，一个 3 次，一个 2 次。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:t,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"因为默认是轮询的方式。"}),"\n",(0,i.jsx)(e.p,{children:"一共有 4 种负载均衡策略："}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"轮询：默认方式。"}),"\n",(0,i.jsx)(e.li,{children:"weight：在轮询基础上增加权重，也就是轮询到的几率不同。"}),"\n",(0,i.jsx)(e.li,{children:"ip_hash：按照 ip 的 hash 分配，保证每个访客的请求固定访问一个服务器，解决 session 问题。"}),"\n",(0,i.jsx)(e.li,{children:"fair：按照响应时间来分配，这个需要安装 nginx-upstream-fair 插件。"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"我们测试下 weight 和 ip_hash 的方式。"}),"\n",(0,i.jsx)(e.p,{children:"添加一个 weight=2，默认是 1，这样两个服务器轮询到的几率是 2 比 1。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:p,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"按 command + k，把 nest 服务的控制台日志清空下："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:s,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["然后我访问了 8 次 ",(0,i.jsx)(e.a,{href:"http://localhost:81/api",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:81/api"})]}),"\n",(0,i.jsx)(e.p,{children:"看打印的日志来看，差不多就是 2:1 的轮询几率。"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:x,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这就是带权重的轮询。"}),"\n",(0,i.jsx)(e.p,{children:"我们再试下 ip_hash 的方式；"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:a,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"然后复制到容器里，并 reload："}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"docker cp ~/nginx-html/conf.d/default.conf nginx1:/etc/nginx/conf.d/default.conf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:r,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"按 command + k，把 nest 服务的控制台日志清空下："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:s,alt:""})}),"\n",(0,i.jsxs)(e.p,{children:["再次访问了 ",(0,i.jsx)(e.a,{href:"http://localhost:81/api",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:81/api"})]}),"\n",(0,i.jsx)(e.p,{children:"可以看到一直请求到了一台服务器："}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)("img",{src:l,alt:""})}),"\n",(0,i.jsx)(e.p,{children:"这就是 Nginx 的负载均衡的策略。"}),"\n",(0,i.jsxs)(e.h2,{id:"总结",children:["总结",(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,i.jsx)(e.p,{children:"我们通过 docker 跑了 nginx 服务器，并使用了它的静态资源托管功能，还有动态资源的反向代理功能。"}),"\n",(0,i.jsx)(e.p,{children:"nginx 的配置文件在 /etc/nginx/nginx.conf 里，它默认还引入了 /etc/nginx/conf.d 下的子配置文件。"}),"\n",(0,i.jsx)(e.p,{children:"默认 html 都放在 /usr/share/nginx/html 下。"}),"\n",(0,i.jsx)(e.p,{children:"我们可以通过 docker cp 来把容器内文件复制到宿主机来修改。"}),"\n",(0,i.jsx)(e.p,{children:"修改 nginx 配置，在 server 里配置路由，根据不同的 url 返回不同的静态文件。"}),"\n",(0,i.jsx)(e.p,{children:"有 4 种 location 语法："}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"location /aaa 根据前缀匹配"}),"\n",(0,i.jsx)(e.li,{children:"location ^~ /aaa 根据前缀匹配，优先级更高"}),"\n",(0,i.jsx)(e.li,{children:"location = /aaa 精准匹配"}),"\n",(0,i.jsx)(e.li,{children:"location ~ /aaa/.*html 正则匹配"}),"\n",(0,i.jsx)(e.li,{children:"location ~* /aaa/.*html 正则匹配，而且不区分大小写"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"优先级是 精确匹配（=） > 高优先级前缀匹配（^~） > 正则匹配（～ ~*） > 普通前缀匹配"}),"\n",(0,i.jsx)(e.p,{children:"除了静态资源托管外，nginx 还可以对动态资源做反向代理。"}),"\n",(0,i.jsx)(e.p,{children:"也就是请求发给 nginx，由它转发给应用服务器，这一层也可以叫做网关。"}),"\n",(0,i.jsx)(e.p,{children:"nginx 反向代理可以修改请求、响应信息，比如设置 header。"}),"\n",(0,i.jsx)(e.p,{children:"当有多台应用服务器的时候，可以通过 upstream 配置负载均衡，有 4 种策略：轮询、带权重的轮询、ip_hash、fair。"}),"\n",(0,i.jsx)(e.p,{children:"掌握了静态资源托管、动态资源的反向代理+负载均衡，就算是掌握了 Nginx 的核心用法了。"})]})}function nj(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,d.ah)(),n.components);return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(nh,{...n})}):nh(n)}let nA=nj;nj.__RSPRESS_PAGE_META={},nj.__RSPRESS_PAGE_META["Nest%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%20%20%E6%9C%80%E6%96%B0200%E7%AB%A0%2F79.%20%E5%BF%AB%E9%80%9F%E6%8E%8C%E6%8F%A1%20Nginx%20%E7%9A%84%202%20%E5%A4%A7%E6%A0%B8%E5%BF%83%E7%94%A8%E6%B3%95.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"79. 快速掌握 Nginx 的 2 大核心用法",headingTitle:"79. 快速掌握 Nginx 的 2 大核心用法",frontmatter:{}}}}]);