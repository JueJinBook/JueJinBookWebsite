"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["53250"],{291674:function(e,n,s){s.r(n),s.d(n,{default:()=>l});var r=s(552676),i=s(740453);let h=s.p+"static/image/05267942aa09c36fe04ce7a81e4aed42.f4e6fa57.png",c=s.p+"static/image/b78b63ec39e5adef959f940d094c7645.c8fb6c46.png";function d(e){let n=Object.assign({h1:"h1",a:"a",p:"p",strong:"strong",h2:"h2",h3:"h3",h4:"h4",pre:"pre",code:"code",ul:"ul",li:"li",img:"img",blockquote:"blockquote"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"30云数据库基础知识",children:["30.云数据库基础知识",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#30云数据库基础知识",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"任何"}),"一个大型的应用程序和服务，都",(0,r.jsx)(n.strong,{children:"必须"}),"会使用到",(0,r.jsx)(n.strong,{children:"高性能的"}),"数据存储解决方案，用来",(0,r.jsx)(n.strong,{children:"准确"}),"、",(0,r.jsx)(n.strong,{children:"快速"}),"、",(0,r.jsx)(n.strong,{children:"可靠"}),"地",(0,r.jsx)(n.strong,{children:"存储和检索"}),"用户的账户信息、商品以及商品交易信息、产品数据、资讯文章等等，而云开发就自带高性能、高可用、高拓展性且安全的文档型数据库。"]}),"\n",(0,r.jsxs)(n.h2,{id:"51-云数据库基础知识",children:["5.1 云数据库基础知识",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#51-云数据库基础知识",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"511-云数据库的基础知识",children:["5.1.1 云数据库的基础知识",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#511-云数据库的基础知识",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"1云数据库与excelmysql的对应理解",children:["1、云数据库与Excel、MySQL的对应理解",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1云数据库与excelmysql的对应理解",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"我们可以结合Excel以及MySQL（之前没有接触过MySQL也没有关系，只看与Excel的对应就行）来理解云开发的数据库。"}),"\n",(0,r.jsxs)(n.p,{children:["在操作数据库时，我们要对",(0,r.jsx)(n.strong,{children:"数据库database"}),"、",(0,r.jsx)(n.strong,{children:"集合collection"}),"、",(0,r.jsx)(n.strong,{children:"记录doc"}),"以及",(0,r.jsx)(n.strong,{children:"字段field"}),"要有一定的了解，首先要",(0,r.jsx)(n.strong,{children:"记住这些对应的英文单词"}),"，当你要操作某个记录doc的字段内容时，就像投送快递一样，要先搞清楚它到底在哪个数据库、在哪个集合、在哪个记录里，一级一级的去找。操作数据库通常都是对数据库、集合、记录、字段进行",(0,r.jsx)(n.strong,{children:"增、删、改、查"}),"，而增删改查则是对应数据库的请求。比如下面是更新某个字段的值："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"wx.cloud.database().collection('集合名').where({\n  _id:'记录的id'\n}).update({\n  \"字段名\":\"字段值\"\n})\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"2集合的创建与数据类型",children:["2、集合的创建与数据类型",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2集合的创建与数据类型",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"云开发数据库支持的数据类型有字符串String、数字Number、对象Object、数组Array、布尔值Bool、时间Date、多种地理位置类型Geo以及Null。"}),"\n",(0,r.jsxs)(n.p,{children:["我们现在来创建一个",(0,r.jsx)(n.strong,{children:"books"}),"的集合（相当于创建一张Excel表），用来存放图书馆里面书籍的信息，比如这样一本书："]}),"\n",(0,r.jsx)(n.p,{children:"打开云开发控制台的数据库标签，新建集合books，然后选择该集合，给books里添加记录（类似于填写Excel含字段的第一行和其中一行关于书的信息记录），依次添加字段："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"字段名：title，类型：string，值：\xa0JavaScript权威指南(第6版)"}),"\n",(0,r.jsx)(n.li,{children:"字段名：author，类型：string，值：弗兰纳根(David Flanagan)"}),"\n",(0,r.jsx)(n.li,{children:"字段名：isbn，类型：string，值：9787111376613"}),"\n",(0,r.jsx)(n.li,{children:"字段名：publishInfo，类型：object"}),"\n",(0,r.jsx)(n.li,{children:"然后我们再在publishInfo的下面（二级）添加字段press，类型为string，值为：机械工业出版社；year，类型为number，值为：2012"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["我们可以依照这个方法创建更多的记录，也可以给该记录添加更多字段。以上记录在云开发控制台的效果如下：\n",(0,r.jsx)("img",{src:c,alt:"云开发数据库"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["如果我们创建记录时，没有指定_id字段的值，后台会自动生成一个",(0,r.jsx)(n.code,{children:"_id"}),"，如果指定了 _id的值，该值就不能和当前集合下已有的记录冲突，也就是",(0,r.jsx)(n.code,{children:"_id"}),"需是独一无二的，类似于MySQL里的primary key。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"512-数据库的导出与导入",children:["5.1.2 数据库的导出与导入",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#512-数据库的导出与导入",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"1数据库的导出",children:["1、数据库的导出",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1数据库的导出",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["云开发数据库支持用",(0,r.jsx)(n.strong,{children:"json"}),"和",(0,r.jsx)(n.strong,{children:"csv"}),"文件的方式导出和导入数据。比如我们将上面的创建的数据以json的形式导出，结果大致如下："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'{\n  "_id": "7853e7b85ee9665a00069fb805e816d1",\n  "author": "弗兰纳根(David Flanagan)",\n  "isbn": "9787111376613",\n  "publishInfo": {\n    "press": "机械工业出版社",\n    "year": 2012\n  },\n  "title": "JavaScript权威指南(第6版)"\n}\n{\n  "_id": "7853e7b85ee9665a00069fb919c91ca1",\n  "author": "泽卡斯(Zakas. Nicholas C.) ",\n  "isbn": "7115275793",\n  "publishInfo": {\n    "press": "人民邮电出版社",\n    "year": 2012\n  },\n  "title": "JavaScript高级程序设计(第3版)"\n}\n{\n  "_id": "7853e7b85ee9665a00069fbb3aaef4d6",\n  "isbn": "9787121198854",\n  "publishInfo": {\n    "press": "电子工业出版社",\n    "year": 2013\n  },\n  "title": "高性能MySQL（第3版）",\n  "author": "Baron Schwartz，Peter Zaitsev，Vadim Tkachenko"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["为了方便大家阅读与编辑json文件的内容，推荐大家使用Visual Studio Code编辑器。使用VS Code编辑器打开json文件，发现数据的内容与写法我们都比较熟悉，各个记录对象之间是使用回车分隔，而不是逗号",(0,r.jsx)(n.code,{children:","}),"，这一点需要大家注意。"]}),"\n",(0,r.jsx)(n.p,{children:"数据库还支持CSV的导出，那对象里的字段应该怎么导出呢，我们可以使用点表示法，比如上面的数据，我们在导出CSV的时候，可以在字段里填写如下内容："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"_id,isbn,title,author,publishInfo.press,publishInfo.year\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"2数据库的高级操作",children:["2、数据库的高级操作",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2数据库的高级操作",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在我们做数据库的开发学习时，如果创建记录是像之前在控制台一个字段一个字段的添加，非常的繁琐且不方便，这时推荐使用控制台数据库的",(0,r.jsx)(n.strong,{children:"高级操作"}),"，高级操作支持数据库的增删改查以及聚合等操作。"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)("img",{src:h,alt:"云开发数据库的高级操作"})}),"\n",(0,r.jsxs)(n.p,{children:["在控制台数据库管理页中可以编写和执行数据库脚本，这些脚本的语法会跟我们之后会学习的SDK 数据库语法一样，可以作为我们",(0,r.jsx)(n.strong,{children:"日常“调试”数据库的一种基础方式"}),"，也就是我们可以把这个作为类似于控制台console一样。"]}),"\n",(0,r.jsxs)(n.h4,{id:"3json文件的导入",children:["3、json文件的导入",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3json文件的导入",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"在调用数据库之前，需要先有一个比较贴近实际的数据库案例，为此我们把知乎日报apid的数据整理出了一个json数据库文件。"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"数据库下载："}),(0,r.jsx)(n.a,{href:"https://tcb-1251009918.cos.ap-guangzhou.myqcloud.com/data.json",target:"_blank",rel:"noopener noreferrer",children:"知乎日报文章数据"})]}),"\n",(0,r.jsxs)(n.p,{children:["右键点击链接，将data.json存储到电脑。打开云开发控制台，在数据库里新建一个集合",(0,r.jsx)(n.strong,{children:"zhihu_daily"}),"，导入该json文件，导入时会有冲突模式选择，看下面的介绍，推荐大家使用upsert："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Insert：总是插入新记录"}),"\n",(0,r.jsx)(n.li,{children:"Upsert：如果记录存在则更新，否则插入新记录"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["导入后，发现数据库自动给每一条数据（记录）都加了唯一的标识 ",(0,r.jsx)(n.strong,{children:"_id"})," ，"]}),"\n",(0,r.jsxs)(n.h4,{id:"4csv文件的导入",children:["4、csv文件的导入",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4csv文件的导入",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["右键点击链接另存为",(0,r.jsx)(n.a,{href:"https://tcb-1251009918.cos.ap-guangzhou.myqcloud.com/china.csv",target:"_blank",rel:"noopener noreferrer",children:"中国城市经济数据"}),"，然后在云开发控制台里新建一个china集合，将china.csv导入到集合当中，这里我们也准备了一份线上excel版本：",(0,r.jsx)(n.a,{href:"https://shimo.im/sheets/HHwXWQ9qHqvG8xDw/MODOC/",target:"_blank",rel:"noopener noreferrer",children:"中国城市经济线上excel版"})]}),"\n",(0,r.jsx)(n.p,{children:"这里创建的zhihu_daily和china集合，以及导入的数据，在我们后面的章节学习里会使用到。"})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}let l=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5%2F30.%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md"]={toc:[{text:"5.1 云数据库基础知识",id:"51-云数据库基础知识",depth:2},{text:"5.1.1 云数据库的基础知识",id:"511-云数据库的基础知识",depth:3},{text:"1、云数据库与Excel、MySQL的对应理解",id:"1云数据库与excelmysql的对应理解",depth:4},{text:"2、集合的创建与数据类型",id:"2集合的创建与数据类型",depth:4},{text:"5.1.2 数据库的导出与导入",id:"512-数据库的导出与导入",depth:3},{text:"1、数据库的导出",id:"1数据库的导出",depth:4},{text:"2、数据库的高级操作",id:"2数据库的高级操作",depth:4},{text:"3、json文件的导入",id:"3json文件的导入",depth:4},{text:"4、csv文件的导入",id:"4csv文件的导入",depth:4}],title:"30.云数据库基础知识",headingTitle:"30.云数据库基础知识",frontmatter:{}}}}]);