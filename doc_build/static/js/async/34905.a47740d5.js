"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["34905"],{69514:function(n,e,d){n.exports=d.p+"static/image/0e89628b8c885dc5925221d9aa5407e6.90793e92.webp"},37365:function(n,e,d){n.exports=d.p+"static/image/718e75d8d5341f49ac84223eb50fcb0f.b13c05e5.webp"},705584:function(n,e,d){d.r(e),d.d(e,{default:()=>x});var s=d(552676),r=d(740453);let i=d.p+"static/image/31fa297e355bbc718582481fee77635e.edb602c7.webp";var h=d(37365),c=d(69514);function t(n){let e=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",img:"img",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,r.ah)(),n.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.h1,{id:"156-考试系统技术方案和数据库设计",children:["156. 考试系统：技术方案和数据库设计",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#156-考试系统技术方案和数据库设计",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"分析完需求，这节来设计下技术方案。"}),"\n",(0,s.jsxs)(e.h2,{id:"技术栈",children:["技术栈",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#技术栈",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"前端部分 React + Antd Design，脚手架用 create-vite："}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)("img",{src:c,alt:""})}),"\n",(0,s.jsx)(e.p,{children:"后端服务是 Nest + Prisma，会拆分多个微服务，之间用 TCP 通信。"}),"\n",(0,s.jsx)(e.p,{children:"数据库是 mysql + redis，mysql 做持久化存储，redis 做缓存以及临时数据的存储。"}),"\n",(0,s.jsx)(e.p,{children:"用 minio 做 OSS 对象存储服务，存储上传的文件。"}),"\n",(0,s.jsx)(e.p,{children:"用 nacos 来做注册中心、配置中心，统一管理所有的配置、服务的地址注册。"}),"\n",(0,s.jsx)(e.p,{children:"rabbitmq 做消息队列，用于微服务之间的异步通信。"}),"\n",(0,s.jsx)(e.p,{children:"文档用 swagger 生成，部署用 docker compose。"}),"\n",(0,s.jsxs)(e.h2,{id:"微服务拆分",children:["微服务拆分",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#微服务拆分",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"微服务的特点是可以独立开发、独立部署。"}),"\n",(0,s.jsx)(e.p,{children:"微服务之间通过 TCP 或者 gRPC 来做同步通信，通过消息队列来做异步通信。"}),"\n",(0,s.jsx)(e.p,{children:"我们之前分析出的四个模块，就可以拆分为 4 个微服务。"}),"\n",(0,s.jsx)(e.p,{children:"用户、考试、判卷、分析"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)("img",{src:h,alt:""})}),"\n",(0,s.jsx)(e.p,{children:"每个微服务都暴露 HTTP 接口出去，之间可以通过 TCP 来进行同步调用。"}),"\n",(0,s.jsx)(e.p,{children:"并且也可以通过 RabbitMQ 来做异步通信。"}),"\n",(0,s.jsx)(e.p,{children:"比如判卷完之后需要更新成绩排行榜，这时候就没必要同步生成，用消息队列通知分析微服务做异步生成就行。"}),"\n",(0,s.jsxs)(e.h2,{id:"数据库设计",children:["数据库设计",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#数据库设计",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"然后来设计下数据库表："}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)("img",{src:i,alt:""})}),"\n",(0,s.jsx)(e.p,{children:"需要这三个表。"}),"\n",(0,s.jsx)(e.p,{children:"用户表存储用户信息。"}),"\n",(0,s.jsx)(e.p,{children:"考试表存储考试和试卷信息，关联着创建考试的用户，多对一关系。"}),"\n",(0,s.jsx)(e.p,{children:"答卷表存储用户的答卷，和考试表是多对一关系，和用户表也是多对一关系。"}),"\n",(0,s.jsx)(e.p,{children:"也就是说一个用户可以有多个答卷、一个考试可以有多个答卷，但一个答卷只能属于一个用户、一个考试。"}),"\n",(0,s.jsx)(e.p,{children:"详细设计如下："}),"\n",(0,s.jsx)(e.p,{children:"用户表 user："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"字段名"}),"\n",(0,s.jsx)(e.th,{children:"数据类型"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"id"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"用户ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"username"}),"\n",(0,s.jsx)(e.td,{children:"VARCHAR(50)"}),"\n",(0,s.jsx)(e.td,{children:"用户名"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"password"}),"\n",(0,s.jsx)(e.td,{children:"VARCHAR(50)"}),"\n",(0,s.jsx)(e.td,{children:"密码"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"email"}),"\n",(0,s.jsx)(e.td,{children:"VARCHAR(50)"}),"\n",(0,s.jsx)(e.td,{children:"邮箱"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"create_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"创建时间"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"update_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"更新时间"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"考试表 exam："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"字段名"}),"\n",(0,s.jsx)(e.th,{children:"数据类型"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"id"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"考试ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"createUserId"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"创建者ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"name"}),"\n",(0,s.jsx)(e.td,{children:"VARCHAR(50)"}),"\n",(0,s.jsx)(e.td,{children:"考试名"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"isPublish"}),"\n",(0,s.jsx)(e.td,{children:"BOOLEAN"}),"\n",(0,s.jsx)(e.td,{children:"是否发布"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"isDelete"}),"\n",(0,s.jsx)(e.td,{children:"BOOLEAN"}),"\n",(0,s.jsx)(e.td,{children:"是否删除"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"content"}),"\n",(0,s.jsx)(e.td,{children:"TEXT"}),"\n",(0,s.jsx)(e.td,{children:"试卷内容 JSON"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"create_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"创建时间"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"update_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"更新时间"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"答卷表 answer："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"字段名"}),"\n",(0,s.jsx)(e.th,{children:"数据类型"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"id"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"答卷ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"answererId"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"答题人ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"examId"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"答卷ID"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"content"}),"\n",(0,s.jsx)(e.td,{children:"TEXT"}),"\n",(0,s.jsx)(e.td,{children:"答卷JSON"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"score"}),"\n",(0,s.jsx)(e.td,{children:"INT"}),"\n",(0,s.jsx)(e.td,{children:"分数"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"create_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"创建时间"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"update_time"}),"\n",(0,s.jsx)(e.td,{children:"DATETIME"}),"\n",(0,s.jsx)(e.td,{children:"更新时间"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"然后划分下模块："}),"\n",(0,s.jsxs)(e.h2,{id:"模块划分",children:["模块划分",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#模块划分",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"首先是用户模块，实现登录、注册、修改密码的功能："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"接口路径"}),"\n",(0,s.jsx)(e.th,{children:"请求方式"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/user/login"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"用户登录"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/user/register"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"用户注册"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/user/update_password"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"用户修改密码"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"试卷模块："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"接口路径"}),"\n",(0,s.jsx)(e.th,{children:"请求方式"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/exam/add"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"创建考试"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/exam/delete"}),"\n",(0,s.jsx)(e.td,{children:"DELETE"}),"\n",(0,s.jsx)(e.td,{children:"删除考试"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/exam/list"}),"\n",(0,s.jsx)(e.td,{children:"GET"}),"\n",(0,s.jsx)(e.td,{children:"考试列表"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/exam/save"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"保存试卷内容"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/exam/publish"}),"\n",(0,s.jsx)(e.td,{children:"GET"}),"\n",(0,s.jsx)(e.td,{children:"发布考试"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"答卷模块："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"接口路径"}),"\n",(0,s.jsx)(e.th,{children:"请求方式"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/answer/add"}),"\n",(0,s.jsx)(e.td,{children:"POST"}),"\n",(0,s.jsx)(e.td,{children:"添加答卷"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/answer/list"}),"\n",(0,s.jsx)(e.td,{children:"GET"}),"\n",(0,s.jsx)(e.td,{children:"答卷列表"}),"\n"]}),"\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/answer/export"}),"\n",(0,s.jsx)(e.td,{children:"GET"}),"\n",(0,s.jsx)(e.td,{children:"导出答卷列表为 excel"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"分析模块："}),"\n",(0,s.jsxs)(e.table,{children:["\n",(0,s.jsxs)(e.thead,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.th,{children:"接口路径"}),"\n",(0,s.jsx)(e.th,{children:"请求方式"}),"\n",(0,s.jsx)(e.th,{children:"描述"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.tbody,{children:["\n",(0,s.jsxs)(e.tr,{children:["\n",(0,s.jsx)(e.td,{children:"/analyse/ranking"}),"\n",(0,s.jsx)(e.td,{children:"GET"}),"\n",(0,s.jsx)(e.td,{children:"成绩排行榜"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"总结",children:["总结",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"这节我们设计了下技术方案。"}),"\n",(0,s.jsx)(e.p,{children:"技术栈：前端是 antd + react + vite，后端是 nest + prisma，数据库是 mysql + redis，对象存储用 minio，API 文档用 swagger 生成，部署用 docker compose + pm2，网关使用 nginx，注册中心配置中心用 nacos，消息队列用 rabbitmq。"}),"\n",(0,s.jsx)(e.p,{children:"划分了 4 个微服务：用户微服务、考试微服务、答卷微服务、分析微服务"}),"\n",(0,s.jsx)(e.p,{children:"之间通过 TCP 做同步通信，通过 RabbitMQ 做异步通信。"}),"\n",(0,s.jsx)(e.p,{children:"数据库表有 3 个：用户表 user、考试表 exam、答卷表 answer"}),"\n",(0,s.jsx)(e.p,{children:"模块有 4 个：用户模块、考试模块、答卷模块、分析模块"}),"\n",(0,s.jsx)(e.p,{children:"下节正式开始开发。"})]})}function l(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,r.ah)(),n.components);return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(t,{...n})}):t(n)}let x=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["Nest%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%20%20%E6%9C%80%E6%96%B0200%E7%AB%A0%2F156.%20%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F%EF%BC%9A%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1.md"]={toc:[{text:"技术栈",id:"技术栈",depth:2},{text:"微服务拆分",id:"微服务拆分",depth:2},{text:"数据库设计",id:"数据库设计",depth:2},{text:"模块划分",id:"模块划分",depth:2},{text:"总结",id:"总结",depth:2}],title:"156. 考试系统：技术方案和数据库设计",headingTitle:"156. 考试系统：技术方案和数据库设计",frontmatter:{}}}}]);