"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["95300"],{918150:function(e,n,a){e.exports=a.p+"static/image/0e6400ba3936a3166ea2c06df5595213.be27c895.webp"},621261:function(e,n,a){a.r(n),a.d(n,{default:()=>T});var c=a(552676),s=a(740453);let d=a.p+"static/image/8000096575c1e8f0f6bfa8f91012b17a.6f95ecae.webp",i=a.p+"static/image/753a62382b375bd1be03346bd6bd5412.792c7013.webp",l=a.p+"static/image/7d047ed02ecb4a00c05f4d5f4ecbe85d.c6b68b43.webp",r=a.p+"static/image/149e4d6203e9c0e1818beb6d2fdc9a6d.ac1c4de2.webp",x=a.p+"static/image/87140802887fcc83f7a44467e590c466.c35dbc57.webp",t=a.p+"static/image/e5a53197cc45f1b5311bdbcc1a464755.426ce0ec.webp",p=a.p+"static/image/450fa21fa0fb137c7c4b231070e68605.a72afd6d.webp",b=a.p+"static/image/d0ac787e7dfdfd9f315c05e11117f244.9f3a952e.webp",g=a.p+"static/image/1c36392d457be2cca167a458dece5106.ab90ca94.webp",j=a.p+"static/image/603e404a5ade7b4979a10f14eac3f284.97fda81c.webp",o=a.p+"static/image/0162d2e45130c06327e0ab68053a2570.62960ad4.webp",h=a.p+"static/image/826b4cf45b1f3ccc8522f337dcee2a32.7a1e96d6.webp",m=a.p+"static/image/fb0f777641083dbf17a86607aad367e2.6bd21d61.webp",f=a.p+"static/image/84109d1a7f842c27aa522be5668f2236.77d9e091.webp",u=a.p+"static/image/2aa6a0f4d7c7b9873ffef9e524f1bf5f.fb8caba3.webp",w=a.p+"static/image/f0b91ce11500060dbf2a59e51c741b21.e3b5b771.webp",v=a.p+"static/image/fb907fd6379100516e5b5e1d35feaf60.97074461.webp",N=a.p+"static/image/a74ac32b28cae83dc933cf5cc4ac5c91.88024bdd.webp",$=a.p+"static/image/1222c4cc0324a2bafdeec768dea0ee6b.72bd8272.webp",O=a.p+"static/image/4bcd706d425f964c526921ea6025d62d.733a96ef.webp",E=a.p+"static/image/e62987a44046ef227728d857c33bd851.7e255fd9.webp",M=a.p+"static/image/3c2e77073af8dc23924b96be0e2ea47f.c2a24999.webp",y=a.p+"static/image/d16e7ade0651f64299f45fae3017ee96.e99fda7e.webp",_=a.p+"static/image/3f091c8b5694886f4820ddcf9e0a6d03.b0320c13.webp",D=a.p+"static/image/4c53e8d9c078af36767f093215af64ae.d87a26d6.webp",k=a.p+"static/image/2ae9caaf97ecbca76a0ee19b2ad44843.534c33fc.webp",q=a.p+"static/image/62aa3677d599bd4e9333f24e66ae35fa.451bbadc.webp",A=a.p+"static/image/34da9688a8c9aa94c03ca3b2e57c9b8a.253e0730.webp",C=a.p+"static/image/637324c2096172df018161f26ae72ea0.977a5f85.webp",B=a.p+"static/image/0f6e299806c976933b7864b80669ff0d.fa71b6e4.webp",G=a.p+"static/image/a71611e97bbcbd64c9518115147fae30.ac2caee7.webp",R=a.p+"static/image/f4014b3f3ccf10e7dce9426c4799e8a6.7bbed09c.webp",S=a.p+"static/image/920c01b1a2f0f252b9f6f54a4e5b1104.1e72a2bb.webp";var U=a(918150);let F=a.p+"static/image/7cebf0b7e04f711adf66b9b08e5d0477.317d7a73.webp";function I(e){let n=Object.assign({h1:"h1",a:"a",p:"p",img:"img",pre:"pre",code:"code",h2:"h2"},(0,s.ah)(),e.components);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.h1,{id:"195-mongodb-快速入门",children:["195. MongoDB 快速入门",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#195-mongodb-快速入门",children:"#"})]}),"\n",(0,c.jsx)(n.p,{children:"数据库我们学习了 mysql，这节来再来学下 mongodb。"}),"\n",(0,c.jsx)(n.p,{children:"在 docker desktop 搜索 mongo 镜像，然后把它跑起来："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:F,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"指定容器名、映射的端口号，以及挂载到 /data/db 的本地目录："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:U,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"这个本地目录是本地的任何一个目录都行，用来存放 mongodb 的数据的。"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:S,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"跑起来之后，进入 terminal，开始学习 mongodb 的 crud："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:R,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"输入 mongosh，就可以敲 mongo 命令了："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"show dbs;\nshow databases;\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:G,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"查看下现有的 database。"}),"\n",(0,c.jsx)(n.p,{children:"和 mysql 一样，mongodb 也是通过一个个 database 来存储不同数据的，只不过 mysql 的 database 里存的是 table，而 mongo 里存的是 Collection。"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:B,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"创建或者切换 database 用 use"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"use hello-mongo;\n"})}),"\n",(0,c.jsx)(n.p,{children:"然后 db 命令查看当前 database："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"db;\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:C,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"但这时候你再用 show dbs 会发现没有这个 db："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:A,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"这是因为默认有了一个 collection 之后才会把 database 写入硬盘。"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.createCollection('aaa');\n"})}),"\n",(0,c.jsx)(n.p,{children:"创建了一个 collection 之后，再次 show dbs，这时候就看到这个新的 database 了："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:q,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"如果你想删除 database，用这个命令："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.dropDatabase();\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:k,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"创建和删除 database 我们会了，然后是 collection："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:D,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"用 db.createCollection 创建 db，然后可以用 db.xxx.drop() 删掉。"}),"\n",(0,c.jsx)(n.p,{children:"接下来向 collection 中插入几个 document："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.insertOne({ name: 'guang', age: 20, phone: '13222222222'});\n\ndb.xxx.insertMany([{ name: 'dong', age: 21}, {name: 'xxx', hobbies: ['writing']}]);\n\ndb.xxx.insertMany([{ name: 'dong2', age: 20}, {name: 'guang2', hobbies: ['writing']}]);\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:_,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"可以看到，插入的数据可以是任意结构的，这就是 mongodb 和 mysql 的最大区别。"}),"\n",(0,c.jsx)(n.p,{children:"不像 mysql 只能在 table 里存结构化的记录一样，mongodb 的 collection 里可以存任意结构的 document。"}),"\n",(0,c.jsx)(n.p,{children:"再就是 mysql 是需要用 sql 来 crud 的，而 mongodb 里是用 api。"}),"\n",(0,c.jsxs)(n.p,{children:["但完成的功能是一样的，可以在 ",(0,c.jsx)(n.a,{href:"https://www.mongodb.com/docs/mongodb-shell/crud/",target:"_blank",rel:"noopener noreferrer",children:"mongodb 文档"}),"里看到每个 api 的介绍下面都有对应的 sql 写法："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:y,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:M,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"我们试下查询："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find({age: 20});\n\ndb.xxx.findOne({ age: 20});\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:E,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"find 是查询多条记录，而 findOne 只返回第一条。"}),"\n",(0,c.jsx)(n.p,{children:"当不传过滤条件的时候，就是返回所有的 Document："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find()\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:O,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"查询条件有多个值的时候这样写，类似 sql 的 in："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find({ age: { $in: [20, 21]}})\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:$,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"in 是包含， nin 是不包含。"}),"\n",(0,c.jsx)(n.p,{children:"类似 in 的还有 gt（great than）、lt（less than）、gte（great than equal ）、lte（less than equal ）、ne（not equal）"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:N,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"多个条件的时候用 and："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find({ $and: [{age: { $gte: 20 }}, { name: /dong\\d/}]})\n\ndb.xxx.find({ $and: [{age: { $gte: 20 }}, { name: /dong*/}]})\n"})}),"\n",(0,c.jsx)(n.p,{children:"搜索 age 大于等于 20，并且名字包含 dong 的 Document，这里用的正则做的模糊匹配："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:v,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"用 or 的话就是两个条件满足一个就行："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find({ $or: [{age: { $gt: 20 }}, { name: /dong*/}]})\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:w,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"分页用的是 skip 和 limit 方法："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find().skip(1).limit(2)\n"})}),"\n",(0,c.jsx)(n.p,{children:"从第一条 Document 开始，取 2 条："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:u,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"更新的话用 updateOne、updateMany 方法："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.updateOne({ name: 'guang'}, { $set: {age: 30} })\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:f,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"如果在更新的时候带上时间戳，可以用 $currentDate："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.updateOne({ name: 'guang'}, { $set: {age: 30}, $currentDate: { aaa: true } })\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:m,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"如果你想替换整个的 document，那么用 replaceOne："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.replaceOne({name: 'guang'}, { age: 30})\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:h,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"删除的话，也有 deleteOne 和 deleteMany 两个方法："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.deleteMany({ age: { $gt: 20 }});\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:o,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"此外，还有 count 可以计数："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.count()\n\ndb.xxx.count({ name: /guang/})\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:j,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"sort 可以排序，1 是升序、-1 是降序："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find().sort({ age: -1})\n"})}),"\n",(0,c.jsx)(n.p,{children:"按照 age 降序："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:g,alt:""})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"db.xxx.find().sort({ age: -1, name: 1})\n"})}),"\n",(0,c.jsx)(n.p,{children:"先按照 age 降序，再按照 name 升序："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:b,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"这样，CRUD 我们都过了一遍。"}),"\n",(0,c.jsx)(n.p,{children:"当然，这些操作也都可以在 GUI 里可视化的搞，这样就不用敲命令了："}),"\n",(0,c.jsxs)(n.p,{children:["下载官方 GUI 工具 ",(0,c.jsx)(n.a,{href:"https://www.mongodb.com/products/tools/compass",target:"_blank",rel:"noopener noreferrer",children:"Mongo Compass"}),"："]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:p,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"连接上 mongodb 的 server："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:t,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"在 GUI 工具里操作就很方便直观了："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:x,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"可以看到所有的 database、collection、document。"}),"\n",(0,c.jsx)(n.p,{children:"在这里输入过滤条件后点击 find："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:r,alt:""})}),"\n",(0,c.jsx)(n.p,{children:"更新和删除也都很直观："}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:l,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:i,alt:""})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)("img",{src:d,alt:""})}),"\n",(0,c.jsxs)(n.h2,{id:"总结",children:["总结",(0,c.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,c.jsx)(n.p,{children:"这节我们入门了 mongodb。"}),"\n",(0,c.jsx)(n.p,{children:"它的 database 下是 collection，collection 包含多个 document。"}),"\n",(0,c.jsx)(n.p,{children:"document 可以是任意结构的，这点和 mysql 的 table 不同。"}),"\n",(0,c.jsx)(n.p,{children:"mongo 是通过 api 来做 CRUD 的，不是用的 sql。"}),"\n",(0,c.jsx)(n.p,{children:"我们过了一遍常用的命令和 api："}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"show dbs; // 显示 database\nshow databases;\n\nuse hello-mongo; // 切换或者创建 database\n\ndb; // 查看当前 database\n\ndb.dropDatabase(); // 删除 database\n\ndb.createCollection('aaa'); // 创建 collection\n\ndb.xxx.drop() //删除 collection\n\ndb.xxx.insertOne({ name: 'guang', age: 20, phone: '13222222222'});// 插入 document\n\ndb.xxx.insertMany([{ name: 'dong', age: 21}, {name: 'xxx', hobbies: ['writing']}]);\n\ndb.xxx.find({age: 20}); // 查询 collection\n\ndb.xxx.findOne({ age: 20});\n\ndb.xxx.findOne(); // 查询所有 collection\n\ndb.xxx.find({ age: { $in: [20, 21]}}) // 使用 in、nin 查询多个值\n\ndb.xxx.find({ $and: [{age: { $gte: 20 }}, { name: /dong\\d/}]}) // 使用 and 指定多个条件同时成立\n\ndb.xxx.find({ $or: [{age: { $gt: 20 }}, { name: /dong*/}]}) // 使用 or 表示或者\n\ndb.xxx.find().skip(1).limit(2) // 使用 skip + limit 实现分页\n\ndb.xxx.updateOne({ name: 'guang'}, { $set: {age: 30}, $currentDate: { aaa: true } }) // updateOne、updateMany 更新\n\ndb.xxx.replaceOne({name: 'guang'}, { age: 30}) // 整体替换\n\ndb.xxx.deleteMany({ age: { $gt: 20 }}); // deleteOne、deleteMany 删除\n\ndb.xxx.count({ name: /guang/})\n\ndb.xxx.find().sort({ age: -1, name: 1})\n"})}),"\n",(0,c.jsx)(n.p,{children:"当然，平时不用敲 api，用 Mongo Compass 的 GUI 工具操作非常简单。"})]})}function P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(I,{...e})}):I(e)}let T=P;P.__RSPRESS_PAGE_META={},P.__RSPRESS_PAGE_META["Nest%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%20%20%E6%9C%80%E6%96%B0200%E7%AB%A0%2F195.%20MongoDB%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.md"]={toc:[{text:"总结",id:"总结",depth:2}],title:"195. MongoDB 快速入门",headingTitle:"195. MongoDB 快速入门",frontmatter:{}}}}]);