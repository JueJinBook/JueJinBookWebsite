"use strict";(self.webpackChunkjue_jin_book_press=self.webpackChunkjue_jin_book_press||[]).push([["28261"],{808286:function(e,n,r){e.exports=r.p+"static/image/0e5571907546ecbd1473d674acbedd12.72f53b6a.webp"},347533:function(e,n,r){e.exports=r.p+"static/image/457e87ae3d93ebfbd06fb768781787b7.08eaac4e.webp"},316418:function(e,n,r){e.exports=r.p+"static/image/4bd5644d7506ef47a4149b02d15a947b.1b5921a2.webp"},864734:function(e,n,r){e.exports=r.p+"static/image/f6d9852d32a4d7ed1353a46e6b012c22.d829dcba.webp"},652330:function(e,n,r){r.r(n),r.d(n,{default:()=>R});var s=r(552676),i=r(740453);let c=r.p+"static/image/ae8be3f63191a69305b8f2b6fa1f8488.87a66cca.webp",a=r.p+"static/image/1c4e18bfeee31db328c01c7886372f97.b8920080.webp",t=r.p+"static/image/16a57025cf18e9fd994cca091793a6ba.78d64cfe.webp",d=r.p+"static/image/8beb58d305287032c1d31bdf316feaa4.b4aa4358.webp",l=r.p+"static/image/c15cfeb58a59818c92192dc436d4dece.18c5cebe.webp",o=r.p+"static/image/e5efbd310181afc59502c6abff3dbde7.4d1f90b8.webp",p=r.p+"static/image/c21256fa6af3b2836dfe98275b2292f8.2e2ad2ad.webp",h=r.p+"static/image/be839bc7f15e09b685516626ee7509e1.c3383d9a.webp",x=r.p+"static/image/acdbd82d6dbbe11d32b5e410643551e7.e5eab6f3.webp",b=r.p+"static/image/801b375fae669bc700cf4edf61e33630.36fe9add.webp",j=r.p+"static/image/b574539f5f6563f23181a2c3c29ca467.c308c32b.webp";var m=r(808286),g=r(347533),u=r(316418),v=r(864734);let f=r.p+"static/image/73c03d42674891849e66c64f20e314a0.52e26bf5.webp",O=r.p+"static/image/250980afaa6388ac4b551d121a641941.131afa22.webp",A=r.p+"static/image/5071f3ca4750ac1caae56a234ff8441f.69657b10.webp";function w(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",strong:"strong",pre:"pre",code:"code",img:"img",ul:"ul",li:"li"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"第17章浏览器的5种observer",children:["第17章—浏览器的5种Observer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#第17章浏览器的5种observer",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"\uFEFF网页开发中我们经常要处理用户交互，我们会用 addEventListener 添加事件监听器来监听各种用户操作，比如 click、mousedown、mousemove、input 等，这些都是由用户直接触发的事件。"}),"\n",(0,s.jsx)(n.p,{children:"那么对于一些不是由用户直接触发的事件呢？ 比如元素从不可见到可见、元素大小的改变、元素的属性和子节点的修改等，这类事件如何监听呢？"}),"\n",(0,s.jsx)(n.p,{children:"浏览器提供了 5 种 Observer 来监听这些变动：MutationObserver、IntersectionObserver、PerformanceObserver、ResizeObserver、ReportingObserver。"}),"\n",(0,s.jsx)(n.p,{children:"我们分别来看一下："}),"\n",(0,s.jsxs)(n.h2,{id:"intersectionobserver",children:["IntersectionObserver",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#intersectionobserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"一个元素从不可见到可见，从可见到不可见，这种变化如何监听呢？"}),"\n",(0,s.jsx)(n.p,{children:"用 IntersectionObserver。"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"IntersectionObserver 可以监听一个元素和可视区域相交部分的比例，然后在可视比例达到某个阈值的时候触发回调。"})}),"\n",(0,s.jsx)(n.p,{children:"我们准备两个元素："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div id="box1">BOX111</div>\n<div id="box2">BOX222</div>\n'})}),"\n",(0,s.jsx)(n.p,{children:"加上样式："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:"#box1,#box2 {\n    width: 100px;\n    height: 100px;\n    background: blue;\n    color: #fff;\n\n    position: relative;\n}\n#box1 {\n    top: 500px;\n}\n#box2 {\n    top: 800px;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"这两个元素分别在 500  和 800 px 的高度，我们监听它们的可见性的改变。"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const intersectionObserver = new IntersectionObserver(\n    function (entries) {\n        console.log('info:');\n        entries.forEach(item => {\n            console.log(item.target, item.intersectionRatio)\n        })\n    }, {\n    threshold: [0.5, 1]\n});\n\nintersectionObserver.observe( document.querySelector('#box1'));\nintersectionObserver.observe( document.querySelector('#box2'));\n"})}),"\n",(0,s.jsx)(n.p,{children:"创建一个 IntersectionObserver 对象，监听 box1 和 box2 两个元素，当可见比例达到 0.5 和 1 的时候触发回调。"}),"\n",(0,s.jsx)(n.p,{children:"浏览器跑一下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:A,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"可以看到元素 box1 和 box2 在可视范围达到一半（0.5）和全部（1）的时候分别触发了回调。"}),"\n",(0,s.jsx)(n.p,{children:"这有啥用？"}),"\n",(0,s.jsx)(n.p,{children:"这太有用了。我们在做一些数据采集的时候，希望知道某个元素是否是可见的，什么时候可见的，就可以用这个 api 来监听，还有做图片的懒加载的时候，可以当可视比例达到某个比例再触发加载。"}),"\n",(0,s.jsx)(n.p,{children:"除了可以监听元素可见性，还可以监听元素的属性和子节点的改变："}),"\n",(0,s.jsxs)(n.h2,{id:"mutationobserver",children:["MutationObserver",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mutationobserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"监听一个普通 JS 对象的变化，我们会用 Object.defineProperty 或者 Proxy："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:O,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"而监听元素的属性和子节点的变化，我们可以用 MutationObserver："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"MutationObserver 可以监听对元素的属性的修改、对它的子节点的增删改。"})}),"\n",(0,s.jsx)(n.p,{children:"我们准备这样一个盒子："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div id="box"><button>光</button></div>\n'})}),"\n",(0,s.jsx)(n.p,{children:"加上样式："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:" #box {\n    width: 100px;\n    height: 100px;\n    background: blue;\n\n    position: relative;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"就是这样的："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:"data:image/webp;base64,UklGRqoDAABXRUJQVlA4IJ4DAADwIgCdASr8AAQBPp1Ko00lpCOiIRIJyLATiWVu62AzQM2dEs2AfTS2ysgA/YDrbP2u9IDVZfEs160VPvLn089b0OHB5vKSR+O/EDab9l8JQjjG+zGvDRgtoecLruHEZlZWRmQler/TAwZ5NzMGKqe0MF3XeaRE0TFJxUwwI0jHsmNTROItwY4fB9YDlEiQMp7H+SCX4qIyue/cLaP3qojHDG53s6DPcd5Ol4EzhUGe47ydLwJnCoM9x3k6XgTOFQZ7jvJ0vAmcKgz3HeTpeBM4VBnuO8nS8CZwqDPcd5Ol4EzhUGe47yJQzFhexUg6uSJDVCDNWcgsgns/A6iJVjc90c4LZksRwoI/fOx++dFsy48bhnWbdx9aRE0fvnblwAAA/veG675D/I5QGDv11mIrn3VJXKdL0TDcbwMCwPrar7CrIfc7zYb+QOTu3vzZnpJ+hbrgH4ZOY5aX1aOtFypW+ERHdr9o/f/go/n//rIZQz+il9/df+VZP5N/p7+ET2PLX9rHQSrhbh/RtrcseYC9gYb5Zsf89hN/zX/zvXjWpocRY8inlrezs2GH6/zGAvlxYcXcIAm/SM7bfqsqPMmXV7LdN7uDx1G/RRE53/Hktfr0Us9Ff+qOl2JMzaMNpGpQ0hvgiU3ldvN/cuY7ZD3/s7wY/FWiXCqOW8XFPV+RN1+pEa0Fz0Pp8B7Rc/AqzlhX2qHaxw5Jy6h+cif+H/aAC0qHC0ftjP/+lSDlZID/JuGKQUNwENF98iqNO54db/JKEHA7fd7Q+RovyLrFZVGH8FMP4KYfy+nrpOpRXhXHkp8tEnx1patNlc7mzQbE34zNC1GN+38V6F5TkXBAgX7xYCtD8DKjT3jPMPVK7zPgnJT7z+fxqAfp22lgKays1ueblNYmsohFQ8UkYmnTyOvBgh+y5FY30X7VSh5e6bNjEjr2oRqFLDILF1OL/4/U9Ln/I01aX+e+gf27SfPYZb0gpi9d/sShkcd/Dd//9rXH3/EqbphuPm/R8uwAnfYUXxJWAGU0oS1JImwsBO9YCd6wE71gJ3rARQsz+vaO0aXyYXf/R2/M7/eguKAxg3GX0iu1HdxX2eYASthPGw47ckRD/REP9EQwD2Q0elvt/N7n3x7EB+WaIAANM3FsLdVL5g5iaIRAi+thidreMBE8v46O7ZA9tYTSN7KZ8cksbzw8Ty8oXNdgrnb7uvAEFGg1SkfTEGit6xueHeCsAAAAAA==",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"我们定时对它做下修改："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"setTimeout(() => {\n    box.style.background = 'red';\n},2000);\n\nsetTimeout(() => {\n    const dom = document.createElement('button');\n    dom.textContent = '东东东';\n    box.appendChild(dom);\n},3000);\n\nsetTimeout(() => {\n   document.querySelectorAll('button')[0].remove();\n},5000);\n"})}),"\n",(0,s.jsx)(n.p,{children:"2s 的时候修改背景颜色为红色，3s 的时候添加一个 button 的子元素，5s 的时候删除第一个 button。"}),"\n",(0,s.jsx)(n.p,{children:"然后监听它的变化："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const mutationObserver = new MutationObserver((mutationsList) => {\n    console.log(mutationsList)\n});\n\nmutationObserver.observe(box, {\n    attributes: true,\n    childList: true\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"创建一个 MutationObserver 对象，监听这个盒子的属性和子节点的变化。"}),"\n",(0,s.jsx)(n.p,{children:"浏览器跑一下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:f,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"可以看到在三次变化的时候都监听到了并打印了一些信息："}),"\n",(0,s.jsx)(n.p,{children:"第一次改变的是 attributes，属性是 style："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:v,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"第二次改变的是 childList，添加了一个节点："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:u,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"第三次也是改变的 childList，删除了一个节点："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:g,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"都监听到了！"}),"\n",(0,s.jsx)(n.p,{children:"这个可以用来做什么呢？比如文章水印被人通过 devtools 去掉了，那么就可以通过 MutationObserver 监听这个变化，然后重新加上，让水印去不掉。"}),"\n",(0,s.jsx)(n.p,{children:"比如 antd 的 Watermark 组件："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:m,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"当删除了水印节点，或者修改了水印节点的属性，就会重新渲染水印："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:j,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"当然，还有很多别的用途，这里只是介绍功能。"}),"\n",(0,s.jsx)(n.p,{children:"除了监听元素的可见性、属性和子节点的变化，还可以监听大小变化："}),"\n",(0,s.jsxs)(n.h2,{id:"resizeobserver",children:["ResizeObserver",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#resizeobserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"窗口我们可以用 addEventListener 监听 resize 事件，那元素呢？"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"元素可以用 ResizeObserver 监听大小的改变，当 width、height 被修改时会触发回调。"})}),"\n",(0,s.jsx)(n.p,{children:"我们准备这样一个元素："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div id="box"></div>\n'})}),"\n",(0,s.jsx)(n.p,{children:"添加样式："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:"#box {\n    width: 100px;\n    height: 100px;\n    background: blue;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"在 2s 的时候修改它的高度："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const box = document.querySelector('#box');\n\nsetTimeout(() => {\n    box.style.width = '200px';\n}, 3000);\n"})}),"\n",(0,s.jsx)(n.p,{children:"然后我们用 ResizeObserver 监听它的变化："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const resizeObserver = new ResizeObserver(entries => {\n    console.log('当前大小', entries)\n});\nresizeObserver.observe(box);\n"})}),"\n",(0,s.jsx)(n.p,{children:"在浏览器跑一下："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:b,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"大小变化被监听到了，看下打印的信息："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:x,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"可以拿到元素和它的位置、尺寸。"}),"\n",(0,s.jsx)(n.p,{children:"这样我们就实现了对元素的 resize 的监听。"}),"\n",(0,s.jsx)(n.p,{children:"除了元素的大小、可见性、属性子节点等变化的监听外，还支持对 performance 录制行为的监听："}),"\n",(0,s.jsxs)(n.h2,{id:"performanceobserver",children:["PerformanceObserver",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#performanceobserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"浏览器提供了 performance 的 api 用于记录一些时间点、某个时间段、资源加载的耗时等。"}),"\n",(0,s.jsx)(n.p,{children:"我们希望记录了 performance 那就马上上报，可是怎么知道啥时候会记录 performance 数据呢？"}),"\n",(0,s.jsx)(n.p,{children:"用 PeformanceObserver。"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"PerformanceObserver 用于监听记录 performance 数据的行为，一旦记录了就会触发回调，这样我们就可以在回调里把这些数据上报。"})}),"\n",(0,s.jsx)(n.p,{children:"比如 performance 可以用 mark 方法记录某个时间点："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"performance.mark('registered-observer');\n"})}),"\n",(0,s.jsx)(n.p,{children:"用 measure 方法记录某个时间段："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"performance.measure('button clicked', 'from', 'to');\n"})}),"\n",(0,s.jsx)(n.p,{children:"后两个个参数是时间点，不传代表从开始到现在。"}),"\n",(0,s.jsx)(n.p,{children:"我们可以用 PerformanceObserver 监听它们："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<html>\n<body>\n  <button onclick=\"measureClick()\">Measure</button>\n\n  <img src=\"https://p9-passport.byteacctimg.com/img/user-avatar/4e9e751e2b32fb8afbbf559a296ccbf2~300x300.image\" />\n\n  <script>\n    const performanceObserver = new PerformanceObserver(list => {\n      list.getEntries().forEach(entry => {\n        console.log(entry);// 上报\n      })\n    });\n    performanceObserver.observe({entryTypes: ['resource', 'mark', 'measure']});\n\n    performance.mark('registered-observer');\n\n    function measureClick() {\n      performance.measure('button clicked');\n    }\n  <\/script>\n</body>\n</html>\n"})}),"\n",(0,s.jsx)(n.p,{children:"创建 PerformanceObserver 对象，监听 mark（时间点）、measure（时间段）、resource（资源加载耗时）\n这三种记录时间的行为。"}),"\n",(0,s.jsx)(n.p,{children:"然后我们用 mark 记录了某个时间点，点击 button 的时候用 measure 记录了某个时间段的数据，还加载了一个图片。"}),"\n",(0,s.jsx)(n.p,{children:"当这些记录行为发生的时候，希望能触发回调，在里面可以上报。"}),"\n",(0,s.jsx)(n.p,{children:"我们在浏览器跑一下试试："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:h,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"可以看到 mark 的时间点记录、资源加载的耗时、点击按钮的 measure 时间段记录都监听到了。"}),"\n",(0,s.jsx)(n.p,{children:"分别打印了这三种记录行为的数据："}),"\n",(0,s.jsxs)(n.p,{children:["mark：\n",(0,s.jsx)("img",{src:p,alt:""})]}),"\n",(0,s.jsx)(n.p,{children:"图片加载："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:o,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"measure："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:l,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"有了这些数据，就可以上报上去做性能分析了。"}),"\n",(0,s.jsx)(n.p,{children:"除了元素、performance 外，浏览器还有一个 reporting 的监听："}),"\n",(0,s.jsxs)(n.h2,{id:"reportingobserver",children:["ReportingObserver",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#reportingobserver",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"当浏览器运行到过时（deprecation）的 api 的时候，会在控制台打印一个过时的报告:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:d,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"浏览器还会在一些情况下对网页行为做一些干预（intervention），比如会把占用 cpu 太多的广告的 iframe 删掉："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:t,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"会在网络比较慢的时候把图片替换为占位图片，点击才会加载："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:a,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"这些干预都是浏览器做的，会在控制台打印一个报告："}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)("img",{src:c,alt:""})}),"\n",(0,s.jsx)(n.p,{children:"这些干预或者过时的 api 并不是报错，所以不能用错误监听的方式来拿到，但这些情况对网页 app 来说可能也是很重要的："}),"\n",(0,s.jsx)(n.p,{children:"比如我这个网页就是为了展示广告的，但浏览器一干预给我把广告删掉了，我却不知道。如果我知道的话或许可以优化下 iframe。"}),"\n",(0,s.jsx)(n.p,{children:"比如我这个网页的图片很重要，结果浏览器一干预给我换成占位图了，我却不知道。如果我知道的话可能会优化下图片大小。"}),"\n",(0,s.jsx)(n.p,{children:"所以自然也要监听，所以浏览器提供了 ReportingObserver 的 api 用来监听这些报告的打印，我们可以拿到这些报告然后上传。"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const reportingObserver = new ReportingObserver((reports, observer) => {\n    for (const report of reports) {\n        console.log(report.body);//上报\n    }\n}, {types: ['intervention', 'deprecation']});\n\nreportingObserver.observe();\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"ReportingObserver 可以监听过时的 api、浏览器干预等报告等的打印，在回调里上报，这些是错误监听无法监听到但对了解网页运行情况很有用的数据。"})}),"\n",(0,s.jsxs)(n.p,{children:["案例代码上传了",(0,s.jsx)(n.a,{href:"https://github.com/QuarkGluonPlasma/react-course-code/tree/main/observer",target:"_blank",rel:"noopener noreferrer",children:"小册仓库"})]}),"\n",(0,s.jsxs)(n.h2,{id:"总结",children:["总结",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#总结",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"监听用户的交互行为，我们会用 addEventListener 来监听 click、mousedown、keydown、input 等事件，但对于元素的变化、performance 的记录、浏览器干预行为这些不是用户交互的事件就要用 XxxObserver 的 api 了。"}),"\n",(0,s.jsx)(n.p,{children:"浏览器提供了这 5 种 Observer："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"IntersectionObserver：监听元素可见性变化，常用来做元素显示的数据采集、图片的懒加载"}),"\n",(0,s.jsx)(n.li,{children:"MutationObserver：监听元素属性和子节点变化，比如可以用来做去不掉的水印"}),"\n",(0,s.jsx)(n.li,{children:"ResizeObserver：监听元素大小变化"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"还有两个与元素无关的："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PerformanceObserver：监听 performance 记录的行为，来上报数据"}),"\n",(0,s.jsx)(n.li,{children:"ReportingObserver：监听过时的 api、浏览器的一些干预行为的报告，可以让我们更全面的了解网页 app 的运行情况"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"这些 api 相比 addEventListener 添加的交互事件来说用的比较少，但是在特定场景下都是很有用的。"}),"\n",(0,s.jsx)(n.p,{children:"浏览器的这 5 种 Observer，你用过几种呢？在什么情况下用到过呢？不妨来讨论下。"})]})}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(w,{...e})}):w(e)}let R=E;E.__RSPRESS_PAGE_META={},E.__RSPRESS_PAGE_META["React%20%E9%80%9A%E5%85%B3%E7%A7%98%E7%B1%8D%2F%E7%AC%AC17%E7%AB%A0%E2%80%94%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%845%E7%A7%8DObserver.md"]={toc:[{text:"IntersectionObserver",id:"intersectionobserver",depth:2},{text:"MutationObserver",id:"mutationobserver",depth:2},{text:"ResizeObserver",id:"resizeobserver",depth:2},{text:"PerformanceObserver",id:"performanceobserver",depth:2},{text:"ReportingObserver",id:"reportingobserver",depth:2},{text:"总结",id:"总结",depth:2}],title:"第17章—浏览器的5种Observer",headingTitle:"第17章—浏览器的5种Observer",frontmatter:{}}}}]);